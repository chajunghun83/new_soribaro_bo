<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í”„ë¡œì„¸ìŠ¤ í…ŒìŠ¤íŠ¸ - ë²ˆì—­ ì‘ì—…ê´€ë¦¬</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            padding: 10px;
            min-height: 100vh;
            margin: 0;
            width: 100%;
            box-sizing: border-box;
        }
        
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e5e7eb;
        }
        
        .page-title {
            font-size: 28px;
            font-weight: 600;
            color: #374151;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .back-button {
            background: #6b7280;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .back-button:hover {
            background: #4b5563;
        }
        
        /* ì •ë³´ ì„¹ì…˜ */
        .info-section {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .basic-info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 30px;
            margin-bottom: 25px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .info-label {
            font-weight: 500;
            color: #6b7280;
            font-size: 14px;
        }

        .info-value {
            color: #374151;
            font-size: 16px;
            font-weight: 500;
            padding: 12px 15px;
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
        }
        
        /* íŒŒì¼ ë¦¬ìŠ¤íŠ¸ í…Œì´ë¸” */
        .file-list-section {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }
        
        .section-title {
            margin: 0 0 20px 0;
            color: #374151;
            font-size: 18px;
            font-weight: 600;
            border-bottom: 3px solid #3b82f6;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .file-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            table-layout: fixed;
        }
        
        .file-table th,
        .file-table td {
            padding: 12px;
            text-align: center;
            border: 1px solid #e5e7eb;
            font-size: 14px;
            vertical-align: middle;
        }
        
        /* íŒŒì¼ ë¦¬ìŠ¤íŠ¸ í…Œì´ë¸” ì»¬ëŸ¼ ë„ˆë¹„ ì„¤ì • - ë©”ì¸ íŒŒì¼ ë¦¬ìŠ¤íŠ¸ìš© - ìµœê³  ìš°ì„ ìˆœìœ„ - v2.0 */
        body table.file-table.main-file-table {
            table-layout: fixed !important;
            width: 100% !important;
        }
        
        body table.file-table.main-file-table th,
        body table.file-table.main-file-table td {
            box-sizing: border-box !important;
        }
        
        body table.file-table.main-file-table th:nth-child(1),
        body table.file-table.main-file-table td:nth-child(1) {
            width: 4% !important;
            max-width: 4% !important;
            min-width: 4% !important;
            text-align: center !important;
        }
        
        body table.file-table.main-file-table th:nth-child(2),
        body table.file-table.main-file-table td:nth-child(2) {
            width: 35% !important;
            max-width: 35% !important;
            min-width: 35% !important;
        }
        
        body table.file-table.main-file-table th:nth-child(3),
        body table.file-table.main-file-table td:nth-child(3) {
            width: 8% !important;
            max-width: 8% !important;
            min-width: 8% !important;
        }
        
        body table.file-table.main-file-table th:nth-child(4),
        body table.file-table.main-file-table td:nth-child(4) {
            width: 18% !important;
            max-width: 18% !important;
            min-width: 18% !important;
        }
        
        body table.file-table.main-file-table th:nth-child(5),
        body table.file-table.main-file-table td:nth-child(5) {
            width: 12% !important;
            max-width: 12% !important;
            min-width: 12% !important;
        }
        
        body table.file-table.main-file-table th:nth-child(6),
        body table.file-table.main-file-table td:nth-child(6) {
            width: 10% !important;
            max-width: 10% !important;
            min-width: 10% !important;
        }
        
        body table.file-table.main-file-table th:nth-child(7),
        body table.file-table.main-file-table td:nth-child(7) {
            width: 13% !important;
            max-width: 13% !important;
            min-width: 13% !important;
        }
        
        .file-table td:first-child input[type="checkbox"] {
            margin: 0 auto;
            display: block;
        }
        
        .file-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #374151;
        }
        
        .file-table tbody tr:hover {
            background: #f9fafb;
        }
        
        /* ì„ íƒëœ íŒŒì¼ í–‰ ìŠ¤íƒ€ì¼ */
        .file-table tbody tr.selected-file-row {
            background: #dbeafe !important;
            border-left: 4px solid #3b82f6 !important;
            box-shadow: 0 2px 4px rgba(59, 130, 246, 0.1) !important;
        }
        
        .file-table tbody tr.selected-file-row:hover {
            background: #bfdbfe !important;
        }
        
        .file-table tbody tr.selected-file-row td {
            border-color: #93c5fd !important;
        }
        
        /* ë¶„í• ëœ íŒŒì¼ì´ ì„ íƒë˜ì—ˆì„ ë•Œ ìŠ¤íƒ€ì¼ */
        .file-table tbody tr.tree-child.selected-file-row {
            background: #dbeafe !important;
            border-left: 4px solid #3b82f6 !important;
            box-shadow: 0 2px 4px rgba(59, 130, 246, 0.1) !important;
        }
        
        .file-table tbody tr.tree-child.selected-file-row:hover {
            background: #bfdbfe !important;
        }
        
        /* ì›ë³¸ íŒŒì¼ì´ ì„ íƒë˜ì—ˆì„ ë•Œ ìŠ¤íƒ€ì¼ ê°•í™” */
        .file-table tbody tr.tree-parent.selected-file-row {
            background: #dbeafe !important;
            border-left: 4px solid #3b82f6 !important;
            box-shadow: 0 2px 4px rgba(59, 130, 246, 0.1) !important;
            font-weight: 600 !important;
        }
        
        .file-name {
            text-align: left;
            color: #3b82f6;
            font-weight: 500;
            min-width: 250px;
            padding-left: 16px !important;
            word-wrap: break-word;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn {
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: #3b82f6;
            color: white;
        }
        
        .btn-primary:hover {
            background: #2563eb;
        }
        
        .btn-success {
            background: #10b981;
            color: white;
        }
        
        .btn-success:hover {
            background: #059669;
        }
        
        .btn-warning {
            background: #f59e0b;
            color: white;
        }
        
        .btn-warning:hover {
            background: #d97706;
        }
        
        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .modal-container {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .modal-header h2 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            color: #374151;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #6b7280;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s;
        }
        
        .modal-close:hover {
            background: #f3f4f6;
            color: #374151;
        }
        
        .modal-content {
            padding: 24px;
        }
        
        .modal-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-top: 1px solid #e5e7eb;
        }
        
        /* í™”ì‚´í‘œ ë²„íŠ¼ */
        .arrow-button {
            background: #6b7280;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s;
        }
        
        .arrow-button:hover {
            background: #4b5563;
        }
        
        /* íŒŒì¼ ì´ë™ ì• ë‹ˆë©”ì´ì…˜ */
        .file-moving {
            animation: moveDown 0.5s ease-in-out;
        }
        
        @keyframes moveDown {
            0% { transform: translateY(0); opacity: 1; }
            50% { transform: translateY(10px); opacity: 0.5; }
            100% { transform: translateY(0); opacity: 1; }
        }
        
        /* ë¶ˆí•„ìš”í•œ íŠ¸ë¦¬ ìŠ¤íƒ€ì¼ ì œê±°ë¨ */
        
        /* ì´ì „ CSS ê·œì¹™ë“¤ì€ ì•„ë˜ ë” êµ¬ì²´ì ì¸ ê·œì¹™ìœ¼ë¡œ ëŒ€ì²´ë¨ */
        
        /* ì›ë³¸ íŒŒì¼(ë¶€ëª¨) ìŠ¤íƒ€ì¼ */
        tr.tree-parent td:nth-child(1) {
            font-weight: 600 !important;
            color: #374151 !important;
            background: #fff !important;
        }
        
        tr.tree-parent td {
            background: #fff !important;
        }
        
        /* ë¶ˆí•„ìš”í•œ ìŠ¤íƒ€ì¼ ì œê±°ë¨ */
        
        /* ë¶„í• ëœ íŒŒì¼ì˜ ëª¨ë“  ì»¬ëŸ¼ ìŠ¤íƒ€ì¼ */
        tr.tree-child td {
            background: #f8f9fa !important;
            color: #6b7280 !important;
            font-size: 13px !important;
            text-align: center !important;
            vertical-align: middle !important;
            padding: 12px !important;
        }
        
        /* ë¶„í• ëœ íŒŒì¼ì˜ ì²´í¬ë°•ìŠ¤ ì»¬ëŸ¼ì€ ì¤‘ì•™ì •ë ¬ ìœ ì§€ */
        tr.tree-child td:nth-child(1) {
            text-align: center !important;
        }
        
        /* ë¶„í• ëœ íŒŒì¼ì˜ íŒŒì¼ëª… ì»¬ëŸ¼ - ì¤‘ì•™ì •ë ¬ + ë³¼ë“œ í™”ì‚´í‘œ */
        /* ë¶„í• ëœ íŒŒì¼ì˜ íŒŒì¼ëª… ì»¬ëŸ¼ì— í™”ì‚´í‘œ í‘œì‹œ (ì˜ì—­ë³„ êµ¬ë¶„) */
        
        /* ë©”ì¸ íŒŒì¼ ë¦¬ìŠ¤íŠ¸: 2ë²ˆì§¸ ì»¬ëŸ¼ì´ íŒŒì¼ëª… */
        .file-table tbody tr.tree-child td:nth-child(2) {
            text-align: center !important;
            background: #f8f9fa !important;
            padding: 12px !important;
        }
        
        .file-table tbody tr.tree-child td:nth-child(2)::before {
            content: "â†’ " !important;
            color: #6b7280 !important;
            font-weight: bold !important;
            margin-right: 4px !important;
        }
        
        /* íŒŒì¼ ì„¸íŒ… ëª¨ë‹¬ (target-file-list): 3ë²ˆì§¸ ì»¬ëŸ¼ì´ íŒŒì¼ëª… */
        #target-file-list tr.tree-child td:nth-child(3) {
            text-align: center !important;
            background: #f8f9fa !important;
            padding: 12px !important;
        }
        
        #target-file-list tr.tree-child td:nth-child(3)::before {
            content: "â†’ " !important;
            color: #6b7280 !important;
            font-weight: bold !important;
            margin-right: 4px !important;
        }
        
        /* ì¶œë°œì–´ ì˜ì—­ (detail-tbody): 1ë²ˆì§¸ ì»¬ëŸ¼ì´ íŒŒì¼ëª… */
        #detail-tbody tr.tree-child td:nth-child(1) {
            text-align: center !important;
            background: #f8f9fa !important;
            padding: 12px !important;
        }
        
        #detail-tbody tr.tree-child td:nth-child(1)::before {
            content: "â†’ " !important;
            color: #6b7280 !important;
            font-weight: bold !important;
            margin-right: 4px !important;
        }
        
        /* ì¶œë°œì–´ ì»¬ëŸ¼(2ë²ˆì§¸)ì—ëŠ” í™”ì‚´í‘œ í‘œì‹œ ì•ˆí•¨ */
        #detail-tbody tr.tree-child td:nth-child(2) {
            background: #f8f9fa !important;
            text-align: center !important;
            padding: 12px !important;
        }
        
        #detail-tbody tr.tree-child td:nth-child(2)::before {
            content: none !important;
        }
        
        /* ì›ìŠ¤íŒŒì´ ìƒì„¸ ì˜ì—­ì˜ ì¶œë°œì–´ ì»¬ëŸ¼ì—ë„ í™”ì‚´í‘œ í‘œì‹œ ì•ˆí•¨ */
        #worksby-detail-area #detail-tbody tr.tree-child td:nth-child(2) {
            background: #f8f9fa !important;
            text-align: center !important;
            padding: 12px !important;
        }
        
        #worksby-detail-area #detail-tbody tr.tree-child td:nth-child(2)::before {
            content: none !important;
        }
        
        /* ì¤‘ê°„ì–´ ì˜ì—­ (intermediate-tbody): 1ë²ˆì§¸ ì»¬ëŸ¼ì´ íŒŒì¼ëª… */
        #intermediate-tbody tr.tree-child td:nth-child(1) {
            text-align: center !important;
            background: #f8f9fa !important;
            padding: 12px !important;
        }
        
        #intermediate-tbody tr.tree-child td:nth-child(2)::before {
            content: "â†’ " !important;
            color: #6b7280 !important;
            font-weight: bold !important;
            margin-right: 4px !important;
        }
        
        /* ì¤‘ê°„ì–´ ì˜ì—­ ì¶œë°œì–´ ì»¬ëŸ¼(3ë²ˆì§¸)ì—ëŠ” í™”ì‚´í‘œ í‘œì‹œ ì•ˆí•¨ */
        #intermediate-tbody tr.tree-child td:nth-child(3) {
            background: #f8f9fa !important;
            text-align: center !important;
            padding: 12px !important;
        }
        
        #intermediate-tbody tr.tree-child td:nth-child(3)::before {
            content: none !important;
        }
        
        /* ë„ì°©ì–´ ì˜ì—­ (destination-tbody-*): 2ë²ˆì§¸ ì»¬ëŸ¼ì´ íŒŒì¼ëª… */
        [id^="destination-tbody-"] tr.tree-child td:nth-child(2) {
            text-align: center !important;
            background: #f8f9fa !important;
            padding: 12px !important;
        }
        
        [id^="destination-tbody-"] tr.tree-child td:nth-child(2)::before {
            content: "â†’ " !important;
            color: #6b7280 !important;
            font-weight: bold !important;
            margin-right: 4px !important;
        }
        
        /* ì›ë³¸ íŒŒì¼(ë¶€ëª¨) ìŠ¤íƒ€ì¼ - ê°„ë‹¨í•˜ê²Œ */
        tr.tree-parent td {
            background: #fff !important;
        }
        
        tr.tree-parent td:nth-child(1) {
            font-weight: 600 !important;
            color: #374151 !important;
        }
        
        /* ìƒíƒœ ë°°ì§€ ìŠ¤íƒ€ì¼ */
        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
            text-align: center;
        }
        
        .status-ready {
            background: #e5e7eb;
            color: #374151;
        }
        
        .status-moved {
            background: #dbeafe;
            color: #1d4ed8;
        }
        
        /* í”„ë¡œì íŠ¸ ê·¸ë£¹ ìŠ¤íƒ€ì¼ */
        .project-group {
            margin-bottom: 25px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            overflow: hidden;
            width: 100%;
            box-sizing: border-box;
        }
        
        .project-group-header {
            background: #f8f9fa;
            padding: 15px 20px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .project-group-title {
            font-size: 16px;
            font-weight: 600;
            color: #3b82f6;
            margin: 0;
        }
        
        .project-group-count {
            background: #3b82f6;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .project-group .file-table {
            margin-bottom: 0;
        }
        
        /* í…œí”Œë¦¿ í–‰ ìŠ¤íƒ€ì¼ */
        .template-row {
            transition: all 0.2s ease;
        }
        
        .template-row:hover {
            background-color: #f3f4f6 !important;
        }
        
        .template-row.selected {
            background-color: #dbeafe !important;
            color: #1e40af !important;
        }
        
        /* ì‘ì—… ì˜ì—­ êµ¬ë¶„ ìŠ¤íƒ€ì¼ */
        .work-area-container {
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            margin: 20px 0;
            padding: 20px;
            background: #fafafa;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        
        .work-area-header {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            margin: -20px -20px 20px -20px;
            padding: 15px 20px;
            border-radius: 10px 10px 0 0;
            border-bottom: 2px solid #e5e7eb;
        }
        
        .work-area-title {
            font-size: 18px;
            font-weight: 700;
            color: #1e293b;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .work-area-content {
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }
        
        /* ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ í…Œì´ë¸” ì»¬ëŸ¼ ë„ˆë¹„ */
        .worksby-projects-table th:nth-child(1),
        .worksby-projects-table td:nth-child(1) {
            width: 45% !important;
        }
        
        .worksby-projects-table th:nth-child(2),
        .worksby-projects-table td:nth-child(2) {
            width: 10% !important;
        }
        
        .worksby-projects-table th:nth-child(3),
        .worksby-projects-table td:nth-child(3) {
            width: 20% !important;
        }
        
        .worksby-projects-table th:nth-child(4),
        .worksby-projects-table td:nth-child(4) {
            width: 10% !important;
        }
        
        .worksby-projects-table th:nth-child(5),
        .worksby-projects-table td:nth-child(5) {
            width: 10% !important;
        }
        
        .worksby-projects-table th:nth-child(6),
        .worksby-projects-table td:nth-child(6) {
            width: 5% !important;
            text-align: center !important;
            vertical-align: middle !important;
        }
        
        /* ì¶œë°œì–´ ì˜ì—­ í…Œì´ë¸” ì»¬ëŸ¼ ë„ˆë¹„ (ì›ìŠ¤íŒŒì´ ë“±ë¡ í™•ì¸ ì»¬ëŸ¼ í¬í•¨) */
        #worksby-detail-area .file-table th:nth-child(1),
        #worksby-detail-area .file-table td:nth-child(1) {
            width: 30% !important;
        }
        
        #worksby-detail-area .file-table th:nth-child(2),
        #worksby-detail-area .file-table td:nth-child(2) {
            width: 8% !important;
        }
        
        #worksby-detail-area .file-table th:nth-child(3),
        #worksby-detail-area .file-table td:nth-child(3) {
            width: 10% !important;
        }
        
        #worksby-detail-area .file-table th:nth-child(4),
        #worksby-detail-area .file-table td:nth-child(4) {
            width: 12% !important;
        }
        
        #worksby-detail-area .file-table th:nth-child(5),
        #worksby-detail-area .file-table td:nth-child(5) {
            width: 10% !important;
        }
        
        #worksby-detail-area .file-table th:nth-child(6),
        #worksby-detail-area .file-table td:nth-child(6) {
            width: 10% !important;
        }
        
        #worksby-detail-area .file-table th:nth-child(7),
        #worksby-detail-area .file-table td:nth-child(7) {
            width: 12% !important;
        }
        
        #worksby-detail-area .file-table th:nth-child(8),
        #worksby-detail-area .file-table td:nth-child(8) {
            width: 8% !important;
        }
        
        #worksby-detail-area .file-table th:nth-child(9),
        #worksby-detail-area .file-table td:nth-child(9) {
            width: 8% !important;
        }
        
        /* ì¤‘ê°„ì–´ ì˜ì—­ í…Œì´ë¸” ì»¬ëŸ¼ ë„ˆë¹„ */
        #intermediate-language-area .file-table th:nth-child(1),
        #intermediate-language-area .file-table td:nth-child(1) {
            width: 22% !important;
        }
        
        #intermediate-language-area .file-table th:nth-child(2),
        #intermediate-language-area .file-table td:nth-child(2) {
            width: 8% !important;
        }
        
        #intermediate-language-area .file-table th:nth-child(3),
        #intermediate-language-area .file-table td:nth-child(3) {
            width: 8% !important;
        }
        
        #intermediate-language-area .file-table th:nth-child(4),
        #intermediate-language-area .file-table td:nth-child(4) {
            width: 8% !important;
        }
        
        #intermediate-language-area .file-table th:nth-child(5),
        #intermediate-language-area .file-table td:nth-child(5) {
            width: 8% !important;
        }
        
        #intermediate-language-area .file-table th:nth-child(6),
        #intermediate-language-area .file-table td:nth-child(6) {
            width: 8% !important;
        }
        
        #intermediate-language-area .file-table th:nth-child(7),
        #intermediate-language-area .file-table td:nth-child(7) {
            width: 10% !important;
        }
        
        #intermediate-language-area .file-table th:nth-child(8),
        #intermediate-language-area .file-table td:nth-child(8) {
            width: 12% !important;
        }
        
        #intermediate-language-area .file-table th:nth-child(9),
        #intermediate-language-area .file-table td:nth-child(9) {
            width: 11% !important;
        }
        
        #intermediate-language-area .file-table th:nth-child(10),
        #intermediate-language-area .file-table td:nth-child(10) {
            width: 7% !important;
        }
        
        /* ì¶œë°œì–´ ì˜ì—­ í…Œì´ë¸” ì»¬ëŸ¼ ê°•ì œ ì„¤ì • */
        [id^="worksby-detail-area-"] .file-table th:nth-child(1),
        [id^="worksby-detail-area-"] .file-table td:nth-child(1) { width: 16% !important; }
        [id^="worksby-detail-area-"] .file-table th:nth-child(2),
        [id^="worksby-detail-area-"] .file-table td:nth-child(2) { width: 26% !important; }
        [id^="worksby-detail-area-"] .file-table th:nth-child(3),
        [id^="worksby-detail-area-"] .file-table td:nth-child(3) { width: 5% !important; }
        [id^="worksby-detail-area-"] .file-table th:nth-child(4),
        [id^="worksby-detail-area-"] .file-table td:nth-child(4) { width: 7% !important; }
        [id^="worksby-detail-area-"] .file-table th:nth-child(5),
        [id^="worksby-detail-area-"] .file-table td:nth-child(5) { width: 7% !important; }
        [id^="worksby-detail-area-"] .file-table th:nth-child(6),
        [id^="worksby-detail-area-"] .file-table td:nth-child(6) { width: 10% !important; }
        [id^="worksby-detail-area-"] .file-table th:nth-child(7),
        [id^="worksby-detail-area-"] .file-table td:nth-child(7) { width: 7% !important; }
        [id^="worksby-detail-area-"] .file-table th:nth-child(8),
        [id^="worksby-detail-area-"] .file-table td:nth-child(8) { width: 10% !important; }
        [id^="worksby-detail-area-"] .file-table th:nth-child(9),
        [id^="worksby-detail-area-"] .file-table td:nth-child(9) { width: 7% !important; }
        [id^="worksby-detail-area-"] .file-table th:nth-child(10),
        [id^="worksby-detail-area-"] .file-table td:nth-child(10) { width: 5% !important; }
        
        /* ì¤‘ê°„ì–´ ì˜ì—­ í…Œì´ë¸” ì»¬ëŸ¼ ê°•ì œ ì„¤ì • */
        [id^="intermediate-language-area-"] .file-table th:nth-child(1),
        [id^="intermediate-language-area-"] .file-table td:nth-child(1) { width: 16% !important; }
        [id^="intermediate-language-area-"] .file-table th:nth-child(2),
        [id^="intermediate-language-area-"] .file-table td:nth-child(2) { width: 21% !important; }
        [id^="intermediate-language-area-"] .file-table th:nth-child(3),
        [id^="intermediate-language-area-"] .file-table td:nth-child(3) { width: 5% !important; }
        [id^="intermediate-language-area-"] .file-table th:nth-child(4),
        [id^="intermediate-language-area-"] .file-table td:nth-child(4) { width: 5% !important; }
        [id^="intermediate-language-area-"] .file-table th:nth-child(5),
        [id^="intermediate-language-area-"] .file-table td:nth-child(5) { width: 7% !important; }
        [id^="intermediate-language-area-"] .file-table th:nth-child(6),
        [id^="intermediate-language-area-"] .file-table td:nth-child(6) { width: 7% !important; }
        [id^="intermediate-language-area-"] .file-table th:nth-child(7),
        [id^="intermediate-language-area-"] .file-table td:nth-child(7) { width: 10% !important; }
        [id^="intermediate-language-area-"] .file-table th:nth-child(8),
        [id^="intermediate-language-area-"] .file-table td:nth-child(8) { width: 7% !important; }
        [id^="intermediate-language-area-"] .file-table th:nth-child(9),
        [id^="intermediate-language-area-"] .file-table td:nth-child(9) { width: 10% !important; }
        [id^="intermediate-language-area-"] .file-table th:nth-child(10),
        [id^="intermediate-language-area-"] .file-table td:nth-child(10) { width: 7% !important; }
        [id^="intermediate-language-area-"] .file-table th:nth-child(11),
        [id^="intermediate-language-area-"] .file-table td:nth-child(11) { width: 5% !important; }
        
        /* ë„ì°©ì–´ ì˜ì—­ í…Œì´ë¸” ì»¬ëŸ¼ ê°•ì œ ì„¤ì • */
        [id^="destination-container-"] .file-table th:nth-child(1),
        [id^="destination-container-"] .file-table td:nth-child(1) { width: 13% !important; }
        [id^="destination-container-"] .file-table th:nth-child(2),
        [id^="destination-container-"] .file-table td:nth-child(2) { width: 19% !important; }
        [id^="destination-container-"] .file-table th:nth-child(3),
        [id^="destination-container-"] .file-table td:nth-child(3) { width: 5% !important; }
        [id^="destination-container-"] .file-table th:nth-child(4),
        [id^="destination-container-"] .file-table td:nth-child(4) { width: 10% !important; }
        [id^="destination-container-"] .file-table th:nth-child(5),
        [id^="destination-container-"] .file-table td:nth-child(5) { width: 7% !important; }
        [id^="destination-container-"] .file-table th:nth-child(6),
        [id^="destination-container-"] .file-table td:nth-child(6) { width: 7% !important; }
        [id^="destination-container-"] .file-table th:nth-child(7),
        [id^="destination-container-"] .file-table td:nth-child(7) { width: 10% !important; }
        [id^="destination-container-"] .file-table th:nth-child(8),
        [id^="destination-container-"] .file-table td:nth-child(8) { width: 7% !important; }
        [id^="destination-container-"] .file-table th:nth-child(9),
        [id^="destination-container-"] .file-table td:nth-child(9) { width: 10% !important; }
        [id^="destination-container-"] .file-table th:nth-child(10),
        [id^="destination-container-"] .file-table td:nth-child(10) { width: 7% !important; }
        [id^="destination-container-"] .file-table th:nth-child(11),
        [id^="destination-container-"] .file-table td:nth-child(11) { width: 5% !important; }
        
        /* íŒŒì¼ ì—…ë¡œë“œ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            align-items: flex-start;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            flex: 1;
        }

        .form-group.full-width {
            flex: 1 1 100%;
        }

        .form-group label {
            margin-bottom: 6px;
            font-weight: 500;
            color: #374151;
            font-size: 14px;
        }

        .file-upload-area {
            border: 2px dashed #d1d5db;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: border-color 0.2s;
            background: #f9fafb;
            height: 180px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .file-upload-area:hover {
            border-color: #9ca3af;
        }

        .file-upload-btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            margin-top: 8px;
            transition: background-color 0.2s;
        }

        .file-upload-btn:hover {
            background: #2563eb;
        }

        .file-preview {
            position: relative;
            display: inline-block;
        }

        .file-remove-btn {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>
    <!-- í˜ì´ì§€ í—¤ë” -->
    <div class="page-header">
        <h1 class="page-title">
            <span>ğŸŒ</span>
            ë²ˆì—­ ì‘ì—… ìƒì„¸ì •ë³´
        </h1>
        <button class="back-button" onclick="goBack()">
            <span>â†</span>
            ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°
        </button>
    </div>
    
    <!-- ê¸°ë³¸ ì •ë³´ ì„¹ì…˜ -->
    <div class="info-section">
        <h2 class="section-title">
            <span>ğŸ“‹</span>
            ê¸°ë³¸ ì •ë³´
        </h2>
        <div class="basic-info-grid">
            <div class="info-item">
                <span class="info-label">í”„ë¡œì íŠ¸ ì œëª©</span>
                <div class="info-value" id="project-title">2025ë…„ êµ­ì œíšŒì˜ ë²ˆì—­ ë¬¸ì„œ</div>
            </div>
            <div class="info-item">
                <span class="info-label">ì—…ì²´ëª…</span>
                <div class="info-value" id="company-name">ì™¸êµë¶€</div>
            </div>
            <div class="info-item">
                <span class="info-label">ì˜ë¢°ìëª…</span>
                <div class="info-value" id="client-name">ê¹€ë¯¼ìˆ˜</div>
            </div>
        </div>
    </div>
    
    <!-- íŒŒì¼ ë¦¬ìŠ¤íŠ¸ ì„¹ì…˜ -->
    <div class="file-list-section">
        <h2 class="section-title">
            <span>ğŸ“</span>
            íŒŒì¼ ë¦¬ìŠ¤íŠ¸
        </h2>
        
        <table class="file-table main-file-table" style="table-layout: fixed !important; width: 100% !important;">
            <thead>
                <tr>
                    <th style="width: 4% !important; text-align: center;"><input type="checkbox" id="selectAllFiles" onclick="handleSelectAllClick(event, this);"></th>
                    <th style="width: 35% !important;">íŒŒì¼ ì´ë¦„</th>
                    <th style="width: 8% !important;">ì›ë³¸ ì–¸ì–´</th>
                    <th style="width: 18% !important;">ë„ì°© ì–¸ì–´</th>
                    <th style="width: 12% !important;">íŒŒì¼ ê¸¸ì´</th>
                    <th style="width: 10% !important;">í”„ë¡¬í”„íŠ¸</th>
                    <th style="width: 13% !important;">ì›ìŠ¤íŒŒì´ ë“±ë¡</th>
                </tr>
            </thead>
            <tbody>
                <tr onclick="selectFileRow(this)" style="cursor: pointer;" data-file-id="1">
                    <td style="text-align: center;"><input type="checkbox" class="file-select-checkbox" value="1" onclick="handleCheckboxClick(event, this);"></td>
                    <td class="file-name">êµ­ì œíšŒì˜_ë²ˆì—­ì˜ìƒ_2025_01.mp4</td>
                    <td>í•œê¸€</td>
                    <td>ì˜ì–´, ì¼ë³¸ì–´, ì¤‘êµ­ì–´(ê°„ì²´)</td>
                    <td>00:45:30</td>
                    <td style="text-align: center;"><span class="prompt-badge" style="background: #e5e7eb; color: #374151; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 500;">ê¸°ë³¸</span></td>
                    <td style="text-align: center;"><span class="worksby-status-badge" style="background: #fef2f2; color: #991b1b; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 500;">ë¯¸ë“±ë¡</span></td>
                </tr>
                <tr onclick="selectFileRow(this)" style="cursor: pointer;" data-file-id="2">
                    <td style="text-align: center;"><input type="checkbox" class="file-select-checkbox" value="2" onclick="handleCheckboxClick(event, this);"></td>
                    <td class="file-name">ì˜ë£Œì§„_ëŒ€í™”ì˜ìƒ_2025_02.avi</td>
                    <td>í•œê¸€</td>
                    <td>ì˜ì–´, ì¼ë³¸ì–´, ì¤‘êµ­ì–´(ê°„ì²´)</td>
                    <td>01:20:15</td>
                    <td style="text-align: center;"><span class="prompt-badge" style="background: #e5e7eb; color: #374151; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 500;">ê¸°ë³¸</span></td>
                    <td style="text-align: center;"><span class="worksby-status-badge" style="background: #fef2f2; color: #991b1b; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 500;">ë¯¸ë“±ë¡</span></td>
                </tr>
                <tr onclick="selectFileRow(this)" style="cursor: pointer;" data-file-id="3">
                    <td style="text-align: center;"><input type="checkbox" class="file-select-checkbox" value="3" onclick="handleCheckboxClick(event, this);"></td>
                    <td class="file-name">ê¸°ìˆ ì„¸ë¯¸ë‚˜_ì˜ìƒ_2025_03.mov</td>
                    <td>í•œê¸€</td>
                    <td>ì˜ì–´, ì¼ë³¸ì–´, ì¤‘êµ­ì–´(ê°„ì²´)</td>
                    <td>00:35:45</td>
                    <td style="text-align: center;"><span class="prompt-badge" style="background: #e5e7eb; color: #374151; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 500;">ê¸°ë³¸</span></td>
                    <td style="text-align: center;"><span class="worksby-status-badge" style="background: #fef2f2; color: #991b1b; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 500;">ë¯¸ë“±ë¡</span></td>
                </tr>
                <tr onclick="selectFileRow(this)" style="cursor: pointer;" data-file-id="4">
                    <td style="text-align: center;"><input type="checkbox" class="file-select-checkbox" value="4" onclick="handleCheckboxClick(event, this);"></td>
                    <td class="file-name">ë²•ë¥ ê³„ì•½íšŒì˜_ì˜ìƒ_2025_04.mkv</td>
                    <td>í•œê¸€</td>
                    <td>ì˜ì–´, ì¼ë³¸ì–´, ì¤‘êµ­ì–´(ê°„ì²´)</td>
                    <td>02:10:20</td>
                    <td style="text-align: center;"><span class="prompt-badge" style="background: #e5e7eb; color: #374151; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 500;">ê¸°ë³¸</span></td>
                    <td style="text-align: center;"><span class="worksby-status-badge" style="background: #fef2f2; color: #991b1b; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 500;">ë¯¸ë“±ë¡</span></td>
                </tr>
            </tbody>
        </table>
        
        <!-- íŒŒì¼ ë¦¬ìŠ¤íŠ¸ ì»¨íŠ¸ë¡¤ ë²„íŠ¼ ì˜ì—­ -->
        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 15px; padding: 15px 0;">
            <!-- ì™¼ìª½ ë²„íŠ¼ ê·¸ë£¹ -->
            <div style="display: flex; align-items: center; gap: 15px;">
                <select id="defaultPromptSelect" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; min-width: 120px;">
                    <option value="ê¸°ë³¸" selected>ê¸°ë³¸</option>
                    <option value="ì˜µì…˜1">ì˜µì…˜1</option>
                    <option value="ì˜µì…˜2">ì˜µì…˜2</option>
                    <option value="ì˜µì…˜3">ì˜µì…˜3</option>
                    <option value="ì˜µì…˜4">ì˜µì…˜4</option>
                    <option value="ì˜µì…˜5">ì˜µì…˜5</option>
                </select>
                <button class="btn" onclick="changeSelectedPrompt()" style="background: #8b5cf6; color: white; padding: 8px 16px; font-size: 14px; border: none; border-radius: 6px; cursor: pointer;">
                    <span>ğŸ”„</span>
                    ì„ íƒ í”„ë¡¬í”„íŠ¸ ë³€ê²½
                </button>
                <button class="btn" onclick="openBatchWorkerAssignmentModal()" style="background: #5b6bc0; color: white; padding: 8px 16px; font-size: 14px; border: none; border-radius: 6px; cursor: pointer;">
                    <span>ğŸ‘¥</span>
                    ì‘ì—…ì ì¼ê´„ ë°°ì •
                </button>
            </div>
            
            <!-- ì˜¤ë¥¸ìª½ ë²„íŠ¼ ê·¸ë£¹ -->
            <div style="display: flex; align-items: center; gap: 10px;">
                <button class="btn" onclick="addRequestFile()" style="background: #10b981; color: white; padding: 8px 16px; font-size: 14px; border: none; border-radius: 6px; cursor: pointer;">
                    <span>ğŸ“</span>
                    ì˜ë¢°íŒŒì¼ ì¶”ê°€
                </button>
                <button class="btn" onclick="splitSelectedFiles()" style="background: #f59e0b; color: white; padding: 8px 16px; font-size: 14px; border: none; border-radius: 6px; cursor: pointer;">
                    <span>âœ‚ï¸</span>
                    íŒŒì¼ ë¶„í• 
                </button>
                <button class="btn" onclick="createWorksbyProject()" style="background: #8b5cf6; color: white; padding: 8px 16px; font-size: 14px; border: none; border-radius: 6px; cursor: pointer;">
                    <span>ğŸš€</span>
                    ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„±
                </button>
                <button class="btn" onclick="downloadSelectedFiles()" style="background: #6b7280; color: white; padding: 8px 16px; font-size: 14px; border: none; border-radius: 6px; cursor: pointer;">
                    <span>â¬‡ï¸</span>
                    ì„ íƒ íŒŒì¼ ë‹¤ìš´ë¡œë“œ
                </button>
            </div>
        </div>
    </div>


    <!-- ì›ìŠ¤íŒŒì´ ë“±ë¡ ëª¨ë‹¬ -->
    <div id="worksbyRegistrationModal" class="modal-overlay" style="z-index: 1200;">
        <div class="modal-container" style="max-width: 800px; width: 90%;">
            <div class="modal-header">
                <h2>ğŸš€ ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ë“±ë¡</h2>
                <button class="modal-close" onclick="closeWorksbyRegistrationModal()">&times;</button>
            </div>
            
            <div class="modal-content" style="max-height: 70vh; overflow-y: auto;">
                <!-- ì„œë¹„ìŠ¤ -->
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">
                        ì„œë¹„ìŠ¤ <span style="color: red;">*</span>
                    </label>
                    <div style="display: flex; align-items: center; gap: 20px;">
                        <input type="text" value="ì†Œë¦¬ë°”ë¡œ" readonly
                               style="flex: 1; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; background: #f9fafb;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="checkbox" id="urgentToggle" onchange="toggleUrgent()">
                                <span style="background: #3b82f6; color: white; padding: 4px 8px; border-radius: 20px; font-size: 12px;">ì‹ ì²­ë²„íŠ¼</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="checkbox" id="importantToggle">
                                <span>ì¤‘ìš”</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- ì„ íƒëœ íŒŒì¼ ëª©ë¡ (ë‹¤ì¤‘ íŒŒì¼ì¼ ë•Œë§Œ í‘œì‹œ) -->
                <div id="selectedFilesInfo" style="margin-bottom: 20px; display: none;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">
                        ì„ íƒëœ íŒŒì¼ ëª©ë¡
                    </label>
                    <div id="selectedFilesList" style="background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 6px; padding: 12px; max-height: 120px; overflow-y: auto;">
                        <!-- ì„ íƒëœ íŒŒì¼ë“¤ì´ ë™ì ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                    <div style="margin-top: 8px; font-size: 12px; color: #6b7280;">
                        ê° íŒŒì¼ë§ˆë‹¤ ë³„ë„ì˜ ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ê°€ ìƒì„±ë©ë‹ˆë‹¤.
                    </div>
                </div>

                <!-- í”„ë¡œì íŠ¸ëª… -->
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">
                        í”„ë¡œì íŠ¸ëª… <span style="color: red;">*</span>
                    </label>
                    <input type="text" id="worksbyProjectName" placeholder="í”„ë¡œì íŠ¸ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"
                           style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px;">
                    <div id="projectNameHint" style="margin-top: 6px; font-size: 12px; color: #6b7280; display: none;">
                        ë‹¤ì¤‘ íŒŒì¼ì˜ ê²½ìš° í”„ë¡œì íŠ¸ëª… ë’¤ì— "_1", "_2" ë“±ì´ ìë™ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤.
                    </div>
                </div>

                <!-- ëª¨ì§‘ê¸°ê°„ -->
                <div style="margin-bottom: 20px; display: flex; gap: 20px; align-items: end;">
                    <div style="flex: 1;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">
                            ëª¨ì§‘ê¸°ê°„ <span style="color: red;">*</span>
                        </label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <input type="datetime-local" id="recruitStartDate"
                                   style="padding: 8px; border: 1px solid #d1d5db; border-radius: 4px;">
                            <span>~</span>
                            <input type="datetime-local" id="recruitEndDate"
                                   style="padding: 8px; border: 1px solid #d1d5db; border-radius: 4px;">
                        </div>
                    </div>
                    <div style="display: flex; gap: 15px; align-items: center;">
                        <div>
                            <label style="display: block; margin-bottom: 4px; font-size: 12px; color: #6b7280;">ì‘ì—…ì ìˆ˜</label>
                            <input type="number" value="5" min="1"
                                   style="width: 60px; padding: 8px; border: 1px solid #d1d5db; border-radius: 4px; text-align: center;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 4px; font-size: 12px; color: #6b7280;">ê¸‰ì•¡</label>
                            <input type="number" value="500000" min="0"
                                   style="width: 100px; padding: 8px; border: 1px solid #d1d5db; border-radius: 4px; text-align: right;">
                        </div>
                    </div>
                </div>

                <!-- ì‘ì—…ê¸°ê°„ -->
                <div style="margin-bottom: 20px; display: flex; gap: 20px; align-items: end;">
                    <div style="flex: 1;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">
                            ì‘ì—…ê¸°ê°„ <span style="color: red;">*</span>
                        </label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <input type="date" id="workStartDate"
                                   style="padding: 8px; border: 1px solid #d1d5db; border-radius: 4px;">
                            <span>~</span>
                            <input type="date" id="workEndDate"
                                   style="padding: 8px; border: 1px solid #d1d5db; border-radius: 4px;">
                        </div>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 4px; font-size: 12px; color: #6b7280;">ì§€ì›ìê²©</label>
                        <select style="padding: 8px; border: 1px solid #d1d5db; border-radius: 4px; min-width: 100px;">
                            <option>ëˆ„êµ¬ë‚˜</option>
                            <option>ì´ˆê¸‰</option>
                            <option>ì¤‘ê¸‰</option>
                            <option>ê³ ê¸‰</option>
                        </select>
                    </div>
                </div>

                <!-- í”„ë¡œì íŠ¸ ì„¤ëª… -->
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">í”„ë¡œì íŠ¸ ì„¤ëª…</label>
                    <div style="border: 1px solid #d1d5db; border-radius: 6px; min-height: 120px; padding: 12px; background: white;">
                        <div style="margin-bottom: 10px;">
                            <button type="button" style="padding: 4px 8px; margin-right: 5px; border: 1px solid #d1d5db; background: white; border-radius: 3px; cursor: pointer;"><strong>B</strong></button>
                            <button type="button" style="padding: 4px 8px; margin-right: 5px; border: 1px solid #d1d5db; background: white; border-radius: 3px; cursor: pointer;"><em>I</em></button>
                            <button type="button" style="padding: 4px 8px; margin-right: 5px; border: 1px solid #d1d5db; background: white; border-radius: 3px; cursor: pointer;">ğŸ”—</button>
                        </div>
                        <textarea id="projectDescription" placeholder="í”„ë¡œì íŠ¸ì— ëŒ€í•œ ìƒì„¸ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"
                                  style="width: 100%; height: 80px; border: none; outline: none; resize: vertical;">ì‹œê¸‰ êµ¬í•¨
ì—°ìŠµí•©ë‹ˆë‹¤.
êµ¬í•©ë‹ˆë‹¤. êµ¬í•©ë‹ˆë‹¤.</textarea>
                    </div>
                </div>

                <!-- ì¸ë„¤ì¼ê³¼ ì²¨ë¶€íŒŒì¼ -->
                <div style="display: flex; gap: 20px; margin-bottom: 30px;">
                    <!-- ì¸ë„¤ì¼ -->
                    <div style="flex: 1;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">ì¸ë„¤ì¼</label>
                        <div style="border: 2px dashed #d1d5db; border-radius: 8px; padding: 40px; text-align: center; background: #f9fafb;">
                            <div style="margin-bottom: 10px;">ğŸ–¼ï¸</div>
                            <div style="color: #6b7280; margin-bottom: 10px;">ì¸ë„¤ì¼ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”</div>
                            <div style="font-size: 12px; color: #9ca3af;">JPG, PNG, GIF (ìµœëŒ€ 5MB)</div>
                            <button type="button" onclick="selectThumbnail()"
                                    style="margin-top: 15px; padding: 8px 16px; background: #3b82f6; color: white; border: none; border-radius: 4px; cursor: pointer;">
                                íŒŒì¼ ì„ íƒ
                            </button>
                        </div>
                    </div>

                    <!-- ì²¨ë¶€íŒŒì¼ -->
                    <div style="flex: 1;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">ì²¨ë¶€íŒŒì¼</label>
                        <div style="border: 2px dashed #d1d5db; border-radius: 8px; padding: 40px; text-align: center; background: #f9fafb;">
                            <div style="margin-bottom: 10px;">ğŸ“</div>
                            <div style="color: #6b7280; margin-bottom: 10px;">ì²¨ë¶€íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”</div>
                            <div style="font-size: 12px; color: #9ca3af;">ëª¨ë“  íŒŒì¼ í˜•ì‹ (ìµœëŒ€ 10MB)</div>
                            <button type="button" onclick="selectAttachment()"
                                    style="margin-top: 15px; padding: 8px 16px; background: #3b82f6; color: white; border: none; border-radius: 4px; cursor: pointer;">
                                íŒŒì¼ ì„ íƒ
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <div style="color: #6b7280; font-size: 14px;">
                    ì„ íƒëœ íŒŒì¼: <span id="worksby-selected-file-name">1</span>ê°œ | ìƒì„±í•  í”„ë¡œì íŠ¸: <span id="worksby-target-count">1</span>ê°œ
                </div>
                <div>
                    <button id="worksbyRegisterBtn" class="btn btn-success" onclick="handleWorksbyRegister()" style="padding: 12px 30px; font-size: 16px; font-weight: 600;">
                        <span>ğŸš€</span>
                        ë“±ë¡
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- í”„ë¡œì íŠ¸ ì œëª© ì…ë ¥ ëª¨ë‹¬ -->
    <div id="projectTitleModal" class="modal-overlay" style="z-index: 1100;">
        <div class="modal-container" style="max-width: 400px;">
            <div class="modal-header">
                <h2>ğŸ“ ë¶„ë¥˜ëª… ì…ë ¥</h2>
                <button class="modal-close" onclick="closeProjectTitleModal()">&times;</button>
            </div>
            
            <div class="modal-content">
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">ë¶„ë¥˜ëª…</label>
                    <input type="text" id="projectTitleInput" placeholder="ë¶„ë¥˜ëª…ì„ ì…ë ¥í•˜ì„¸ìš”" 
                           style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px;">
                </div>
                
                <div style="color: #6b7280; font-size: 13px; margin-bottom: 20px;">
                    ì„ íƒëœ íŒŒì¼ë“¤ì´ ì´ ë¶„ë¥˜ëª…ìœ¼ë¡œ íŒŒì¼ ì„¸íŒ… ì˜ì—­ì— ì¶”ê°€ë©ë‹ˆë‹¤.
                </div>
            </div>
            
            <div class="modal-footer">
                <div></div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn" onclick="closeProjectTitleModal()" 
                            style="background: #6b7280; color: white; padding: 10px 20px;">
                        ì·¨ì†Œ
                    </button>
                    <button class="btn btn-primary" onclick="confirmProjectTitle()">
                        <span>âœ…</span>
                        í™•ì¸
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ì„ íƒíŒŒì¼ ë¶„í•  ëª¨ë‹¬ -->
    <div id="fileSplitModal" class="modal-overlay" style="z-index: 1100;">
        <div class="modal-container" style="max-width: 500px;">
            <div class="modal-header">
                <h2>âœ‚ï¸ ì„ íƒíŒŒì¼ ë¶„í• </h2>
                <button class="modal-close" onclick="closeFileSplitModal()">&times;</button>
            </div>
            
            <div class="modal-content">
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">íŒŒì¼ëª…</label>
                    <input type="text" id="splitFileName" value="êµ­ì œíšŒì˜_ë²ˆì—­ì˜ìƒ_2025_01.mp4" 
                           style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px; background: #f9fafb;" readonly>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #374151;">íŒŒì¼ ê¸¸ì´</label>
                    <input type="text" id="splitFileLength" value="00:45:30" 
                           style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px; background: #f9fafb;" readonly>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 12px; font-weight: 600; color: #374151;">êµ¬ê°„ ì„¤ì •</label>
                    
                    <div id="timeRanges">
                        <div class="time-range-row" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <input type="text" value="" placeholder="00:00:00" maxlength="8" 
                                   onfocus="clearPlaceholder(this)" 
                                   oninput="formatTimeInput(this)" 
                                   onblur="validateAndFormatTime(this)" 
                                   onkeypress="handleTimeKeypress(event, this)"
                                   style="padding: 8px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 14px; width: 100px; text-align: center; font-family: monospace;">
                            <span style="color: #6b7280;">~</span>
                            <input type="text" value="" placeholder="00:00:00" maxlength="8" 
                                   onfocus="clearPlaceholder(this)" 
                                   oninput="formatTimeInput(this)" 
                                   onblur="handleEndTimeComplete(this)" 
                                   onkeypress="handleTimeKeypress(event, this)"
                                   style="padding: 8px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 14px; width: 100px; text-align: center; font-family: monospace;">
                            <button class="btn" onclick="removeTimeRange(this)" 
                                    style="background: #ef4444; color: white; padding: 6px 10px; font-size: 12px; min-width: auto;">
                                âœ•
                            </button>
                        </div>
                        
                        <div class="time-range-row" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <input type="text" value="" placeholder="00:00:00" maxlength="8" 
                                   onfocus="clearPlaceholder(this)" 
                                   oninput="formatTimeInput(this)" 
                                   onblur="validateAndFormatTime(this)" 
                                   onkeypress="handleTimeKeypress(event, this)"
                                   style="padding: 8px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 14px; width: 100px; text-align: center; font-family: monospace;">
                            <span style="color: #6b7280;">~</span>
                            <input type="text" value="" placeholder="00:00:00" maxlength="8" 
                                   onfocus="clearPlaceholder(this)" 
                                   oninput="formatTimeInput(this)" 
                                   onblur="handleEndTimeComplete(this)" 
                                   onkeypress="handleTimeKeypress(event, this)"
                                   style="padding: 8px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 14px; width: 100px; text-align: center; font-family: monospace;">
                            <button class="btn" onclick="removeTimeRange(this)" 
                                    style="background: #ef4444; color: white; padding: 6px 10px; font-size: 12px; min-width: auto;">
                                âœ•
                            </button>
                        </div>
                    </div>
                    
                    <button class="btn" onclick="addTimeRange()" 
                            style="background: #6b7280; color: white; padding: 8px 16px; font-size: 13px; margin-top: 10px;">
                        + êµ¬ê°„ì¶”ê°€
                    </button>
                </div>
            </div>
            
            <div class="modal-footer">
                <div></div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn" onclick="closeFileSplitModal()" 
                            style="background: #6b7280; color: white; padding: 10px 20px;">
                        ì·¨ì†Œ
                    </button>
                    <button class="btn btn-success" onclick="confirmFileSplit()">
                        <span>âœ…</span>
                        ë¶„í• 
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- íŒŒì¼ ì„¸íŒ… ëª¨ë‹¬ -->
    <div id="worksbyModal" class="modal-overlay">
        <div class="modal-container" style="max-width: 1400px; width: 98%;">
            <div class="modal-header">
                <h2>âš™ï¸ íŒŒì¼ ì„¸íŒ…</h2>
                <button class="modal-close" onclick="closeWorksbyModal()">&times;</button>
            </div>
            
            <div class="modal-content">
                <h3 style="margin-bottom: 15px; color: #374151;">íŒŒì¼ ì„ íƒ ë° ìˆœì„œ ì¡°ì •</h3>
                
                <table class="file-table" style="table-layout: fixed; width: 100%;">
                    <thead>
                        <tr>
                            <th style="width: 4%; padding: 8px; text-align: center; font-size: 12px; white-space: nowrap;">ì„ íƒ</th>
                            <th style="width: 40%; padding: 8px; text-align: center; font-size: 12px; white-space: nowrap;">íŒŒì¼ ì´ë¦„</th>
                            <th style="width: 8%; padding: 8px; text-align: center; font-size: 12px; white-space: nowrap;">ì›ë³¸ì–¸ì–´</th>
                            <th style="width: 25%; padding: 8px; text-align: center; font-size: 12px; white-space: nowrap;">ë„ì°©ì–¸ì–´</th>
                            <th style="width: 10%; padding: 8px; text-align: center; font-size: 12px; white-space: nowrap;">íŒŒì¼ê¸¸ì´</th>
                            <th style="width: 13%; padding: 8px; text-align: center; font-size: 12px; white-space: nowrap;">ìƒíƒœ</th>
                        </tr>
                    </thead>
                    <tbody id="modal-file-list">
                        <tr id="modal-file-1">
                            <td style="text-align: center;"><input type="checkbox" class="modal-file-checkbox" value="1"></td>
                            <td class="file-name">êµ­ì œíšŒì˜_ë²ˆì—­ì˜ìƒ_2025_01.mp4</td>
                            <td>í•œê¸€</td>
                            <td>ì˜ì–´, ì¼ë³¸ì–´, ì¤‘êµ­ì–´(ê°„ì²´)</td>
                            <td>00:45:30</td>
                            <td style="text-align: center;"><span class="status-badge status-ready">ëŒ€ê¸°</span></td>
                        </tr>
                        <tr id="modal-file-2">
                            <td style="text-align: center;"><input type="checkbox" class="modal-file-checkbox" value="2"></td>
                            <td class="file-name">ì˜ë£Œì§„_ëŒ€í™”ì˜ìƒ_2025_02.avi</td>
                            <td>í•œê¸€</td>
                            <td>ì˜ì–´, ì¼ë³¸ì–´, ì¤‘êµ­ì–´(ê°„ì²´)</td>
                            <td>01:20:15</td>
                            <td style="text-align: center;"><span class="status-badge status-ready">ëŒ€ê¸°</span></td>
                        </tr>
                        <tr id="modal-file-3">
                            <td style="text-align: center;"><input type="checkbox" class="modal-file-checkbox" value="3"></td>
                            <td class="file-name">ê¸°ìˆ ì„¸ë¯¸ë‚˜_ì˜ìƒ_2025_03.mov</td>
                            <td>í•œê¸€</td>
                            <td>ì˜ì–´, ì¼ë³¸ì–´, ì¤‘êµ­ì–´(ê°„ì²´)</td>
                            <td>00:35:45</td>
                            <td style="text-align: center;"><span class="status-badge status-ready">ëŒ€ê¸°</span></td>
                        </tr>
                        <tr id="modal-file-4">
                            <td style="text-align: center;"><input type="checkbox" class="modal-file-checkbox" value="4"></td>
                            <td class="file-name">ë²•ë¥ ê³„ì•½íšŒì˜_ì˜ìƒ_2025_04.mkv</td>
                            <td>í•œê¸€</td>
                            <td>ì˜ì–´, ì¼ë³¸ì–´, ì¤‘êµ­ì–´(ê°„ì²´)</td>
                            <td>02:10:20</td>
                            <td style="text-align: center;"><span class="status-badge status-ready">ëŒ€ê¸°</span></td>
                        </tr>
                    </tbody>
                </table>
                
                <!-- íŒŒì¼ ìˆœì„œ ì¡°ì • ë²„íŠ¼ -->
                <div style="text-align: center; margin: 20px 0;">
                    <button class="arrow-button" onclick="moveSelectedFilesDown()" title="ì„ íƒëœ íŒŒì¼ì„ ì•„ë˜ë¡œ ì´ë™">
                        <span>â¬‡ï¸</span>
                        ì•„ë˜ë¡œ ì´ë™
                    </button>
                </div>
                
                <!-- í•˜ë‹¨ í…œí”Œë¦¿ ì˜ì—­ -->
                <div style="margin-top: 30px;">
                    <h3 style="color: #374151; margin-bottom: 15px;">ğŸ“‹ ì›ìŠ¤íŒŒì´ ë“±ë¡ ëŒ€ìƒ íŒŒì¼</h3>
                    
                    <table class="file-table" style="background: #f8f9fa;">
                        <thead>
                            <tr style="background: #e5e7eb;">
                                <th style="width: 4%;">ì„ íƒ</th>
                                <th style="width: 15%;">ë¶„ë¥˜ëª…</th>
                                <th style="width: 40%;">íŒŒì¼ ì´ë¦„</th>
                                <th style="width: 8%;">ì›ë³¸ì–¸ì–´</th>
                                <th style="width: 25%;">ë„ì°©ì–¸ì–´</th>
                                <th style="width: 8%;">íŒŒì¼ê¸¸ì´</th>
                            </tr>
                        </thead>
                        <tbody id="target-file-list">
                            <tr id="empty-state" style="background: white;">
                                <td colspan="6" style="padding: 40px; text-align: center; color: #9ca3af; font-style: italic;">
                                    ìœ„ì—ì„œ íŒŒì¼ì„ ì„ íƒí•˜ê³  "ì•„ë˜ë¡œ ì´ë™" ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="modal-footer">
                <div>
                    <span style="color: #6b7280; font-size: 14px;">
                        ì„ íƒëœ íŒŒì¼: <span id="selected-count">0</span>ê°œ
                    </span>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-warning" onclick="splitSelectedFiles()">
                        <span>âœ‚ï¸</span>
                        ë¶„í• 
                    </button>
                    <button class="btn btn-success" onclick="registerToWorkspy()">
                        <span>âœ…</span>
                        ì™„ë£Œ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ë’¤ë¡œ ê°€ê¸° í•¨ìˆ˜ (trans-detail.htmlì—ì„œ ê°€ì ¸ì˜´)
        function goBack() {
            try {
                if (window.parent && window.parent !== window && typeof window.parent.loadPage === 'function') {
                    window.parent.loadPage('pages/page_kor/translation/trans-management.html');
                    return;
                }
            } catch (e) {
                console.log('parent.loadPage ì‹¤íŒ¨:', e);
            }
            
            try {
                if (window.history.length > 1) {
                    window.history.back();
                    return;
                }
            } catch (e) {
                console.log('history.back() ì‹¤íŒ¨:', e);
            }
            
            try {
                window.location.href = 'trans-management.html';
            } catch (e) {
                console.log('ì§ì ‘ í˜ì´ì§€ ì´ë™ ì‹¤íŒ¨:', e);
                alert('ì´ì „ í˜ì´ì§€ë¡œ ëŒì•„ê°ˆ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
        }
        
        // ë©”ì¸ íŒŒì¼ í…Œì´ë¸” ì»¬ëŸ¼ ë„ˆë¹„ ê°•ì œ ì„¤ì • í•¨ìˆ˜
        function forceMainTableColumnWidths() {
            const table = document.querySelector('.main-file-table');
            if (table) {
                // í…Œì´ë¸” ë ˆì´ì•„ì›ƒ ê°•ì œ ì„¤ì •
                table.style.tableLayout = 'fixed';
                table.style.width = '100%';
                
                // í—¤ë” ì»¬ëŸ¼ ë„ˆë¹„ ê°•ì œ ì„¤ì •
                const headerCells = table.querySelectorAll('thead th');
                const widths = ['4%', '35%', '8%', '18%', '12%', '10%', '13%'];
                headerCells.forEach((cell, index) => {
                    if (widths[index]) {
                        cell.style.width = widths[index];
                        cell.style.minWidth = widths[index];
                        cell.style.maxWidth = widths[index];
                    }
                });
                
                // ë°ì´í„° ì…€ ë„ˆë¹„ë„ ê°•ì œ ì„¤ì •
                const dataCells = table.querySelectorAll('tbody td');
                dataCells.forEach((cell, index) => {
                    const colIndex = index % 7;
                    if (widths[colIndex]) {
                        cell.style.width = widths[colIndex];
                        cell.style.minWidth = widths[colIndex];
                        cell.style.maxWidth = widths[colIndex];
                    }
                });
                
                console.log('ë©”ì¸ íŒŒì¼ í…Œì´ë¸” ì»¬ëŸ¼ ë„ˆë¹„ ê°•ì œ ì„¤ì • ì™„ë£Œ');
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', function() {
            forceMainTableColumnWidths();
            // ì•½ê°„ì˜ ì§€ì—° í›„ í•œ ë²ˆ ë” ì‹¤í–‰ (ë¸Œë¼ìš°ì € ë Œë”ë§ ì™„ë£Œ í›„)
            setTimeout(forceMainTableColumnWidths, 100);
        });
        
        // ì›ìŠ¤íŒŒì´ ëª¨ë‹¬ ì—´ê¸°
        function openWorksbyModal() {
            document.getElementById('worksbyModal').style.display = 'flex';
            updateSelectedCount();
        }
        
        // ì›ìŠ¤íŒŒì´ ëª¨ë‹¬ ë‹«ê¸°
        function closeWorksbyModal() {
            document.getElementById('worksbyModal').style.display = 'none';
            // ì²´í¬ë°•ìŠ¤ ì´ˆê¸°í™”
            document.querySelectorAll('.modal-file-checkbox').forEach(cb => {
                cb.checked = false;
            });
            
            // í•˜ë‹¨ í…œí”Œë¦¿ ì´ˆê¸°í™”
            const targetTbody = document.getElementById('target-file-list');
            targetTbody.innerHTML = `
                <tr id="empty-state" style="background: white;">
                    <td colspan="6" style="padding: 40px; text-align: center; color: #9ca3af; font-style: italic;">
                        ìœ„ì—ì„œ íŒŒì¼ì„ ì„ íƒí•˜ê³  "ì•„ë˜ë¡œ ì´ë™" ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”
                    </td>
                </tr>
            `;
            
            updateSelectedCount();
        }
        
        // ì„ íƒëœ íŒŒì¼ ê°œìˆ˜ ì—…ë°ì´íŠ¸
        function updateSelectedCount() {
            const checkedBoxes = document.querySelectorAll('.modal-file-checkbox:checked');
            const targetRows = document.querySelectorAll('#target-file-list tr:not(#empty-state)');
            const footerText = document.querySelector('.modal-footer span');
            
            if (footerText) {
                footerText.innerHTML = `ì„ íƒëœ íŒŒì¼: ${checkedBoxes.length}ê°œ | ë“±ë¡ ëŒ€ìƒ: ${targetRows.length}ê°œ`;
            }
        }
        
        // ì²´í¬ë°•ìŠ¤ ë³€ê²½ ì‹œ ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
        document.addEventListener('change', function(e) {
            if (e.target.classList.contains('modal-file-checkbox')) {
                updateSelectedCount();
            } else if (e.target.classList.contains('file-select-checkbox') && !e.target.disabled) {
                // ì›ë³¸ íŒŒì¼ì˜ ì²´í¬ë°•ìŠ¤ê°€ ë³€ê²½ëœ ê²½ìš°, ë¶„í• ëœ íŒŒì¼ë“¤ë„ ì—°ë™
                const parentRow = e.target.closest('tr');
                if (parentRow && parentRow.classList.contains('tree-parent')) {
                    toggleSplitFilesCheckbox(parentRow, e.target.checked);
                }
                
                updateSelectAllCheckbox();
            }
        });
        
        // ì„ íƒëœ íŒŒì¼ë“¤ì„ í•˜ë‹¨ í…œí”Œë¦¿ìœ¼ë¡œ ì´ë™ (í”„ë¡œì íŠ¸ ì œëª© ì…ë ¥ í›„)
        function moveSelectedFilesDown() {
            const checkedBoxes = document.querySelectorAll('.modal-file-checkbox:checked');
            
            if (checkedBoxes.length === 0) {
                alert('ì´ë™í•  íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // í”„ë¡œì íŠ¸ ì œëª© ì…ë ¥ ëª¨ë‹¬ ì—´ê¸°
            const modal = document.getElementById('projectTitleModal');
            if (modal) {
                modal.style.display = 'flex';
                const input = document.getElementById('projectTitleInput');
                if (input) {
                    input.focus();
                }
            }
        }
        
        // í”„ë¡œì íŠ¸ ì œëª© ëª¨ë‹¬ ë‹«ê¸°
        function closeProjectTitleModal() {
            document.getElementById('projectTitleModal').style.display = 'none';
            document.getElementById('projectTitleInput').value = '';
        }
        
        // í”„ë¡œì íŠ¸ ì œëª© í™•ì¸ í›„ íŒŒì¼ ì´ë™
        function confirmProjectTitle() {
            const projectTitle = document.getElementById('projectTitleInput').value.trim();
            
            if (!projectTitle) {
                alert('ë¶„ë¥˜ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const checkedBoxes = document.querySelectorAll('.modal-file-checkbox:checked');
            const targetTbody = document.getElementById('target-file-list');
            const emptyState = document.getElementById('empty-state');
            
            // ë¹ˆ ìƒíƒœ ë©”ì‹œì§€ ì œê±°
            if (emptyState) {
                emptyState.remove();
            }
            
            // ì„ íƒëœ íŒŒì¼ë“¤ì„ í•˜ë‹¨ í…œí”Œë¦¿ìœ¼ë¡œ ë³µì‚¬
            checkedBoxes.forEach(checkbox => {
                const originalRow = checkbox.closest('tr');
                
                // ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼
                originalRow.classList.add('file-moving');
                
                // ìƒíƒœë¥¼ 'ì´ë™ë¨'ìœ¼ë¡œ ë³€ê²½
                const statusCell = originalRow.querySelector('.status-badge');
                statusCell.textContent = 'ì´ë™ë¨';
                statusCell.className = 'status-badge status-moved';
                
                // ìƒˆë¡œìš´ í–‰ ìƒì„± (ì²´í¬ë°•ìŠ¤ì™€ í”„ë¡œì íŠ¸ ì œëª© í¬í•¨)
                const newRow = document.createElement('tr');
                newRow.style.background = 'white';
                newRow.innerHTML = `
                    <td style="text-align: center;"><input type="checkbox" class="target-file-checkbox"></td>
                    <td style="font-weight: 500; color: #3b82f6; text-align: center;">${projectTitle}</td>
                    <td class="file-name" style="text-align: center;">${originalRow.querySelector('.file-name').textContent}</td>
                    <td style="text-align: center;">${originalRow.querySelector('td:nth-child(3)').textContent}</td>
                    <td style="text-align: center;">${originalRow.querySelector('td:nth-child(4)').textContent}</td>
                    <td style="text-align: center;">${originalRow.querySelector('td:nth-child(5)').textContent}</td>
                `;
                
                // í•˜ë‹¨ í…œí”Œë¦¿ì— ì¶”ê°€
                targetTbody.appendChild(newRow);
                
                // ì›ë³¸ í–‰ì—ì„œ ì²´í¬ í•´ì œ
                checkbox.checked = false;
                
                // ì• ë‹ˆë©”ì´ì…˜ ì™„ë£Œ í›„ í´ë˜ìŠ¤ ì œê±°
                setTimeout(() => {
                    originalRow.classList.remove('file-moving');
                }, 500);
            });
            
            // ì„ íƒëœ íŒŒì¼ ê°œìˆ˜ ì—…ë°ì´íŠ¸
            updateSelectedCount();
            updateTargetCount();
            
            // ëª¨ë‹¬ ë‹«ê¸°
            closeProjectTitleModal();
            
            alert(`${checkedBoxes.length}ê°œ íŒŒì¼ì´ "${projectTitle}" ë¶„ë¥˜ë¡œ ì„¸íŒ…ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        }
        
        // í•˜ë‹¨ í…œí”Œë¦¿ì˜ íŒŒì¼ ê°œìˆ˜ ì—…ë°ì´íŠ¸
        function updateTargetCount() {
            const targetRows = document.querySelectorAll('#target-file-list tr:not(#empty-state)');
            const footerText = document.querySelector('.modal-footer span');
            if (footerText) {
                const selectedCount = document.querySelectorAll('.modal-file-checkbox:checked').length;
                const targetCount = targetRows.length;
                footerText.innerHTML = `ì„ íƒëœ íŒŒì¼: ${selectedCount}ê°œ | ë“±ë¡ ëŒ€ìƒ: ${targetCount}ê°œ`;
            }
        }
        
        // ì„ íƒëœ íŒŒì¼ë“¤ ë¶„í• 
        function splitSelectedFiles() {
            const targetRows = document.querySelectorAll('#target-file-list tr:not(#empty-state)');
            
            if (targetRows.length === 0) {
                alert('ë¶„í• í•  íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € íŒŒì¼ì„ ë“±ë¡ ëŒ€ìƒìœ¼ë¡œ ì´ë™í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì²« ë²ˆì§¸ íŒŒì¼ì„ ê¸°ì¤€ìœ¼ë¡œ ë¶„í•  ëª¨ë‹¬ ì—´ê¸°
            const firstFile = targetRows[0];
            const fileName = firstFile.querySelector('.file-name').textContent;
            const fileLength = firstFile.querySelector('td:nth-child(6)').textContent; // íŒŒì¼ ê¸¸ì´ ì»¬ëŸ¼
            
            document.getElementById('splitFileName').value = fileName;
            document.getElementById('splitFileLength').value = fileLength;
            document.getElementById('fileSplitModal').style.display = 'flex';
        }
        
        // íŒŒì¼ ë¶„í•  ëª¨ë‹¬ ë‹«ê¸°
        function closeFileSplitModal() {
            document.getElementById('fileSplitModal').style.display = 'none';
        }
        
        // ì‹œê°„ êµ¬ê°„ ì¶”ê°€
        function addTimeRange() {
            const timeRanges = document.getElementById('timeRanges');
            const existingRanges = timeRanges.querySelectorAll('.time-range-row');
            
            // ë§ˆì§€ë§‰ êµ¬ê°„ì˜ ì¢…ë£Œ ì‹œê°„ì„ ìƒˆ êµ¬ê°„ì˜ ì‹œì‘ ì‹œê°„ìœ¼ë¡œ ì„¤ì •
            let newStartTime = "";
            if (existingRanges.length > 0) {
                const lastRange = existingRanges[existingRanges.length - 1];
                const lastEndTimeInput = lastRange.querySelectorAll('input')[1];
                newStartTime = lastEndTimeInput.value || "";
            }
            
            const newRange = document.createElement('div');
            newRange.className = 'time-range-row';
            newRange.style.cssText = 'display: flex; align-items: center; gap: 10px; margin-bottom: 10px;';
            
            newRange.innerHTML = `
                <input type="text" value="${newStartTime}" placeholder="00:00:00" maxlength="8" 
                       onfocus="clearPlaceholder(this)" 
                       oninput="formatTimeInput(this)" 
                       onblur="validateAndFormatTime(this)" 
                       onkeypress="handleTimeKeypress(event, this)"
                       style="padding: 8px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 14px; width: 100px; text-align: center; font-family: monospace;">
                <span style="color: #6b7280;">~</span>
                <input type="text" value="" placeholder="00:00:00" maxlength="8" 
                       onfocus="clearPlaceholder(this)" 
                       oninput="formatTimeInput(this)" 
                       onblur="handleEndTimeComplete(this)" 
                       onkeypress="handleTimeKeypress(event, this)"
                       style="padding: 8px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 14px; width: 100px; text-align: center; font-family: monospace;">
                <button class="btn" onclick="removeTimeRange(this)" 
                        style="background: #ef4444; color: white; padding: 6px 10px; font-size: 12px; min-width: auto;">
                    âœ•
                </button>
            `;
            
            timeRanges.appendChild(newRange);
        }
        
        // ì‹œê°„ êµ¬ê°„ ì œê±°
        function removeTimeRange(button) {
            const timeRanges = document.getElementById('timeRanges');
            if (timeRanges.children.length > 1) {
                button.closest('.time-range-row').remove();
                // êµ¬ê°„ ì œê±° í›„ ì‹œê°„ ì—°ê²° ì—…ë°ì´íŠ¸
                updateTimeRangeConnections();
            } else {
                alert('ìµœì†Œ 1ê°œì˜ êµ¬ê°„ì€ í•„ìš”í•©ë‹ˆë‹¤.');
            }
        }
        
        // í”Œë ˆì´ìŠ¤í™€ë” ì§€ìš°ê¸° (í¬ì»¤ìŠ¤ ì‹œ)
        function clearPlaceholder(input) {
            // í¬ì»¤ìŠ¤ ì‹œ ê°’ì´ ë¹„ì–´ìˆìœ¼ë©´ ê·¸ëŒ€ë¡œ ë‘ê³ , ì‚¬ìš©ìê°€ ì…ë ¥í•  ìˆ˜ ìˆë„ë¡ í•¨
            input.select(); // ì „ì²´ ì„ íƒí•˜ì—¬ ì‰½ê²Œ ë®ì–´ì“¸ ìˆ˜ ìˆë„ë¡
        }
        
        // ì‹œê°„ ì…ë ¥ ìë™ í¬ë§·íŒ… (ì‹¤ì‹œê°„)
        function formatTimeInput(input) {
            let value = input.value.replace(/[^0-9]/g, ''); // ìˆ«ìë§Œ ë‚¨ê¸°ê¸°
            
            if (value.length >= 6) {
                // 6ìë¦¬ ìˆ«ìë¥¼ HH:MM:SS í˜•ì‹ìœ¼ë¡œ ë³€í™˜
                const hours = value.substring(0, 2);
                const minutes = value.substring(2, 4);
                const seconds = value.substring(4, 6);
                input.value = `${hours}:${minutes}:${seconds}`;
            } else if (value.length >= 4) {
                // 4ìë¦¬ ì´ìƒì¼ ë•Œ HH:MM: í˜•ì‹ìœ¼ë¡œ ë³€í™˜
                const hours = value.substring(0, 2);
                const minutes = value.substring(2, 4);
                const seconds = value.substring(4);
                input.value = `${hours}:${minutes}${seconds ? ':' + seconds : ''}`;
            } else if (value.length >= 2) {
                // 2ìë¦¬ ì´ìƒì¼ ë•Œ HH: í˜•ì‹ìœ¼ë¡œ ë³€í™˜
                const hours = value.substring(0, 2);
                const minutes = value.substring(2);
                input.value = `${hours}${minutes ? ':' + minutes : ''}`;
            } else {
                input.value = value;
            }
        }
        
        // ì—”í„°í‚¤ ì²˜ë¦¬
        function handleTimeKeypress(event, input) {
            if (event.key === 'Enter') {
                event.preventDefault();
                input.blur(); // í¬ì»¤ìŠ¤ í•´ì œí•˜ì—¬ ì™„ë£Œ ì²˜ë¦¬
            }
        }
        
        // ì‹œê°„ ì…ë ¥ ì™„ë£Œ ì‹œ ê²€ì¦ ë° í¬ë§·íŒ…
        function validateAndFormatTime(input) {
            let value = input.value.trim();
            
            if (value === '') {
                input.value = '00:00:00'; // ë¹ˆ ê°’ì´ë©´ ê¸°ë³¸ê°’ ì„¤ì •
                return true;
            }
            
            // ìˆ«ìë§Œ ì…ë ¥ëœ ê²½ìš° ìë™ í¬ë§·íŒ…
            if (/^\d{6}$/.test(value)) {
                const hours = value.substring(0, 2);
                const minutes = value.substring(2, 4);
                const seconds = value.substring(4, 6);
                value = `${hours}:${minutes}:${seconds}`;
                input.value = value;
            }
            
            // ì‹œê°„ í˜•ì‹ ê²€ì¦
            const timeRegex = /^([0-1]?[0-9]|2[0-3]):([0-5]?[0-9]):([0-5]?[0-9])$/;
            
            if (!timeRegex.test(value)) {
                alert('ì˜¬ë°”ë¥¸ ì‹œê°„ í˜•ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.\nì˜ˆì‹œ: 123045 â†’ 12:30:45');
                input.focus();
                return false;
            }
            
            // ì‹œê°„ í˜•ì‹ ì •ê·œí™” (ì˜ˆ: 1:5:30 â†’ 01:05:30)
            const timeParts = value.split(':');
            const normalizedTime = timeParts.map(part => part.padStart(2, '0')).join(':');
            input.value = normalizedTime;
            
            return true;
        }
        
        // ì¢…ë£Œ ì‹œê°„ ì…ë ¥ ì™„ë£Œ ì‹œ ë‹¤ìŒ êµ¬ê°„ ì‹œì‘ ì‹œê°„ ìë™ ì„¤ì •
        function handleEndTimeComplete(endTimeInput) {
            if (!validateAndFormatTime(endTimeInput)) {
                return;
            }
            
            const currentRow = endTimeInput.closest('.time-range-row');
            const timeRanges = document.getElementById('timeRanges');
            const allRows = timeRanges.querySelectorAll('.time-range-row');
            
            // í˜„ì¬ í–‰ì˜ ì¸ë±ìŠ¤ ì°¾ê¸°
            let currentIndex = -1;
            allRows.forEach((row, index) => {
                if (row === currentRow) {
                    currentIndex = index;
                }
            });
            
            // ë‹¤ìŒ êµ¬ê°„ì´ ìˆë‹¤ë©´ ì‹œì‘ ì‹œê°„ ì—…ë°ì´íŠ¸
            if (currentIndex >= 0 && currentIndex < allRows.length - 1) {
                const nextRow = allRows[currentIndex + 1];
                const nextStartTimeInput = nextRow.querySelectorAll('input')[0];
                nextStartTimeInput.value = endTimeInput.value;
            }
        }
        
        // ëª¨ë“  ì‹œê°„ êµ¬ê°„ ì—°ê²° ì—…ë°ì´íŠ¸
        function updateTimeRangeConnections() {
            const timeRanges = document.getElementById('timeRanges');
            const allRows = timeRanges.querySelectorAll('.time-range-row');
            
            allRows.forEach((row, index) => {
                if (index > 0) {
                    const prevRow = allRows[index - 1];
                    const prevEndTimeInput = prevRow.querySelectorAll('input')[1];
                    const currentStartTimeInput = row.querySelectorAll('input')[0];
                    
                    // ì´ì „ êµ¬ê°„ì˜ ì¢…ë£Œ ì‹œê°„ì„ í˜„ì¬ êµ¬ê°„ì˜ ì‹œì‘ ì‹œê°„ìœ¼ë¡œ ì„¤ì •
                    currentStartTimeInput.value = prevEndTimeInput.value;
                }
            });
        }
        
        // íŒŒì¼ ë¶„í•  í™•ì¸
        function confirmFileSplit() {
            const fileName = document.getElementById('splitFileName').value;
            const timeRangeRows = document.querySelectorAll('.time-range-row');
            
            if (timeRangeRows.length === 0) {
                alert('ë¶„í• í•  êµ¬ê°„ì„ ì„¤ì •í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì‹œê°„ êµ¬ê°„ ìˆ˜ì§‘
            const timeRanges = [];
            let hasInvalidTime = false;
            
            timeRangeRows.forEach((row, index) => {
                const inputs = row.querySelectorAll('input[type="text"]');
                let startTime = inputs[0].value.trim();
                let endTime = inputs[1].value.trim();
                
                // ë¹ˆ ê°’ ì²˜ë¦¬
                if (startTime === '') {
                    startTime = '00:00:00';
                    inputs[0].value = startTime;
                }
                if (endTime === '') {
                    endTime = '00:00:00';
                    inputs[1].value = endTime;
                }
                
                // ì‹œê°„ í˜•ì‹ ê²€ì¦
                if (!validateAndFormatTime(inputs[0]) || !validateAndFormatTime(inputs[1])) {
                    hasInvalidTime = true;
                    return;
                }
                
                // ìµœì¢… ê°’ ë‹¤ì‹œ ê°€ì ¸ì˜¤ê¸° (ì •ê·œí™”ëœ ê°’)
                startTime = inputs[0].value;
                endTime = inputs[1].value;
                
                const rangeName = `${fileName.replace(/\.[^/.]+$/, "")}_êµ¬ê°„${index + 1}.${fileName.split('.').pop()}`;
                
                timeRanges.push({
                    start: startTime,
                    end: endTime,
                    name: rangeName
                });
            });
            
            if (hasInvalidTime) {
                alert('ëª¨ë“  ì‹œê°„ì„ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (timeRanges.length === 0) {
                alert('ìœ íš¨í•œ ì‹œê°„ êµ¬ê°„ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ë¶„í•  ì»¨í…ìŠ¤íŠ¸ í™•ì¸
            const splitContext = window.currentSplitContext;
            
            if (splitContext && splitContext.area === 'main') {
                // ë©”ì¸ íŒŒì¼ ë¦¬ìŠ¤íŠ¸ì—ì„œì˜ ë¶„í•  ì²˜ë¦¬
                updateMainFileListWithSplits(fileName, timeRanges);
            } else if (splitContext && splitContext.area === 'intermediate') {
                // ì¤‘ê°„ì–´ ì˜ì—­ì—ì„œì˜ ë¶„í•  ì²˜ë¦¬
                updateIntermediateAreaWithSplits(fileName, timeRanges, splitContext.projectTitle);
            } else if (splitContext && splitContext.area === 'destination') {
                // ë„ì°©ì–´ ì˜ì—­ì—ì„œì˜ ë¶„í•  ì²˜ë¦¬
                updateDestinationAreaWithSplits(fileName, timeRanges, splitContext.projectTitle);
            } else {
                // ê¸°ì¡´ íŒŒì¼ ì„¸íŒ… ëª¨ë‹¬ì—ì„œì˜ ë¶„í•  ì²˜ë¦¬
                updateTargetListWithSplits(fileName, timeRanges);
            }
            
            alert(`íŒŒì¼ì´ ${timeRanges.length}ê°œ êµ¬ê°„ìœ¼ë¡œ ë¶„í• ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            closeFileSplitModal();
        }
        
        // ë©”ì¸ íŒŒì¼ ë¦¬ìŠ¤íŠ¸ ë¶„í•  ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateMainFileListWithSplits(fileName, timeRanges) {
            console.log('ë©”ì¸ íŒŒì¼ ë¦¬ìŠ¤íŠ¸ ë¶„í•  ì—…ë°ì´íŠ¸:', fileName, timeRanges);
            
            // ë©”ì¸ íŒŒì¼ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì›ë³¸ íŒŒì¼ ì°¾ê¸°
            const mainTbody = document.querySelector('.file-table tbody');
            if (!mainTbody) return;
            
            const rows = mainTbody.querySelectorAll('tr');
            let originalRow = null;
            
            rows.forEach(row => {
                const fileNameCell = row.querySelector('.file-name');
                if (fileNameCell && fileNameCell.textContent.trim() === fileName) {
                    originalRow = row;
                }
            });
            
            if (originalRow) {
                // ì›ë³¸ íŒŒì¼ì— ë¶„í•  í‘œì‹œ ì¶”ê°€
                const originalFileNameCell = originalRow.querySelector('.file-name');
                if (!originalFileNameCell.textContent.includes('[ë¶„í• ë¨]')) {
                    originalFileNameCell.textContent += '[ë¶„í• ë¨]';
                }
                
                // ì›ë³¸ íŒŒì¼ì— tree-parent í´ë˜ìŠ¤ ì¶”ê°€
                originalRow.classList.add('tree-parent');
                
                // ì›ë³¸ íŒŒì¼ì˜ ì²´í¬ë°•ìŠ¤ëŠ” í™œì„±í™” ìƒíƒœ ìœ ì§€
                const originalCheckbox = originalRow.querySelector('.file-select-checkbox');
                if (originalCheckbox) {
                    originalCheckbox.checked = false; // ì²´í¬ë§Œ í•´ì œ
                }
                
                // ë¶„í• ëœ íŒŒì¼ë“¤ì„ íŠ¸ë¦¬ êµ¬ì¡°ë¡œ ì¶”ê°€
                timeRanges.forEach((range, index) => {
                    const splitRow = document.createElement('tr');
                    splitRow.className = 'tree-child';
                    splitRow.style.cursor = 'pointer';
                    splitRow.style.backgroundColor = '#f8f9fa';
                    splitRow.onclick = () => selectFileRow(splitRow);
                    // ë¶„í• ëœ íŒŒì¼ë„ ì›ë³¸ íŒŒì¼ê³¼ ê°™ì€ data-file-id ì‚¬ìš© (ê·¸ë£¹ìœ¼ë¡œ ì¸ì‹)
                    splitRow.setAttribute('data-file-id', originalRow.getAttribute('data-file-id'));
                    splitRow.innerHTML = `
                        <td style="text-align: center;"><input type="checkbox" class="file-select-checkbox split-file-checkbox" value="${fileName}-split-${index + 1}" disabled style="opacity: 0.6;"></td>
                        <td class="file-name">${range.name}</td>
                        <td style="text-align: center;">${originalRow.querySelector('td:nth-child(3)').textContent}</td>
                        <td style="text-align: center;">${originalRow.querySelector('td:nth-child(4)').textContent}</td>
                        <td style="text-align: center;">${range.start} ~ ${range.end}</td>
                        <td style="text-align: center;">
                            <span class="prompt-badge" style="background: #e5e7eb; color: #374151; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 500;">ê¸°ë³¸</span>
                        </td>
                        <td style="text-align: center;"><span class="worksby-status-badge" style="background: #fef2f2; color: #991b1b; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 500;">ë¯¸ë“±ë¡</span></td>
                    `;
                    
                    // ì›ë³¸ íŒŒì¼ ë‹¤ìŒì— ì‚½ì…
                    mainTbody.insertBefore(splitRow, originalRow.nextSibling);
                });
                
                console.log(`ë©”ì¸ íŒŒì¼ ë¦¬ìŠ¤íŠ¸ì— ${timeRanges.length}ê°œì˜ ë¶„í•  íŒŒì¼ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }
        }
        
        // ì¤‘ê°„ì–´ ì˜ì—­ ë¶„í•  ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateIntermediateAreaWithSplits(fileName, timeRanges, projectTitle) {
            console.log('ì¤‘ê°„ì–´ ì˜ì—­ ë¶„í•  ì—…ë°ì´íŠ¸:', fileName, timeRanges);
            
            // ë¶„í•  ì»¨í…ìŠ¤íŠ¸ì—ì„œ í”„ë¡œì íŠ¸ ID ê°€ì ¸ì˜¤ê¸°
            const splitContext = window.currentSplitContext;
            const projectId = splitContext?.projectId;
            
            if (!projectId) {
                console.log('í”„ë¡œì íŠ¸ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            console.log(`ì¤‘ê°„ì–´ ì˜ì—­ ë¶„í•  - í”„ë¡œì íŠ¸ ID: ${projectId}`);
            
            const intermediateTbody = document.getElementById(`intermediate-tbody-${projectId}`);
            if (!intermediateTbody) {
                console.log(`ì¤‘ê°„ì–´ ì˜ì—­ í…Œì´ë¸”ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: intermediate-tbody-${projectId}`);
                return;
            }
            
            // ê¸°ì¡´ ì›ë³¸ íŒŒì¼ í–‰ ì°¾ê¸°
            const rows = intermediateTbody.querySelectorAll('tr');
            let originalRow = null;
            
            rows.forEach(row => {
                const fileNameCell = row.querySelector('.file-name');
                if (fileNameCell && fileNameCell.textContent.trim() === fileName) {
                    originalRow = row;
                }
            });
            
            if (originalRow) {
                // ì›ë³¸ íŒŒì¼ì— ë¶„í•  í‘œì‹œ ì¶”ê°€
                const originalFileNameCell = originalRow.querySelector('.file-name');
                if (!originalFileNameCell.textContent.includes('[ë¶„í• ë¨]')) {
                    originalFileNameCell.textContent += '[ë¶„í• ë¨]';
                }
                
                // ì›ë³¸ íŒŒì¼ì— tree-parent í´ë˜ìŠ¤ ì¶”ê°€
                originalRow.classList.add('tree-parent');
                
                // ì›ë³¸ íŒŒì¼ì˜ ë²„íŠ¼ë“¤ ìˆ¨ê¸°ê¸° (ì›ìŠ¤íŒŒì´ ë“±ë¡, ì‘ì—…ì(ìƒíƒœ), ìƒˆ ì‘ì—…ì ë°°ì •, ì‚°ì¶œë¬¼)
                originalRow.innerHTML = `
                    <td style="text-align: center;" id="intermediate-project-parent"></td>
                    <td class="file-name">${fileName}[ë¶„í• ë¨]</td>
                    <td style="text-align: center;">í•œê¸€</td>
                    <td style="text-align: center;">ì˜ì–´</td>
                    <td style="text-align: center;">00:45:30</td>
                    <td style="text-align: center; color: #9ca3af;">-</td>
                    <td style="text-align: center; color: #9ca3af;">-</td>
                    <td style="text-align: center; color: #9ca3af;">-</td>
                    <td style="text-align: center;">
                        <button class="btn" onclick="mergeIntermediateFiles('${fileName}', '${projectTitle}')" 
                                style="background: #f97316; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">
                            ê²€ìˆ˜íˆ´ ì‹¤í–‰(íŒŒì¼ í•©ì¹˜ê¸°)
                        </button>
                    </td>
                    <td style="text-align: center; color: #9ca3af;">-</td>
                    <td style="text-align: center; color: #9ca3af;">-</td>
                `;
                
                // ë¶„í• ëœ íŒŒì¼ë“¤ì„ íŠ¸ë¦¬ êµ¬ì¡°ë¡œ ì¶”ê°€
                timeRanges.forEach((range, index) => {
                    const splitRow = document.createElement('tr');
                    splitRow.className = 'tree-child';
                    splitRow.innerHTML = `
                        <td style="text-align: center;" id="intermediate-project-split-${index}"></td>
                        <td class="file-name">${range.name}</td>
                        <td style="text-align: center;">í•œê¸€</td>
                        <td style="text-align: center;">ì˜ì–´</td>
                        <td style="text-align: center;">${range.start} ~ ${range.end}</td>
                        <td style="text-align: center;" id="intermediate-register-split-${index}">
                            <span style="color: #9ca3af;">-</span>
                        </td>
                        <td style="text-align: center; font-size: 12px; color: #6b7280;">
                            - (ëŒ€ê¸°)
                        </td>
                        <td style="text-align: center;">
                            <button class="btn" onclick="assignNewWorker('${range.name}', '${projectTitle}')" 
                                    style="background: #8b5cf6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">
                                ì‘ì—…ì ë°°ì •
                            </button>
                        </td>
                        <td style="text-align: center;">
                            <div style="display: flex; gap: 4px; justify-content: center; flex-wrap: nowrap;">
                                <button class="btn" onclick="executeTranscription('${range.name}')" 
                                        style="background: #3b82f6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer;">
                                    ì „ì‚¬íˆ´ ì‹¤í–‰
                                </button>
                                <button class="btn" onclick="executeReview('${range.name}')" 
                                        style="background: #10b981; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer;">
                                    ê²€ìˆ˜íˆ´ ì‹¤í–‰
                                </button>
                            </div>
                        </td>
                        <td style="text-align: center;">
                            <button class="btn" onclick="downloadOutput('${range.name}')" 
                                    style="background: #f59e0b; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">
                                ì‚°ì¶œë¬¼ ë‹¤ìš´ë¡œë“œ
                            </button>
                        </td>
                        <td style="text-align: center;">
                            <span class="status-badge" style="background: #e5e7eb; color: #374151; padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;">
                                ëŒ€ê¸°
                            </span>
                        </td>
                    `;
                    
                    // ì›ë³¸ íŒŒì¼ ë‹¤ìŒì— ì‚½ì…
                    intermediateTbody.insertBefore(splitRow, originalRow.nextSibling);
                });
            }
        }
        
        // ê¸°ì¡´ íŒŒì¼ ì„¸íŒ… ëª¨ë‹¬ì—ì„œì˜ ë¶„í•  ì²˜ë¦¬ (ê¸°ì¡´ ë¡œì§)
        function updateTargetListWithSplits(fileName, timeRanges) {
            // í•˜ë‹¨ í…œí”Œë¦¿ì—ì„œ ì›ë³¸ íŒŒì¼ ì°¾ê¸°
            const targetTbody = document.getElementById('target-file-list');
            const targetRows = Array.from(targetTbody.querySelectorAll('tr:not(#empty-state)'));
            
            let originalRowIndex = -1;
            targetRows.forEach((row, index) => {
                if (row.querySelector('.file-name').textContent === fileName) {
                    originalRowIndex = index;
                }
            });
            
            if (originalRowIndex !== -1) {
                const originalRow = targetRows[originalRowIndex];
                const originalData = {
                    projectTitle: originalRow.querySelector('td:nth-child(2)').textContent,
                    fileName: originalRow.querySelector('td:nth-child(3)').textContent,
                    sourceLanguage: originalRow.querySelector('td:nth-child(4)').textContent,
                    targetLanguage: originalRow.querySelector('td:nth-child(5)').textContent,
                    totalDuration: originalRow.querySelector('td:nth-child(6)').textContent
                };
                
                // ì›ë³¸ íŒŒì¼ì— ë¶„í•  í‘œì‹œ ì¶”ê°€
                const originalFileNameCell = originalRow.querySelector('.file-name');
                if (!originalFileNameCell.querySelector('.split-file-indicator')) {
                    originalFileNameCell.innerHTML += '<span class="split-file-indicator">[ë¶„í• ë¨]</span>';
                }
                
                // ì›ë³¸ íŒŒì¼ì— tree-parent í´ë˜ìŠ¤ ì¶”ê°€
                originalRow.classList.add('tree-parent');
                
                // ë¶„í• ëœ íŒŒì¼ë“¤ì„ íŠ¸ë¦¬ êµ¬ì¡°ë¡œ ì¶”ê°€
                timeRanges.forEach((range, index) => {
                    const splitRow = document.createElement('tr');
                    splitRow.className = 'tree-child';
                    splitRow.innerHTML = `
                        <td style="text-align: center;"><input type="checkbox" class="target-file-checkbox"></td>
                        <td style="font-weight: 500; color: #3b82f6;">${originalData.projectTitle || 'ë¯¸ì§€ì •'}</td>
                        <td class="file-name">${range.name}</td>
                        <td>${originalData.sourceLanguage}</td>
                        <td>${originalData.targetLanguage}</td>
                        <td>${range.start} ~ ${range.end}</td>
                    `;
                    
                    // ì›ë³¸ íŒŒì¼ ë‹¤ìŒì— ì‚½ì…
                    const insertAfter = originalRowIndex + index + 1;
                    if (insertAfter < targetTbody.children.length) {
                        targetTbody.insertBefore(splitRow, targetTbody.children[insertAfter]);
                    } else {
                        targetTbody.appendChild(splitRow);
                    }
                });
            }
        }
        
        // ì¤‘ê°„ì–´ ì˜ì—­ ì§„í–‰ìƒíƒœ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateIntermediateAreaProgressStatus(fileName, status) {
            // í˜„ì¬ í‘œì‹œëœ í”„ë¡œì íŠ¸ ID ì°¾ê¸°
            const visibleProjectArea = document.querySelector('[id^="worksby-detail-area-"][style*="block"]');
            if (!visibleProjectArea) {
                console.log('í‘œì‹œëœ í”„ë¡œì íŠ¸ ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const currentProjectId = visibleProjectArea.id.replace('worksby-detail-area-', '');
            console.log(`ì¤‘ê°„ì–´ ì§„í–‰ìƒíƒœ ì—…ë°ì´íŠ¸ - í˜„ì¬ í”„ë¡œì íŠ¸ ID: ${currentProjectId}`);
            
            const intermediateTbody = document.getElementById(`intermediate-tbody-${currentProjectId}`);
            if (!intermediateTbody) {
                console.log(`ì¤‘ê°„ì–´ ì˜ì—­ í…Œì´ë¸”ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: intermediate-tbody-${currentProjectId}`);
                return;
            }
            
            const rows = intermediateTbody.querySelectorAll('tr');
            rows.forEach(row => {
                // í”„ë¡œì íŠ¸ëª… ì»¬ëŸ¼ì´ ì¶”ê°€ë˜ì–´ íŒŒì¼ëª…ì€ ë‘ ë²ˆì§¸ ì…€
                const fileNameCell = row.querySelector('td:nth-child(2)') || row.querySelector('.file-name');
                if (fileNameCell) {
                    const currentFileName = fileNameCell.textContent.replace('â†’ ', '').replace('[ë¶„í• ë¨]', '').trim();
                    if (currentFileName === fileName) {
                        // ì§„í–‰ìƒíƒœ ì»¬ëŸ¼ ì°¾ê¸° (ë§ˆì§€ë§‰ ì»¬ëŸ¼)
                        const progressCell = row.querySelector('td:last-child');
                        if (progressCell) {
                            // ë°°ì§€ ìŠ¤íƒ€ì¼ë¡œ ì—…ë°ì´íŠ¸
                            const badgeColor = status === 'ê²€ìˆ˜ì™„ë£Œ' ? '#10b981' : '#6b7280';
                            progressCell.innerHTML = `<span style="background: ${badgeColor}; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;">${status}</span>`;
                        }
                    }
                }
            });
        }
        
        // ì¤‘ê°„ì–´ ì˜ì—­ íŒŒì¼ í•©ì¹˜ê¸° í•¨ìˆ˜
        function mergeIntermediateFiles(fileName, projectTitle) {
            console.log('ì¤‘ê°„ì–´ ì˜ì—­ íŒŒì¼ í•©ì¹˜ê¸° ì‹¤í–‰:', fileName, projectTitle);
            
            // í˜„ì¬ í‘œì‹œëœ í”„ë¡œì íŠ¸ ID ì°¾ê¸°
            const visibleProjectArea = document.querySelector('[id^="worksby-detail-area-"][style*="block"]');
            if (!visibleProjectArea) {
                console.log('í‘œì‹œëœ í”„ë¡œì íŠ¸ ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                alert('í˜„ì¬ í”„ë¡œì íŠ¸ ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const currentProjectId = visibleProjectArea.id.replace('worksby-detail-area-', '');
            console.log(`ì¤‘ê°„ì–´ íŒŒì¼ í•©ì¹˜ê¸° - í˜„ì¬ í”„ë¡œì íŠ¸ ID: ${currentProjectId}`);
            
            // ë¨¼ì € ì¤‘ê°„ì–´ ì˜ì—­ì˜ ëª¨ë“  ì›ìŠ¤íŒŒì´ ë“±ë¡ ìƒíƒœ í™•ì¸
            if (!checkIntermediateRegistrationComplete()) {
                alert('âš ï¸ ì¤‘ê°„ì–´ ì˜ì—­ì˜ ëª¨ë“  íŒŒì¼ì˜ ì›ìŠ¤íŒŒì´ ë“±ë¡ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”.\n\në“±ë¡ì´ ì™„ë£Œë˜ì§€ ì•Šì€ íŒŒì¼ì´ ìˆìŠµë‹ˆë‹¤.');
                return;
            }
            
            if (confirm(`${fileName} íŒŒì¼ì˜ ì¤‘ê°„ì–´ ì˜ì—­ ë¶„í• ëœ êµ¬ê°„ë“¤ì„ í•©ì¹˜ëŠ” ê²€ìˆ˜íˆ´ì„ ì‹¤í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                // ì¤‘ê°„ì–´ ì˜ì—­ì˜ ì§„í–‰ìƒíƒœë¥¼ "ê²€ìˆ˜ì™„ë£Œ"ë¡œ ë³€ê²½
                updateIntermediateAreaProgressStatus(fileName, 'ê²€ìˆ˜ì™„ë£Œ');
                
                // ëª¨ë“  ë„ì°© ì–¸ì–´ë³„ë¡œ ë„ì°©ì–´ ì˜ì—­ ìƒì„±
                createDestinationLanguageAreaFromIntermediate(fileName, projectTitle, currentProjectId);
                alert(`${fileName} íŒŒì¼ì˜ ê²€ìˆ˜íˆ´ì´ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤.\nì¤‘ê°„ì–´ ì˜ì—­ ì§„í–‰ìƒíƒœê°€ "ê²€ìˆ˜ì™„ë£Œ"ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.\nëª¨ë“  ë„ì°© ì–¸ì–´ë³„ ë„ì°©ì–´ ì˜ì—­ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }
        }
        
        // ì¤‘ê°„ì–´ ì˜ì—­ì—ì„œ ë„ì°©ì–´ ì˜ì—­ ìƒì„± í•¨ìˆ˜
        function createDestinationLanguageAreaFromIntermediate(fileName, projectTitle, projectId) {
            console.log('ì¤‘ê°„ì–´ ì˜ì—­ì—ì„œ ë„ì°©ì–´ ì˜ì—­ ìƒì„±:', fileName, projectTitle);
            
            // ì¤‘ê°„ì–´ ì˜ì—­ì—ì„œ íŒŒì¼ ëª©ë¡ ìˆ˜ì§‘
            const intermediateTbody = document.getElementById(`intermediate-tbody-${projectId}`);
            const allFiles = [];
            
            console.log(`ë„ì°©ì–´ ì˜ì—­ ìƒì„± - í”„ë¡œì íŠ¸ ID: ${projectId}`);
            
            if (intermediateTbody) {
                const rows = intermediateTbody.querySelectorAll('tr');
                rows.forEach(row => {
                    // ì›ë³¸ íŒŒì¼(tree-parent)ê³¼ ì¼ë°˜ íŒŒì¼ë§Œ ìˆ˜ì§‘ (ë¶„í• ëœ ìì‹ íŒŒì¼ ì œì™¸)
                    if (!row.classList.contains('tree-child')) {
                        const fileNameCell = row.querySelector('.file-name') || row.querySelector('td:nth-child(2)');
                        if (fileNameCell) {
                            const currentFileName = fileNameCell.textContent.replace('[ë¶„í• ë¨]', '').trim();
                            allFiles.push(currentFileName);
                        }
                    }
                });
            }
            
            console.log('ì¤‘ê°„ì–´ ì˜ì—­ì—ì„œ ìˆ˜ì§‘ëœ íŒŒì¼ë“¤:', allFiles);
            
            // ì¤‘ê°„ì–´ ì˜ì—­ í•˜ë‹¨ì— ë„ì°©ì–´ ì˜ì—­ ì¶”ê°€
            const intermediateArea = document.getElementById(`intermediate-language-area-${projectId}`);
            if (!intermediateArea) {
                console.log(`ì¤‘ê°„ì–´ ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: intermediate-language-area-${projectId}`);
                return;
            }
            
            // ê¸°ì¡´ ë„ì°©ì–´ ì˜ì—­ë“¤ ì œê±° (ì¬ìƒì„±) - í˜„ì¬ í”„ë¡œì íŠ¸ ë‚´ì—ì„œë§Œ
            const existingDestinationAreas = intermediateArea.querySelectorAll('.destination-language-area');
            existingDestinationAreas.forEach(area => area.remove());
            
            // ê¸°ì¡´ ë„ì°©ì–´ ì „ì²´ ì»¨í…Œì´ë„ˆë„ ì œê±°
            const existingDestinationContainer = document.getElementById(`destination-container-${projectId}`);
            if (existingDestinationContainer) {
                existingDestinationContainer.remove();
            }
            
            // ë„ì°©ì–´ ì „ì²´ë¥¼ ê°ì‹¸ëŠ” í° ì»¨í…Œì´ë„ˆ ìƒì„±
            const destinationContainer = document.createElement('div');
            destinationContainer.id = `destination-container-${projectId}`;
            destinationContainer.className = 'work-area-container';
            destinationContainer.style.cssText = 'margin-top: 20px;';
            
            // ë„ì°©ì–´ ì „ì²´ í—¤ë”
            destinationContainer.innerHTML = `
                <div class="work-area-header">
                    <h2 class="work-area-title">ğŸ¯ ë„ì°©ì–´ ì˜ì—­</h2>
                </div>
                <div class="work-area-content" id="destination-languages-wrapper-${projectId}">
                    <!-- ê° ì–¸ì–´ë³„ ì˜ì—­ë“¤ì´ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
            `;
            
            intermediateArea.appendChild(destinationContainer);
            
            // ë„ì°©ì–´ ëª©ë¡ (íŒŒì¼ ë¦¬ìŠ¤íŠ¸ì˜ ë„ì°© ì–¸ì–´ ê¸°ì¤€)
            const destinationLanguages = ["ì˜ì–´", "ì¼ë³¸ì–´", "ì¤‘êµ­ì–´(ê°„ì²´)"];
            const languagesWrapper = document.getElementById(`destination-languages-wrapper-${projectId}`);
            
            // ê° ì–¸ì–´ë³„ë¡œ ë³„ë„ì˜ ì˜ì—­ ìƒì„±
            destinationLanguages.forEach((lang, langIndex) => {
                const destinationArea = document.createElement('div');
                destinationArea.id = `destination-language-area-${langIndex}`;
                destinationArea.className = 'destination-language-area';
                destinationArea.style.cssText = 'margin-top: 20px;';
                
                // ê° ì–¸ì–´ë³„ ì˜ì—­ ë‚´ìš©ì„ DOMìœ¼ë¡œ ìƒì„±
                const areaContent = document.createElement('div');
                areaContent.style.cssText = 'background: white; border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden; margin-bottom: 15px;';
                
                // í—¤ë” ìƒì„± (ë²„íŠ¼ ì—†ì´)
                const header = document.createElement('div');
                header.style.cssText = 'background: #dcfce7; padding: 15px 20px; border-bottom: 1px solid #e5e7eb;';
                
                const title = document.createElement('h3');
                title.style.cssText = 'margin: 0; font-size: 16px; font-weight: 600; color: #10b981;';
                title.textContent = `ğŸ¯ ${lang} ë²ˆì—­`;
                
                header.appendChild(title);
                
                // í…Œì´ë¸” ìƒì„±
                const table = document.createElement('table');
                table.className = 'file-table';
                table.style.cssText = 'table-layout: fixed; width: 100%; margin-bottom: 0;';
                table.innerHTML = `
                    <thead>
                        <tr>
                            <th style="width: 13%;">í”„ë¡œì íŠ¸ëª…</th>
                            <th style="width: 19%;">íŒŒì¼ ì´ë¦„</th>
                            <th style="width: 5%;">ì¶œë°œì–´</th>
                            <th style="width: 10%;">ë„ì°©ì–´</th>
                            <th style="width: 7%;">ì‘ì—… ì‹œê°„</th>
                            <th style="width: 7%; text-align: center;">ì›ìŠ¤íŒŒì´ ë“±ë¡</th>
                            <th style="width: 10%; text-align: center;">ì‘ì—…ì(ìƒíƒœ)</th>
                            <th style="width: 7%; text-align: center;">ì‘ì—…ì ë°°ì •</th>
                            <th style="width: 10%; text-align: center;">ì „ì‚¬íˆ´</th>
                            <th style="width: 7%; text-align: center;">ì‚°ì¶œë¬¼</th>
                            <th style="width: 5%; text-align: center;">ì§„í–‰ìƒíƒœ</th>
                        </tr>
                    </thead>
                    <tbody id="destination-tbody-${projectId}-${langIndex}">
                        <!-- ë„ì°©ì–´ ì˜ì—­ íŒŒì¼ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </tbody>
                `;
                
                // ë²„íŠ¼ ì˜ì—­ ìƒì„± (í…Œì´ë¸” ì•„ë˜)
                const buttonArea = document.createElement('div');
                buttonArea.style.cssText = 'padding: 15px 20px; border-top: 1px solid #e5e7eb; background: #f8f9fa; display: flex; justify-content: flex-end; gap: 10px;';
                
                // ì‹œë‚˜ë¦¬ì˜¤ êµ¬ë¶„: íŒŒì¼ ê°œìˆ˜ê°€ 2ê°œ ì´ìƒì´ë©´ ì‹œë‚˜ë¦¬ì˜¤ 3 (íŒŒì¼ ë¶„í•  ë²„íŠ¼ ìˆ¨ê¹€)
                const isScenario3 = allFiles.length >= 2;
                
                // ì‹œë‚˜ë¦¬ì˜¤ 1,2ì—ì„œë§Œ íŒŒì¼ ë¶„í•  ë²„íŠ¼ í‘œì‹œ
                if (!isScenario3) {
                    const splitBtn = document.createElement('button');
                    splitBtn.className = 'btn btn-warning';
                    splitBtn.style.cssText = 'padding: 8px 16px; font-size: 14px;';
                    splitBtn.innerHTML = '<span>âœ‚ï¸</span> íŒŒì¼ ë¶„í• ';
                    splitBtn.onclick = () => splitDestinationFile(`${fileName}_${lang}`, projectTitle, lang, langIndex);
                    buttonArea.appendChild(splitBtn);
                }
                
                const worksbyBtn = document.createElement('button');
                worksbyBtn.className = 'btn';
                worksbyBtn.style.cssText = 'background: #8b5cf6; color: white; padding: 8px 16px; font-size: 14px; border: none; border-radius: 6px; cursor: pointer;';
                worksbyBtn.innerHTML = '<span>ğŸš€</span> ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„±';
                worksbyBtn.onclick = () => createDestinationWorksbyProject(`${fileName}_${lang}`, projectTitle, lang, langIndex);
                
                buttonArea.appendChild(worksbyBtn);
                
                areaContent.appendChild(header);
                areaContent.appendChild(table);
                areaContent.appendChild(buttonArea);
                destinationArea.appendChild(areaContent);
                
                languagesWrapper.appendChild(destinationArea);
                
                // ê° ì–¸ì–´ë³„ í…Œì´ë¸”ì— íŒŒì¼ í–‰ë“¤ ë™ì  ì¶”ê°€
                const destinationTbody = document.getElementById(`destination-tbody-${projectId}-${langIndex}`);
                if (destinationTbody) {
                    allFiles.forEach((file, fileIndex) => {
                        const row = document.createElement('tr');
                        
                        // ê° ì…€ì„ ê°œë³„ì ìœ¼ë¡œ ìƒì„±
                        const projectNameCell = document.createElement('td');
                        projectNameCell.style.textAlign = 'center';
                        projectNameCell.textContent = ''; // ì´ˆê¸°ì—ëŠ” ë¹„ì–´ìˆìŒ, ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„± í›„ ì±„ì›Œì§
                        projectNameCell.id = `destination-project-${langIndex}-${fileIndex}`;
                        
                        const fileNameCell = document.createElement('td');
                        fileNameCell.className = 'file-name';
                        fileNameCell.textContent = `${file}_${lang}`;
                        
                        const sourceCell = document.createElement('td');
                        sourceCell.style.textAlign = 'center';
                        sourceCell.textContent = 'í•œê¸€';
                        
                        const targetCell = document.createElement('td');
                        targetCell.style.textAlign = 'center';
                        targetCell.textContent = lang;
                        
                        const timeCell = document.createElement('td');
                        timeCell.style.textAlign = 'center';
                        timeCell.textContent = '00:45:30';
                        
                        const registerCell = document.createElement('td');
                        registerCell.style.textAlign = 'center';
                        registerCell.id = `destination-register-${langIndex}-${fileIndex}`;
                        registerCell.innerHTML = '<span style="color: #9ca3af;">-</span>';
                        
                        const workerCell = document.createElement('td');
                        workerCell.style.textAlign = 'center';
                        workerCell.style.fontSize = '12px';
                        workerCell.style.color = '#6b7280';
                        workerCell.textContent = '- (ëŒ€ê¸°)';
                        
                        const assignCell = document.createElement('td');
                        assignCell.style.textAlign = 'center';
                        
                        // ì²« ë²ˆì§¸ íŒŒì¼ì—ë§Œ ì‘ì—…ì ë°°ì • ë²„íŠ¼ í‘œì‹œ (ì‹œë‚˜ë¦¬ì˜¤ 3)
                        if (fileIndex === 0) {
                            assignCell.innerHTML = `<button class="btn" onclick="assignNewWorker('${file}_${lang}', '${projectTitle}')" style="background: #8b5cf6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">ì‘ì—…ì ë°°ì •</button>`;
                        } else {
                            assignCell.innerHTML = `<span style="color: #9ca3af;">-</span>`;
                        }
                        
                        const toolsCell = document.createElement('td');
                        toolsCell.style.textAlign = 'center';
                        toolsCell.innerHTML = `<div style="display: flex; gap: 4px; justify-content: center; flex-wrap: nowrap;"><button class="btn" onclick="executeTranscription('${file}_${lang}')" style="background: #3b82f6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer;">ì „ì‚¬íˆ´ ì‹¤í–‰</button><button class="btn" onclick="executeReview('${file}_${lang}')" style="background: #10b981; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer;">ê²€ìˆ˜íˆ´ ì‹¤í–‰</button></div>`;
                        
                        const outputCell = document.createElement('td');
                        outputCell.style.textAlign = 'center';
                        outputCell.innerHTML = `<button class="btn" onclick="downloadOutput('${file}_${lang}')" style="background: #f59e0b; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">ì‚°ì¶œë¬¼ ë‹¤ìš´ë¡œë“œ</button>`;
                        
                        const statusCell = document.createElement('td');
                        statusCell.style.textAlign = 'center';
                        statusCell.innerHTML = '<span class="status-badge" style="background: #e5e7eb; color: #374151; padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;">ëŒ€ê¸°</span>';
                        
                        // ëª¨ë“  ì…€ì„ í–‰ì— ì¶”ê°€
                        row.appendChild(projectNameCell);
                        row.appendChild(fileNameCell);
                        row.appendChild(sourceCell);
                        row.appendChild(targetCell);
                        row.appendChild(timeCell);
                        row.appendChild(registerCell);
                        row.appendChild(workerCell);
                        row.appendChild(assignCell);
                        row.appendChild(toolsCell);
                        row.appendChild(outputCell);
                        row.appendChild(statusCell);
                        
                        destinationTbody.appendChild(row);
                    });
                }
            });
            
            console.log('ë„ì°©ì–´ ì˜ì—­ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.');
            
            // í•˜ë‹¨ ì˜ì—­ì„ ìµœí•˜ë‹¨ìœ¼ë¡œ ì´ë™
            ensureBottomSectionsAtEnd();
        }
        
        // ë„ì°©ì–´ ì˜ì—­ì—ì„œ ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„±
        function createDestinationWorksbyProject(fileName, projectTitle, language, langIndex) {
            console.log('ë„ì°©ì–´ ì˜ì—­ ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„±:', fileName, projectTitle, language, langIndex);
            
            // í˜„ì¬ í”„ë¡œì íŠ¸ ID ì°¾ê¸°
            const visibleProjectArea = document.querySelector('[id^="worksby-detail-area-"][style*="block"]');
            const currentProjectId = visibleProjectArea ? visibleProjectArea.id.replace('worksby-detail-area-', '') : null;
            
            // ì„ íƒëœ íŒŒì¼ ì •ë³´ë¥¼ ì „ì—­ ë³€ìˆ˜ì— ì €ì¥
            window.selectedFileInfo = {
                fileName: fileName,
                projectTitle: projectTitle,
                language: language,
                langIndex: langIndex,
                fromDestinationArea: true,  // ë„ì°©ì–´ ì˜ì—­ì—ì„œ í˜¸ì¶œë¨ì„ í‘œì‹œ
                currentProjectId: currentProjectId
            };
            
            console.log('ë„ì°©ì–´ ì˜ì—­ ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„± - ì €ì¥ëœ ì •ë³´:', window.selectedFileInfo);
            
            // ì›ìŠ¤íŒŒì´ ë“±ë¡ ëª¨ë‹¬ ì—´ê¸°
            openWorksbyRegistrationModal(fileName, projectTitle);
        }
        
        // ë„ì°©ì–´ ì˜ì—­ ì›ìŠ¤íŒŒì´ ë“±ë¡ ì™„ë£Œ í›„ ë²„íŠ¼ ì—…ë°ì´íŠ¸
        function updateDestinationWorksbyButtons(projectTitle, language, langIndex) {
            // í˜„ì¬ í”„ë¡œì íŠ¸ ID ê°€ì ¸ì˜¤ê¸°
            const currentProjectId = window.selectedFileInfo?.currentProjectId;
            if (!currentProjectId) {
                console.log('í˜„ì¬ í”„ë¡œì íŠ¸ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            console.log(`ë„ì°©ì–´ ì›ìŠ¤íŒŒì´ ë²„íŠ¼ ì—…ë°ì´íŠ¸ - í”„ë¡œì íŠ¸ ID: ${currentProjectId}, ì–¸ì–´ ì¸ë±ìŠ¤: ${langIndex}`);
            
            const destinationTbody = document.getElementById(`destination-tbody-${currentProjectId}-${langIndex}`);
            
            if (!destinationTbody) {
                return;
            }
            
            const rows = destinationTbody.querySelectorAll('tr');
            
            rows.forEach((row, index) => {
                // ì›ë³¸ íŒŒì¼(tree-parent)ì€ ë“±ë¡ í™•ì¸ ë²„íŠ¼ ì—…ë°ì´íŠ¸ ì œì™¸
                if (row.classList.contains('tree-parent')) {
                    return;
                }
                
                // í”„ë¡œì íŠ¸ëª… ì»¬ëŸ¼ ì—…ë°ì´íŠ¸ (ë¶„í• ëœ íŒŒì¼ê³¼ ì¼ë°˜ íŒŒì¼ êµ¬ë¶„)
                let projectNameCell;
                if (row.classList.contains('tree-child')) {
                    // ë¶„í• ëœ íŒŒì¼ì˜ ê²½ìš° split IDë¡œ ì°¾ê¸°
                    const splitIndex = Array.from(destinationTbody.querySelectorAll('tr.tree-child')).indexOf(row);
                    projectNameCell = document.getElementById(`destination-project-${langIndex}-split-${splitIndex}`);
                } else {
                    // ì¼ë°˜ íŒŒì¼ì˜ ê²½ìš° ê¸°ë³¸ IDë¡œ ì°¾ê¸°
                    projectNameCell = document.getElementById(`destination-project-${langIndex}-${index}`);
                }
                
                if (projectNameCell) {
                    projectNameCell.textContent = projectTitle;
                }
                
                // ë¶„í• ëœ íŒŒì¼ì¸ ê²½ìš°ì™€ ì¼ë°˜ íŒŒì¼ì¸ ê²½ìš° ID êµ¬ë¶„
                let registerCell;
                if (row.classList.contains('tree-child')) {
                    // ë¶„í• ëœ íŒŒì¼ì˜ ê²½ìš° split IDë¡œ ì°¾ê¸°
                    const splitIndex = Array.from(destinationTbody.querySelectorAll('tr.tree-child')).indexOf(row);
                    registerCell = document.getElementById(`destination-register-split-${langIndex}-${splitIndex}`);
                } else {
                    // ì¼ë°˜ íŒŒì¼ì˜ ê²½ìš° ê¸°ë³¸ IDë¡œ ì°¾ê¸°
                    registerCell = document.getElementById(`destination-register-${langIndex}-${index}`);
                }
                
                if (registerCell) {
                    const fileName = row.querySelector('.file-name').textContent;
                    
                    registerCell.innerHTML = `
                        <button class="btn btn-success" onclick="openProjectDetailModal('${fileName}', '${projectTitle}')" 
                                style="padding: 6px 12px; font-size: 12px; margin: 0 auto; display: inline-block;">
                            <span>âœ…</span>
                            ë“±ë¡ í™•ì¸
                        </button>
                    `;
                }
            });
        }
        
        // ì¤‘ê°„ì–´ ì˜ì—­ì˜ ëª¨ë“  ì›ìŠ¤íŒŒì´ ë“±ë¡ ì™„ë£Œ ì—¬ë¶€ í™•ì¸
        function checkIntermediateRegistrationComplete() {
            console.log('ì¤‘ê°„ì–´ ì˜ì—­ ì›ìŠ¤íŒŒì´ ë“±ë¡ ì™„ë£Œ ì—¬ë¶€ í™•ì¸ ì‹œì‘');
            
            // í˜„ì¬ í‘œì‹œëœ í”„ë¡œì íŠ¸ ID ì°¾ê¸°
            const visibleProjectArea = document.querySelector('[id^="worksby-detail-area-"][style*="block"]');
            if (!visibleProjectArea) {
                console.log('í‘œì‹œëœ í”„ë¡œì íŠ¸ ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return false;
            }
            
            const currentProjectId = visibleProjectArea.id.replace('worksby-detail-area-', '');
            console.log(`ì¤‘ê°„ì–´ ì›ìŠ¤íŒŒì´ ë“±ë¡ í™•ì¸ - í˜„ì¬ í”„ë¡œì íŠ¸ ID: ${currentProjectId}`);
            
            const intermediateTbody = document.getElementById(`intermediate-tbody-${currentProjectId}`);
            if (!intermediateTbody) {
                console.log(`ì¤‘ê°„ì–´ ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: intermediate-tbody-${currentProjectId}`);
                return false;
            }
            
            const rows = intermediateTbody.querySelectorAll('tr');
            console.log('ì¤‘ê°„ì–´ ì˜ì—­ íŒŒì¼ í–‰ ìˆ˜:', rows.length);
            
            let incompleteFiles = [];
            
            rows.forEach((row, index) => {
                const fileNameCell = row.querySelector('.file-name');
                const registerCell = row.querySelector('td:nth-child(5)'); // ì¤‘ê°„ì–´ ì˜ì—­ ì›ìŠ¤íŒŒì´ ë“±ë¡ ì»¬ëŸ¼
                const button = registerCell ? registerCell.querySelector('button') : null;
                
                if (fileNameCell && button) {
                    const fileName = fileNameCell.textContent.replace('â†’ ', '').trim();
                    const buttonText = button.textContent.trim();
                    
                    console.log(`ì¤‘ê°„ì–´ íŒŒì¼ ${index + 1}: ${fileName} - ë²„íŠ¼ ìƒíƒœ: ${buttonText}`);
                    
                    // ë²„íŠ¼ í…ìŠ¤íŠ¸ê°€ "ë“±ë¡"ì¸ ê²½ìš° (ë“±ë¡ í™•ì¸ì´ ì•„ë‹Œ ê²½ìš°)
                    if (buttonText.includes('ë“±ë¡') && !buttonText.includes('ë“±ë¡ í™•ì¸')) {
                        incompleteFiles.push(fileName);
                    }
                }
            });
            
            console.log('ì¤‘ê°„ì–´ ì˜ì—­ ë“±ë¡ ë¯¸ì™„ë£Œ íŒŒì¼ë“¤:', incompleteFiles);
            
            if (incompleteFiles.length > 0) {
                console.log(`ì¤‘ê°„ì–´ ì˜ì—­ì—ì„œ ë“±ë¡ì´ ì™„ë£Œë˜ì§€ ì•Šì€ íŒŒì¼ ${incompleteFiles.length}ê°œ ë°œê²¬`);
                return false;
            }
            
            console.log('ì¤‘ê°„ì–´ ì˜ì—­ì˜ ëª¨ë“  íŒŒì¼ì˜ ì›ìŠ¤íŒŒì´ ë“±ë¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
            return true;
        }
        
        // ë„ì°©ì–´ ì˜ì—­ ìƒì„± í•¨ìˆ˜ (ì–¸ì–´ë³„ Ã— íŒŒì¼ë³„ ë§¤íŠ¸ë¦­ìŠ¤)
        function createDestinationLanguageArea(fileName, projectTitle) {
            console.log('ë„ì°©ì–´ ì˜ì—­ ìƒì„±:', fileName, projectTitle);
            
            // ì¤‘ê°„ì–´ ì˜ì—­ì—ì„œ íŒŒì¼ ëª©ë¡ ìˆ˜ì§‘ ë° ì‹œë‚˜ë¦¬ì˜¤ êµ¬ë¶„
            const intermediateTbody = document.getElementById('intermediate-tbody');
            const allFiles = [];
            let hasTreeStructure = false;
            
            if (intermediateTbody) {
                const rows = intermediateTbody.querySelectorAll('tr');
                rows.forEach(row => {
                    if (row.classList.contains('tree-parent')) {
                        hasTreeStructure = true; // ì‹œë‚˜ë¦¬ì˜¤ 1: íŒŒì¼ ë¶„í• 
                        // ë¶„í• ëœ íŒŒì¼ì˜ ê²½ìš° ì›ë³¸ íŒŒì¼ëª… ì¶”ê°€
                        const fileNameCell = row.querySelector('.file-name') || row.querySelector('td:nth-child(2)');
                        if (fileNameCell) {
                            const originalFileName = fileNameCell.textContent.replace('[ë¶„í• ë¨]', '').trim();
                            allFiles.push(originalFileName);
                        }
                    } else if (!row.classList.contains('tree-child')) {
                        // tree-parentë„ tree-childë„ ì•„ë‹Œ ì¼ë°˜ íŒŒì¼ë“¤ (ì‹œë‚˜ë¦¬ì˜¤ 2, 3)
                        const fileNameCell = row.querySelector('.file-name') || row.querySelector('td:nth-child(2)');
                        if (fileNameCell) {
                            const currentFileName = fileNameCell.textContent.replace('â†’ ', '').replace('[ë¶„í• ë¨]', '').trim();
                            allFiles.push(currentFileName);
                        }
                    }
                });
            }
            
            console.log('ì¤‘ê°„ì–´ ì˜ì—­ì—ì„œ ìˆ˜ì§‘ëœ íŒŒì¼ë“¤:', allFiles);
            console.log('ì¤‘ê°„ì–´ ì˜ì—­ íŠ¸ë¦¬ êµ¬ì¡° ì¡´ì¬ ì—¬ë¶€:', hasTreeStructure);
            
            // ì‹œë‚˜ë¦¬ì˜¤ êµ¬ë¶„
            const isMultipleFiles = allFiles.length > 1 && !hasTreeStructure; // ì‹œë‚˜ë¦¬ì˜¤ 3: ë³µìˆ˜ íŒŒì¼ (ë¶„í•  ì•„ë‹˜)
            const isSingleFile = allFiles.length === 1 && !hasTreeStructure; // ì‹œë‚˜ë¦¬ì˜¤ 2: ë‹¨ì¼ íŒŒì¼
            const isSplitFile = hasTreeStructure; // ì‹œë‚˜ë¦¬ì˜¤ 1: ë¶„í•  íŒŒì¼
            
            console.log(`ë„ì°©ì–´ ì‹œë‚˜ë¦¬ì˜¤ êµ¬ë¶„: ë¶„í• íŒŒì¼=${isSplitFile}, ë‹¨ì¼íŒŒì¼=${isSingleFile}, ë³µìˆ˜íŒŒì¼=${isMultipleFiles}`);
            
            // ì¤‘ê°„ì–´ ì˜ì—­ í•˜ë‹¨ì— ë„ì°©ì–´ ì˜ì—­ ì¶”ê°€
            const detailArea = document.getElementById('template-detail-area');
            if (!detailArea) return;
            
            // ê¸°ì¡´ ë„ì°©ì–´ ì˜ì—­ë“¤ ì œê±° (ì¬ìƒì„±)
            const existingDestinationAreas = document.querySelectorAll('.destination-language-area');
            existingDestinationAreas.forEach(area => area.remove());
            
            // ê¸°ì¡´ ë„ì°©ì–´ ì „ì²´ ì»¨í…Œì´ë„ˆë„ ì œê±°
            const existingDestinationContainer = document.getElementById('destination-container');
            if (existingDestinationContainer) {
                existingDestinationContainer.remove();
            }
            
            // ë„ì°©ì–´ ì „ì²´ë¥¼ ê°ì‹¸ëŠ” í° ì»¨í…Œì´ë„ˆ ìƒì„±
            const destinationContainer = document.createElement('div');
            destinationContainer.id = 'destination-container';
            destinationContainer.className = 'work-area-container';
            destinationContainer.style.cssText = 'margin-top: 20px;';
            
            // ë„ì°©ì–´ ì „ì²´ í—¤ë”
            destinationContainer.innerHTML = `
                <div class="work-area-header">
                    <h2 class="work-area-title">ğŸ¯ ë„ì°©ì–´ ì˜ì—­</h2>
                </div>
                <div class="work-area-content" id="destination-languages-wrapper">
                    <!-- ê° ì–¸ì–´ë³„ ì˜ì—­ë“¤ì´ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
            `;
            
            detailArea.appendChild(destinationContainer);
            
            // ë„ì°©ì–´ ëª©ë¡
            const destinationLanguages = ["ì˜ì–´", "ì¼ë³¸ì–´", "ì¤‘êµ­ì–´(ê°„ì²´)"];
            const languagesWrapper = document.getElementById('destination-languages-wrapper');
            
            // ê° ì–¸ì–´ë³„ë¡œ ë³„ë„ì˜ ì˜ì—­ ìƒì„±
            destinationLanguages.forEach((lang, langIndex) => {
                const destinationArea = document.createElement('div');
                destinationArea.id = `destination-language-area-${langIndex}`;
                destinationArea.className = 'destination-language-area';
                destinationArea.style.cssText = 'margin-top: 20px;';
                
                // ê° ì–¸ì–´ë³„ ì˜ì—­ ë‚´ìš© ìƒì„± (í° ì»¨í…Œì´ë„ˆ ì•ˆì˜ ì„œë¸Œ ì˜ì—­)
                destinationArea.innerHTML = `
                    <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden; margin-bottom: 15px;">
                        <div style="background: #dcfce7; padding: 12px 20px; border-bottom: 1px solid #e5e7eb; display: flex; justify-content: space-between; align-items: center;">
                            <h4 style="margin: 0; font-size: 14px; font-weight: 600; color: #10b981;">ğŸ¯ ${lang} ë²ˆì—­</h4>
                            ${(isSingleFile || isSplitFile) 
                                ? `<button class="btn btn-warning" onclick="splitDestinationFile('${fileName}_${lang}', '${projectTitle}', '${lang}', ${langIndex})" 
                                          style="padding: 6px 12px; font-size: 12px;">
                                      <span>âœ‚ï¸</span>
                                      íŒŒì¼ ë¶„í• 
                                  </button>`
                                : ''
                            }
                        </div>
                        <table class="file-table" style="table-layout: fixed; width: 100%; margin-bottom: 0;">
                            <thead>
                                <tr>
                                    <th style="width: 20%;">íŒŒì¼ ì´ë¦„</th>
                                    <th style="width: 10%;">ì¶œë°œì–´</th>
                                    <th style="width: 12%;">ë„ì°©ì–´</th>
                                    <th style="width: 10%;">ì‘ì—… ì‹œê°„</th>
                                    <th style="width: 12%; text-align: center;">ì›ìŠ¤íŒŒì´ ë“±ë¡</th>
                                    <th style="width: 12%; text-align: center;">ì‘ì—…ì(ìƒíƒœ)</th>
                                    <th style="width: 12%; text-align: center;">ì‘ì—…ì ë°°ì •</th>
                                    <th style="width: 12%; text-align: center;">ì „ì‚¬íˆ´</th>
                                    <th style="width: 8%; text-align: center;">ì‚°ì¶œë¬¼</th>
                                    <th style="width: 10%; text-align: center;">ì§„í–‰ ìƒíƒœ</th>
                                </tr>
                            </thead>
                            <tbody id="destination-tbody-${langIndex}">
                                ${allFiles.map((file, fileIndex) => `
                                    <tr>
                                        <td class="file-name">${file}_${lang}</td>
                                        <td style="text-align: center;">í•œê¸€</td>
                                        <td style="text-align: center;">${lang}</td>
                                        <td style="text-align: center;">00:45:30</td>
                                        <td style="text-align: center;">
                                            ${fileIndex === 0 
                                                ? `<button class="btn btn-success" onclick="openWorksbyRegistrationModal('${file}_${lang}', '${projectTitle}')" 
                                                          style="padding: 6px 12px; font-size: 12px; margin: 0 auto; display: inline-block;">
                                                      <span>ğŸš€</span>
                                                      ë“±ë¡
                                                  </button>`
                                                : `<span style="color: #9ca3af;">-</span>`
                                            }
                                        </td>
                                        <td style="text-align: center; font-size: 12px; color: #6b7280;">
                                            - (ëŒ€ê¸°)
                                        </td>
                                        <td style="text-align: center;">
                                            <button class="btn" onclick="assignNewWorker('${file}_${lang}', '${projectTitle}')" 
                                                    style="background: #8b5cf6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">
                                                ì‘ì—…ì ë°°ì •
                                            </button>
                                        </td>
                                        <td style="text-align: center;">
                                            <div style="display: flex; gap: 4px; justify-content: center; flex-wrap: nowrap;">
                                                <button class="btn" onclick="executeTranscription('${file}_${lang}')" 
                                                        style="background: #3b82f6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer;">
                                                    ì „ì‚¬íˆ´ ì‹¤í–‰
                                                </button>
                                                <button class="btn" onclick="executeReview('${file}_${lang}')" 
                                                        style="background: #10b981; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer;">
                                                    ê²€ìˆ˜íˆ´ ì‹¤í–‰
                                                </button>
                                            </div>
                                        </td>
                                        <td style="text-align: center;">
                                            <button class="btn" onclick="downloadOutput('${file}_${lang}')" 
                                                    style="background: #f59e0b; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">
                                                ì‚°ì¶œë¬¼ ë‹¤ìš´ë¡œë“œ
                                            </button>
                                        </td>
                                        <td style="text-align: center;">
                                            <span class="status-badge" style="background: #e5e7eb; color: #374151; padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;">
                                                ëŒ€ê¸°
                                            </span>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
                
                languagesWrapper.appendChild(destinationArea);
            });
            
            console.log('ë„ì°©ì–´ ì˜ì—­ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.');
            
            // í•˜ë‹¨ ì˜ì—­ì„ ìµœí•˜ë‹¨ìœ¼ë¡œ ì´ë™
            ensureBottomSectionsAtEnd();
        }
        
        // ë„ì°©ì–´ ì˜ì—­ íŒŒì¼ ë¶„í•  í•¨ìˆ˜
        function splitDestinationFile(fileName, projectTitle, language, langIndex) {
            console.log('ë„ì°©ì–´ ì˜ì—­ íŒŒì¼ ë¶„í• :', fileName, projectTitle, language, langIndex);
            
            // íŒŒì¼ ë¶„í•  ëª¨ë‹¬ì— íŒŒì¼ëª…ê³¼ íŒŒì¼ ê¸¸ì´ ì„¤ì •
            const splitFileNameInput = document.getElementById('splitFileName');
            const splitFileLengthInput = document.getElementById('splitFileLength');
            
            if (splitFileNameInput) {
                splitFileNameInput.value = fileName.replace('[ë¶„í• ë¨]', '').trim();
            }
            
            if (splitFileLengthInput) {
                splitFileLengthInput.value = '00:45:30'; // ê¸°ë³¸ê°’ ë˜ëŠ” ì‹¤ì œ íŒŒì¼ ê¸¸ì´
            }
            
            // ë¶„í•  ëª¨ë‹¬ ì—´ê¸°
            const modal = document.getElementById('fileSplitModal');
            if (modal) {
                modal.style.display = 'flex';
                
                // í˜„ì¬ í”„ë¡œì íŠ¸ ID ì°¾ê¸°
                const visibleProjectArea = document.querySelector('[id^="worksby-detail-area-"][style*="block"]');
                const currentProjectId = visibleProjectArea ? visibleProjectArea.id.replace('worksby-detail-area-', '') : null;
                
                // ë„ì°©ì–´ ì˜ì—­ ë¶„í• ì„ì„ í‘œì‹œ (ì–¸ì–´ë³„ ì •ë³´ í¬í•¨)
                window.currentSplitContext = {
                    area: 'destination',
                    fileName: fileName,
                    projectTitle: projectTitle,
                    language: language,
                    langIndex: langIndex,
                    projectId: currentProjectId
                };
            }
        }
        
        // ë„ì°©ì–´ ì˜ì—­ ë¶„í•  ì—…ë°ì´íŠ¸ í•¨ìˆ˜ (ì–¸ì–´ë³„ ì˜ì—­ìš©)
        function updateDestinationAreaWithSplits(fileName, timeRanges, projectTitle) {
            console.log('ë„ì°©ì–´ ì˜ì—­ ë¶„í•  ì—…ë°ì´íŠ¸:', fileName, timeRanges);
            
            const splitContext = window.currentSplitContext;
            if (!splitContext || !splitContext.language || splitContext.langIndex === undefined) {
                console.log('ë¶„í•  ì»¨í…ìŠ¤íŠ¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const language = splitContext.language;
            const langIndex = splitContext.langIndex;
            const projectId = splitContext.projectId;
            
            if (!projectId) {
                console.log('í”„ë¡œì íŠ¸ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            console.log(`ë„ì°©ì–´ ì˜ì—­ ë¶„í•  - í”„ë¡œì íŠ¸ ID: ${projectId}, ì–¸ì–´ ì¸ë±ìŠ¤: ${langIndex}`);
            
            const destinationTbody = document.getElementById(`destination-tbody-${projectId}-${langIndex}`);
            
            if (!destinationTbody) {
                console.log(`ë„ì°©ì–´ ì˜ì—­ ${language} í…Œì´ë¸”ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
                return;
            }
            
            // ê¸°ì¡´ ì›ë³¸ íŒŒì¼ í–‰ ì°¾ê¸°
            const rows = destinationTbody.querySelectorAll('tr');
            let originalRow = null;
            
            rows.forEach(row => {
                const fileNameCell = row.querySelector('.file-name');
                if (fileNameCell && fileNameCell.textContent.trim() === fileName) {
                    originalRow = row;
                }
            });
            
            if (originalRow) {
                // ì›ë³¸ íŒŒì¼ì— ë¶„í•  í‘œì‹œ ì¶”ê°€
                const originalFileNameCell = originalRow.querySelector('.file-name');
                if (!originalFileNameCell.textContent.includes('[ë¶„í• ë¨]')) {
                    originalFileNameCell.textContent += '[ë¶„í• ë¨]';
                }
                
                // ì›ë³¸ íŒŒì¼ì— tree-parent í´ë˜ìŠ¤ ì¶”ê°€
                originalRow.classList.add('tree-parent');
                
                // ì›ë³¸ íŒŒì¼ DOMìœ¼ë¡œ ë‹¤ì‹œ ìƒì„± (ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„± ë²„íŠ¼ í¬í•¨)
                originalRow.innerHTML = '';
                
                const projectNameCell = document.createElement('td');
                projectNameCell.style.textAlign = 'center';
                projectNameCell.textContent = ''; // ì´ˆê¸°ì—ëŠ” ë¹„ì–´ìˆìŒ, ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„± í›„ ì±„ì›Œì§
                projectNameCell.id = `destination-project-${langIndex}-parent`;
                
                const fileNameCell = document.createElement('td');
                fileNameCell.className = 'file-name';
                fileNameCell.textContent = fileName + '[ë¶„í• ë¨]';
                
                const sourceCell = document.createElement('td');
                sourceCell.style.textAlign = 'center';
                sourceCell.textContent = 'í•œê¸€';
                
                const targetCell = document.createElement('td');
                targetCell.style.textAlign = 'center';
                targetCell.textContent = language;
                
                const timeCell = document.createElement('td');
                timeCell.style.textAlign = 'center';
                timeCell.textContent = '00:45:30';
                
                const registerCell = document.createElement('td');
                registerCell.style.textAlign = 'center';
                registerCell.style.color = '#9ca3af';
                registerCell.textContent = '-';
                
                const workerCell = document.createElement('td');
                workerCell.style.textAlign = 'center';
                workerCell.style.color = '#9ca3af';
                workerCell.textContent = '-';
                
                const assignCell = document.createElement('td');
                assignCell.style.textAlign = 'center';
                assignCell.style.color = '#9ca3af';
                assignCell.textContent = '-';
                
                const toolsCell = document.createElement('td');
                toolsCell.style.textAlign = 'center';
                
                // ê²€ìˆ˜íˆ´ ì‹¤í–‰(íŒŒì¼ í•©ì¹˜ê¸°) ë²„íŠ¼ë§Œ ì¶”ê°€
                const mergeBtn = document.createElement('button');
                mergeBtn.className = 'btn';
                mergeBtn.style.cssText = 'background: #f97316; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;';
                mergeBtn.innerHTML = 'ê²€ìˆ˜íˆ´ ì‹¤í–‰(íŒŒì¼ í•©ì¹˜ê¸°)';
                mergeBtn.onclick = () => mergeDestinationFiles(fileName, projectTitle, language, langIndex);
                
                toolsCell.appendChild(mergeBtn);
                
                const outputCell = document.createElement('td');
                outputCell.style.textAlign = 'center';
                outputCell.style.color = '#9ca3af';
                outputCell.textContent = '-';
                
                const statusCell = document.createElement('td');
                statusCell.style.textAlign = 'center';
                statusCell.style.color = '#9ca3af';
                statusCell.textContent = '-';
                
                // ëª¨ë“  ì…€ì„ ì›ë³¸ í–‰ì— ì¶”ê°€
                originalRow.appendChild(projectNameCell);
                originalRow.appendChild(fileNameCell);
                originalRow.appendChild(sourceCell);
                originalRow.appendChild(targetCell);
                originalRow.appendChild(timeCell);
                originalRow.appendChild(registerCell);
                originalRow.appendChild(workerCell);
                originalRow.appendChild(assignCell);
                originalRow.appendChild(toolsCell);
                originalRow.appendChild(outputCell);
                originalRow.appendChild(statusCell);
                
                // ë¶„í• ëœ íŒŒì¼ë“¤ì„ íŠ¸ë¦¬ êµ¬ì¡°ë¡œ ì¶”ê°€
                timeRanges.forEach((range, index) => {
                    const splitRow = document.createElement('tr');
                    splitRow.className = 'tree-child';
                    
                    // ê° ì…€ì„ ê°œë³„ì ìœ¼ë¡œ ìƒì„±
                    const projectNameCell = document.createElement('td');
                    projectNameCell.style.textAlign = 'center';
                    projectNameCell.textContent = ''; // ì´ˆê¸°ì—ëŠ” ë¹„ì–´ìˆìŒ, ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„± í›„ ì±„ì›Œì§
                    projectNameCell.id = `destination-project-${langIndex}-split-${index}`;
                    
                    const fileNameCell = document.createElement('td');
                    fileNameCell.className = 'file-name';
                    fileNameCell.textContent = range.name;
                    
                    const sourceCell = document.createElement('td');
                    sourceCell.style.textAlign = 'center';
                    sourceCell.textContent = 'í•œê¸€';
                    
                    const targetCell = document.createElement('td');
                    targetCell.style.textAlign = 'center';
                    targetCell.textContent = language;
                    
                    const timeCell = document.createElement('td');
                    timeCell.style.textAlign = 'center';
                    timeCell.textContent = `${range.start} ~ ${range.end}`;
                    
                    const registerCell = document.createElement('td');
                    registerCell.style.textAlign = 'center';
                    registerCell.id = `destination-register-split-${langIndex}-${index}`;
                    registerCell.innerHTML = '<span style="color: #9ca3af;">-</span>';
                    
                    const workerCell = document.createElement('td');
                    workerCell.style.textAlign = 'center';
                    workerCell.style.fontSize = '12px';
                    workerCell.style.color = '#6b7280';
                    workerCell.textContent = '- (ëŒ€ê¸°)';
                    
                    const assignCell = document.createElement('td');
                    assignCell.style.textAlign = 'center';
                    assignCell.innerHTML = `<button class="btn" onclick="assignNewWorker('${range.name}', '${projectTitle}')" style="background: #8b5cf6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">ì‘ì—…ì ë³€ê²½</button>`;
                    
                    const toolsCell = document.createElement('td');
                    toolsCell.style.textAlign = 'center';
                    toolsCell.innerHTML = `<div style="display: flex; gap: 4px; justify-content: center; flex-wrap: nowrap;"><button class="btn" onclick="executeTranscription('${range.name}')" style="background: #3b82f6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer;">ì „ì‚¬íˆ´ ì‹¤í–‰</button><button class="btn" onclick="executeReview('${range.name}')" style="background: #10b981; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer;">ê²€ìˆ˜íˆ´ ì‹¤í–‰</button></div>`;
                    
                    const outputCell = document.createElement('td');
                    outputCell.style.textAlign = 'center';
                    outputCell.innerHTML = `<button class="btn" onclick="downloadOutput('${range.name}')" style="background: #f59e0b; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">ì‚°ì¶œë¬¼ ë‹¤ìš´ë¡œë“œ</button>`;
                    
                    const statusCell = document.createElement('td');
                    statusCell.style.textAlign = 'center';
                    statusCell.innerHTML = '<span class="status-badge" style="background: #e5e7eb; color: #374151; padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;">ëŒ€ê¸°</span>';
                    
                    // ëª¨ë“  ì…€ì„ í–‰ì— ì¶”ê°€
                    splitRow.appendChild(projectNameCell);
                    splitRow.appendChild(fileNameCell);
                    splitRow.appendChild(sourceCell);
                    splitRow.appendChild(targetCell);
                    splitRow.appendChild(timeCell);
                    splitRow.appendChild(registerCell);
                    splitRow.appendChild(workerCell);
                    splitRow.appendChild(assignCell);
                    splitRow.appendChild(toolsCell);
                    splitRow.appendChild(outputCell);
                    splitRow.appendChild(statusCell);
                    
                    // ì›ë³¸ íŒŒì¼ ë‹¤ìŒì— ì‚½ì…
                    destinationTbody.insertBefore(splitRow, originalRow.nextSibling);
                });
            }
        }
        
        // ë„ì°©ì–´ ì˜ì—­ ì§„í–‰ìƒíƒœ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateDestinationAreaProgressStatus(fileName, language, langIndex, status) {
            const destinationTbody = document.getElementById(`destination-tbody-${langIndex}`);
            if (!destinationTbody) return;
            
            const rows = destinationTbody.querySelectorAll('tr');
            rows.forEach(row => {
                // í”„ë¡œì íŠ¸ëª… ì»¬ëŸ¼ì´ ì¶”ê°€ë˜ì–´ íŒŒì¼ëª…ì€ ë‘ ë²ˆì§¸ ì…€
                const fileNameCell = row.querySelector('td:nth-child(2)') || row.querySelector('.file-name');
                if (fileNameCell) {
                    const currentFileName = fileNameCell.textContent.replace('â†’ ', '').replace('[ë¶„í• ë¨]', '').trim();
                    if (currentFileName === fileName) {
                        // ì§„í–‰ìƒíƒœ ì»¬ëŸ¼ ì°¾ê¸° (ë§ˆì§€ë§‰ ì»¬ëŸ¼)
                        const progressCell = row.querySelector('td:last-child');
                        if (progressCell) {
                            // ë°°ì§€ ìŠ¤íƒ€ì¼ë¡œ ì—…ë°ì´íŠ¸
                            const badgeColor = status === 'ê²€ìˆ˜ì™„ë£Œ' ? '#10b981' : '#6b7280';
                            progressCell.innerHTML = `<span style="background: ${badgeColor}; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;">${status}</span>`;
                        }
                    }
                }
            });
        }
        
        // ë„ì°©ì–´ ì˜ì—­ íŒŒì¼ í•©ì¹˜ê¸° í•¨ìˆ˜
        function mergeDestinationFiles(fileName, projectTitle, language, langIndex) {
            if (confirm(`${fileName} íŒŒì¼ì˜ ë„ì°©ì–´ ì˜ì—­(${language}) ë¶„í• ëœ êµ¬ê°„ë“¤ì„ í•©ì¹˜ëŠ” ê²€ìˆ˜íˆ´ì„ ì‹¤í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                // ë„ì°©ì–´ ì˜ì—­ì˜ ì§„í–‰ìƒíƒœë¥¼ "ê²€ìˆ˜ì™„ë£Œ"ë¡œ ë³€ê²½
                updateDestinationAreaProgressStatus(fileName, language, langIndex, 'ê²€ìˆ˜ì™„ë£Œ');
                
                alert(`${fileName} íŒŒì¼ì˜ ê²€ìˆ˜íˆ´ì´ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤.\në„ì°©ì–´ ì˜ì—­(${language}) ì§„í–‰ìƒíƒœê°€ "ê²€ìˆ˜ì™„ë£Œ"ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.\n\n${language} ë²ˆì—­ ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!`);
            }
        }
        
        // ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ë“±ë¡
        function registerToWorkspy() {
            console.log('registerToWorkspy í•¨ìˆ˜ í˜¸ì¶œë¨');
            
            const targetRows = document.querySelectorAll('#target-file-list tr:not(#empty-state)');
            console.log('ë“±ë¡í•  ëŒ€ìƒ íŒŒì¼ë“¤:', targetRows);
            console.log('ëŒ€ìƒ íŒŒì¼ ê°œìˆ˜:', targetRows.length);
            
            if (targetRows.length === 0) {
                alert('ë“±ë¡í•  íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € íŒŒì¼ì„ ë“±ë¡ ëŒ€ìƒìœ¼ë¡œ ì´ë™í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ë“±ë¡ ì „ì— íŒŒì¼ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ì €ì¥
            const filesToRegister = [];
            targetRows.forEach(row => {
                const projectTitle = row.querySelector('td:nth-child(2)').textContent;
                const fileName = row.querySelector('td:nth-child(3)').textContent;
                const sourceLanguage = row.querySelector('td:nth-child(4)').textContent;
                const targetLanguage = row.querySelector('td:nth-child(5)').textContent;
                const duration = row.querySelector('td:nth-child(6)').textContent;
                
                filesToRegister.push({
                    projectTitle,
                    fileName,
                    sourceLanguage,
                    targetLanguage,
                    duration,
                    isTreeChild: row.classList.contains('tree-child'),
                    isTreeParent: row.classList.contains('tree-parent')
                });
            });
            
            console.log('ì €ì¥ëœ íŒŒì¼ ë°ì´í„°:', filesToRegister);
            
            let fileList = '';
            filesToRegister.forEach(file => {
                fileList += `â€¢ [${file.projectTitle}] ${file.fileName} (${file.duration})\n`;
            });
            
            const confirmMessage = `ì„ íƒëœ íŒŒì¼ë“¤ì˜ ì„¸íŒ…ì„ ì™„ë£Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\n${fileList}\níŒŒì¼ ì„¸íŒ…ì´ ì™„ë£Œë©ë‹ˆë‹¤.`;
            
            if (confirm(confirmMessage)) {
                alert(`âœ… íŒŒì¼ ì„¸íŒ… ì™„ë£Œ!\n\n${filesToRegister.length}ê°œ íŒŒì¼ì˜ ì„¸íŒ…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`);
                
                // ëª¨ë‹¬ ë‹«ê¸°
                closeWorksbyModal();
            }
        }
        
        // ë“±ë¡ëœ íŒŒì¼ë“¤ í‘œì‹œ í•¨ìˆ˜ (ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)
        function showRegisteredFiles() {
            console.log('showRegisteredFiles í•¨ìˆ˜ í˜¸ì¶œë¨ - íŒŒì¼ ì„¸íŒ… ì™„ë£Œ íŒŒì¼ ì˜ì—­ ì œê±°ë¡œ ì¸í•´ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ');
            // íŒŒì¼ ì„¸íŒ… ì™„ë£Œ íŒŒì¼ ì˜ì—­ì´ ì œê±°ë˜ì–´ ì´ í•¨ìˆ˜ëŠ” ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
        }
        
        // ì €ì¥ëœ ë°ì´í„°ë¡œ ë“±ë¡ëœ íŒŒì¼ë“¤ í‘œì‹œ (ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)
        function showRegisteredFilesWithData(filesToRegister) {
            console.log('showRegisteredFilesWithData í•¨ìˆ˜ í˜¸ì¶œë¨ - íŒŒì¼ ì„¸íŒ… ì™„ë£Œ íŒŒì¼ ì˜ì—­ ì œê±°ë¡œ ì¸í•´ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ');
            // íŒŒì¼ ì„¸íŒ… ì™„ë£Œ íŒŒì¼ ì˜ì—­ì´ ì œê±°ë˜ì–´ ì´ í•¨ìˆ˜ëŠ” ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
            
        }
        
        // ì›ìŠ¤íŒŒì´ ë“±ë¡ ëª¨ë‹¬ ì—´ê¸°
        function openWorksbyRegistrationModal(fileName, projectTitle) {
            console.log('ì›ìŠ¤íŒŒì´ ë“±ë¡ ëª¨ë‹¬ ì—´ê¸°:', fileName, projectTitle);
            
            // ê¸°ì¡´ selectedFileInfoê°€ ìˆìœ¼ë©´ ë³´ì¡´í•˜ê³  ì—†ìœ¼ë©´ ìƒˆë¡œ ìƒì„±
            if (!window.selectedFileInfo) {
            window.selectedFileInfo = {
                fileName: fileName,
                projectTitle: projectTitle
            };
            } else {
                // ê¸°ì¡´ ì •ë³´ ë³´ì¡´í•˜ë©´ì„œ íŒŒì¼ëª…ê³¼ í”„ë¡œì íŠ¸ëª…ë§Œ ì—…ë°ì´íŠ¸
                window.selectedFileInfo.fileName = fileName;
                window.selectedFileInfo.projectTitle = projectTitle;
            }
            
            // í˜„ì¬ ë‚ ì§œ ê¸°ì¤€ìœ¼ë¡œ ê¸°ë³¸ê°’ ì„¤ì •
            const now = new Date();
            const tomorrow = new Date(now);
            tomorrow.setDate(tomorrow.getDate() + 1);
            const nextWeek = new Date(now);
            nextWeek.setDate(nextWeek.getDate() + 7);
            
            // ë‚ ì§œ í¬ë§·íŒ… (YYYY-MM-DDTHH:MM)
            const formatDateTime = (date) => {
                return date.getFullYear() + '-' + 
                       String(date.getMonth() + 1).padStart(2, '0') + '-' + 
                       String(date.getDate()).padStart(2, '0') + 'T' + 
                       String(date.getHours()).padStart(2, '0') + ':' + 
                       String(date.getMinutes()).padStart(2, '0');
            };
            
            const formatDate = (date) => {
                return date.getFullYear() + '-' + 
                       String(date.getMonth() + 1).padStart(2, '0') + '-' + 
                       String(date.getDate()).padStart(2, '0');
            };
            
            // ê¸°ë³¸ê°’ ì„¤ì •
            document.getElementById('recruitStartDate').value = formatDateTime(now);
            document.getElementById('recruitEndDate').value = formatDateTime(tomorrow);
            document.getElementById('workStartDate').value = formatDate(tomorrow);
            document.getElementById('workEndDate').value = formatDate(nextWeek);
            
            // í”„ë¡œì íŠ¸ëª…ì— ê¸°ë³¸ê°’ ì„¤ì • (ë¶„ë¥˜ëª… ì‚¬ìš©)
            document.getElementById('worksbyProjectName').value = projectTitle || '';
            
            // ë‹¤ì¤‘ íŒŒì¼ ì •ë³´ í‘œì‹œ
            const fileCount = window.selectedFileInfo?.selectedFiles?.length || 1;
            const isMultiProject = window.selectedFileInfo?.isMultiProject || false;
            
            // ì„ íƒëœ íŒŒì¼ ëª©ë¡ í‘œì‹œ (ë‹¤ì¤‘ íŒŒì¼ì¼ ë•Œë§Œ)
            const selectedFilesInfo = document.getElementById('selectedFilesInfo');
            const selectedFilesList = document.getElementById('selectedFilesList');
            const projectNameHint = document.getElementById('projectNameHint');
            
            if (isMultiProject && window.selectedFileInfo?.selectedFiles) {
                // ë‹¤ì¤‘ íŒŒì¼ ì •ë³´ í‘œì‹œ
                selectedFilesInfo.style.display = 'block';
                projectNameHint.style.display = 'block';
                
                const filesListHTML = window.selectedFileInfo.selectedFiles.map((file, index) => 
                    `<div style="padding: 6px 0; border-bottom: ${index < window.selectedFileInfo.selectedFiles.length - 1 ? '1px solid #e5e7eb' : 'none'};">
                        <span style="font-weight: 500; color: #3b82f6;">ğŸ“ ${file.fileName}</span>
                        <span style="margin-left: 10px; font-size: 11px; color: #6b7280;">â†’ í”„ë¡œì íŠ¸ ${index + 1}</span>
                    </div>`
                ).join('');
                
                selectedFilesList.innerHTML = filesListHTML;
            } else {
                // ë‹¨ì¼ íŒŒì¼ì¸ ê²½ìš° ìˆ¨ê¹€
                selectedFilesInfo.style.display = 'none';
                projectNameHint.style.display = 'none';
            }
            
            // Footer ì •ë³´ ì—…ë°ì´íŠ¸
            const selectedFileSpan = document.getElementById('worksby-selected-file-name');
            const targetCountSpan = document.getElementById('worksby-target-count');
            
            if (selectedFileSpan) selectedFileSpan.textContent = fileCount;
            if (targetCountSpan) {
                if (isMultiProject) {
                    targetCountSpan.textContent = fileCount; // ë‹¤ì¤‘ íŒŒì¼ì¼ ë•ŒëŠ” ê°ê° ë³„ë„ í”„ë¡œì íŠ¸
                } else {
                    targetCountSpan.textContent = '1'; // ë‹¨ì¼ íŒŒì¼ì¼ ë•ŒëŠ” 1ê°œ í”„ë¡œì íŠ¸
                }
            }
            
            document.getElementById('worksbyRegistrationModal').style.display = 'flex';
            console.log('ì›ìŠ¤íŒŒì´ ë“±ë¡ ëª¨ë‹¬ì´ ì—´ë ¸ìŠµë‹ˆë‹¤.');
        }
        
        // ì›ìŠ¤íŒŒì´ ë“±ë¡ ëª¨ë‹¬ ë‹«ê¸°
        function closeWorksbyRegistrationModal() {
            console.log('ì›ìŠ¤íŒŒì´ ë“±ë¡ ëª¨ë‹¬ ë‹«ê¸° ì‹œì‘...');
            const modal = document.getElementById('worksbyRegistrationModal');
            if (modal) {
                modal.style.display = 'none';
                console.log('ì›ìŠ¤íŒŒì´ ë“±ë¡ ëª¨ë‹¬ì´ ë‹«í˜”ìŠµë‹ˆë‹¤.');
                
                // í¼ ì´ˆê¸°í™”
                const projectNameInput = document.getElementById('worksbyProjectName');
                if (projectNameInput) {
                    projectNameInput.value = '';
                }
                
                const projectDescInput = document.getElementById('projectDescription');
                if (projectDescInput) {
                    projectDescInput.value = '';
                }
                
                // ë‹¤ì¤‘ íŒŒì¼ ì •ë³´ ìˆ¨ê¹€
                const selectedFilesInfo = document.getElementById('selectedFilesInfo');
                const projectNameHint = document.getElementById('projectNameHint');
                if (selectedFilesInfo) selectedFilesInfo.style.display = 'none';
                if (projectNameHint) projectNameHint.style.display = 'none';
            } else {
                console.log('ì›ìŠ¤íŒŒì´ ë“±ë¡ ëª¨ë‹¬ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
        }
        
        // ê¸´ê¸‰ í† ê¸€
        function toggleUrgent() {
            const toggle = document.getElementById('urgentToggle');
            const span = toggle.nextElementSibling;
            
            if (toggle.checked) {
                span.style.background = '#ef4444';
                span.textContent = 'ê¸´ê¸‰';
            } else {
                span.style.background = '#3b82f6';
                span.textContent = 'ì‹ ì²­ë²„íŠ¼';
            }
        }
        
        // ì¸ë„¤ì¼ ì„ íƒ
        function selectThumbnail() {
            alert('ì¸ë„¤ì¼ íŒŒì¼ ì„ íƒ ê¸°ëŠ¥ì…ë‹ˆë‹¤.');
        }
        
        // ì²¨ë¶€íŒŒì¼ ì„ íƒ
        function selectAttachment() {
            alert('ì²¨ë¶€íŒŒì¼ ì„ íƒ ê¸°ëŠ¥ì…ë‹ˆë‹¤.');
        }
        
        // ì „ì²´ ì„ íƒ ì²´í¬ë°•ìŠ¤ í´ë¦­ ì²˜ë¦¬
        function handleSelectAllClick(event, selectAllCheckbox) {
            // ì´ë²¤íŠ¸ ì „íŒŒ ì¤‘ë‹¨ (í•„ìš”í•œ ê²½ìš°)
            event.stopPropagation();
            
            // ì „ì²´ íŒŒì¼ ì„ íƒ/í•´ì œ
            toggleAllFiles(selectAllCheckbox);
        }
        
        // ì „ì²´ íŒŒì¼ ì„ íƒ/í•´ì œ
        function toggleAllFiles(selectAllCheckbox) {
            const checkboxes = document.querySelectorAll('.file-select-checkbox:not(:disabled)');
            checkboxes.forEach(checkbox => {
                checkbox.checked = selectAllCheckbox.checked;
            });
            
            console.log('ì „ì²´ ì„ íƒ ì²˜ë¦¬ ì™„ë£Œ:', selectAllCheckbox.checked);
        }
        
        // íŒŒì¼ í–‰ ì„ íƒ (ë°°ê²½ìƒ‰ ë³€ê²½ + ì¶œë°œì–´ ì˜ì—­ í‘œì‹œ, ì²´í¬ë°•ìŠ¤ëŠ” í† ê¸€í•˜ì§€ ì•ŠìŒ)
        function selectFileRow(row) {
            console.log('íŒŒì¼ í–‰ ì„ íƒë¨:', row);
            
            // ëª¨ë“  íŒŒì¼ í–‰ì˜ ì„ íƒ ìƒíƒœ ì´ˆê¸°í™”
            const allFileRows = document.querySelectorAll('.file-table tbody tr[data-file-id]');
            allFileRows.forEach(fileRow => {
                fileRow.classList.remove('selected-file-row');
            });
            
            // ì„ íƒëœ í–‰ í•˜ì´ë¼ì´íŠ¸ (CSS í´ë˜ìŠ¤ ì‚¬ìš©)
            row.classList.add('selected-file-row');
            
            // ì›ë³¸ íŒŒì¼(tree-parent)ì¸ ê²½ìš° ë¶„í• ëœ íŒŒì¼ë“¤ë„ í•¨ê»˜ í•˜ì´ë¼ì´íŠ¸
            if (row.classList.contains('tree-parent')) {
                let nextRow = row.nextElementSibling;
                while (nextRow && nextRow.classList.contains('tree-child')) {
                    nextRow.classList.add('selected-file-row');
                    nextRow = nextRow.nextElementSibling;
                }
                console.log('ì›ë³¸ íŒŒì¼ê³¼ ë¶„í• ëœ íŒŒì¼ë“¤ ëª¨ë‘ ì„ íƒë¨');
            }
            
            // ë¶„í• ëœ íŒŒì¼(tree-child)ì¸ ê²½ìš° ì›ë³¸ íŒŒì¼ê³¼ ëª¨ë“  ë¶„í•  íŒŒì¼ë“¤ í•˜ì´ë¼ì´íŠ¸
            if (row.classList.contains('tree-child')) {
                // ì›ë³¸ íŒŒì¼ ì°¾ê¸°
                let parentRow = row.previousElementSibling;
                while (parentRow && !parentRow.classList.contains('tree-parent')) {
                    parentRow = parentRow.previousElementSibling;
                }
                
                if (parentRow && parentRow.classList.contains('tree-parent')) {
                    // ì›ë³¸ íŒŒì¼ í•˜ì´ë¼ì´íŠ¸
                    parentRow.classList.add('selected-file-row');
                    
                    // ëª¨ë“  ë¶„í• ëœ íŒŒì¼ë“¤ í•˜ì´ë¼ì´íŠ¸
                    let nextRow = parentRow.nextElementSibling;
                    while (nextRow && nextRow.classList.contains('tree-child')) {
                        nextRow.classList.add('selected-file-row');
                        nextRow = nextRow.nextElementSibling;
                    }
                    console.log('ë¶„í• ëœ íŒŒì¼ ì„ íƒìœ¼ë¡œ ì›ë³¸ íŒŒì¼ê³¼ ëª¨ë“  ë¶„í•  íŒŒì¼ë“¤ ì„ íƒë¨');
                }
            }
            
            // ì„ íƒëœ íŒŒì¼ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
            const fileId = row.getAttribute('data-file-id');
            const fileName = row.querySelector('.file-name').textContent;
            
            console.log('ì„ íƒëœ íŒŒì¼:', fileId, fileName);
            
            // í•´ë‹¹ íŒŒì¼ì˜ í”„ë¡œì íŠ¸ê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ê³  ì¶œë°œì–´ ì˜ì—­ í‘œì‹œ
            showSourceAreaForFile(fileId, fileName);
        }
        
        // íŠ¹ì • íŒŒì¼ì˜ ì¶œë°œì–´ ì˜ì—­ í‘œì‹œ
        function showSourceAreaForFile(fileId, fileName) {
            console.log('íŒŒì¼ì˜ ì¶œë°œì–´ ì˜ì—­ í‘œì‹œ:', fileId, fileName);
            
            // ë¶„í• ëœ íŒŒì¼ì¸ ê²½ìš° ì›ë³¸ íŒŒì¼ëª…ìœ¼ë¡œ í”„ë¡œì íŠ¸ ì°¾ê¸°
            let searchFileName = fileName;
            if (fileName.includes('_êµ¬ê°„')) {
                // ë¶„í• ëœ íŒŒì¼ëª…ì—ì„œ ì›ë³¸ íŒŒì¼ëª… ì¶”ì¶œ (ì˜ˆ: "íŒŒì¼ëª…_êµ¬ê°„1.mp4" â†’ "íŒŒì¼ëª….mp4")
                const parts = fileName.split('_êµ¬ê°„');
                if (parts.length > 1) {
                    searchFileName = parts[0] + '.' + fileName.split('.').pop();
                }
            }
            
            console.log('í”„ë¡œì íŠ¸ ê²€ìƒ‰ìš© íŒŒì¼ëª…:', searchFileName);
            
            // í•´ë‹¹ íŒŒì¼ë¡œ ìƒì„±ëœ í”„ë¡œì íŠ¸ ì°¾ê¸°
            let targetProjectId = null;
            if (window.allProjectsData) {
                for (const [projectId, projectData] of Object.entries(window.allProjectsData)) {
                    // ì›ë³¸ íŒŒì¼ IDë¡œ ê²€ìƒ‰ (ë¶„í• ëœ íŒŒì¼ë“¤ì€ ê°™ì€ fileIdë¥¼ ê°€ì§)
                    if (projectData.selectedFiles && projectData.selectedFiles.includes(fileId)) {
                        targetProjectId = projectId;
                        break;
                    }
                    
                    // íŒŒì¼ëª…ìœ¼ë¡œë„ ê²€ìƒ‰ (í´ë°±)
                    if (projectData.fileName && (projectData.fileName === searchFileName || projectData.fileName.includes(searchFileName.replace(/\.[^/.]+$/, "")))) {
                        targetProjectId = projectId;
                        break;
                    }
                }
            }
            
            console.log('ì°¾ì€ í”„ë¡œì íŠ¸ ID:', targetProjectId);
            
            if (targetProjectId) {
                // ëª¨ë“  ì¶œë°œì–´ ì˜ì—­ ìˆ¨ê¸°ê¸°
                const allProjectAreas = document.querySelectorAll('[id^="worksby-detail-area-"]');
                allProjectAreas.forEach(area => {
                    area.style.display = 'none';
                });
                
                // í•´ë‹¹ íŒŒì¼ì˜ ì¶œë°œì–´ ì˜ì—­ë§Œ í‘œì‹œ
                const targetArea = document.getElementById(`worksby-detail-area-${targetProjectId}`);
                if (targetArea) {
                    targetArea.style.display = 'block';
                    
                    // ì¶œë°œì–´ ì˜ì—­ìœ¼ë¡œ ìŠ¤í¬ë¡¤
                    setTimeout(() => {
                        targetArea.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }, 100);
                    
                    console.log(`íŒŒì¼ ${fileName}ì˜ ì¶œë°œì–´ ì˜ì—­ì„ í‘œì‹œí–ˆìŠµë‹ˆë‹¤.`);
                } else {
                    console.log(`íŒŒì¼ ${fileName}ì˜ ì¶œë°œì–´ ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
                }
            } else {
                // í•´ë‹¹ íŒŒì¼ë¡œ ìƒì„±ëœ í”„ë¡œì íŠ¸ê°€ ì—†ìœ¼ë©´ ëª¨ë“  ì¶œë°œì–´ ì˜ì—­ ìˆ¨ê¸°ê¸°
                const allProjectAreas = document.querySelectorAll('[id^="worksby-detail-area-"]');
                allProjectAreas.forEach(area => {
                    area.style.display = 'none';
                });
                console.log(`íŒŒì¼ ${fileName}ë¡œ ìƒì„±ëœ í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.`);
            }
        }
        
        // ì²´í¬ë°•ìŠ¤ ì§ì ‘ í´ë¦­ ì²˜ë¦¬ (í–‰ ì„ íƒ ì—†ì´ ì²´í¬ë§Œ)
        function handleCheckboxClick(event, checkbox) {
            // í–‰ í´ë¦­ ì´ë²¤íŠ¸ ì „íŒŒ ì¤‘ë‹¨
            event.stopPropagation();
            
            // ì²´í¬ë°•ìŠ¤ ìƒíƒœëŠ” ìë™ìœ¼ë¡œ ë³€ê²½ë˜ë¯€ë¡œ ì¶”ê°€ ì²˜ë¦¬ë§Œ ìˆ˜í–‰
            const row = checkbox.closest('tr');
            
            // ì›ë³¸ íŒŒì¼ì´ë©´ì„œ ë¶„í• ëœ íŒŒì¼ì´ ìˆëŠ” ê²½ìš°, ë¶„í• ëœ íŒŒì¼ë“¤ë„ í•¨ê»˜ ì²´í¬
            if (row.classList.contains('tree-parent')) {
                toggleSplitFilesCheckbox(row, checkbox.checked);
            }
            
            // ì „ì²´ ì„ íƒ ì²´í¬ë°•ìŠ¤ ìƒíƒœ ì—…ë°ì´íŠ¸
            updateSelectAllCheckbox();
            
            console.log('ì²´í¬ë°•ìŠ¤ ì§ì ‘ í´ë¦­ ì²˜ë¦¬ ì™„ë£Œ:', checkbox.value, checkbox.checked);
        }
        
        
        // ë¶„í• ëœ íŒŒì¼ë“¤ì˜ ì²´í¬ë°•ìŠ¤ ìƒíƒœ ì—°ë™
        function toggleSplitFilesCheckbox(parentRow, isChecked) {
            let nextRow = parentRow.nextElementSibling;
            
            while (nextRow && nextRow.classList.contains('tree-child')) {
                const splitCheckbox = nextRow.querySelector('.split-file-checkbox');
                if (splitCheckbox) {
                    splitCheckbox.checked = isChecked;
                }
                nextRow = nextRow.nextElementSibling;
            }
        }
        
        // ì „ì²´ ì„ íƒ ì²´í¬ë°•ìŠ¤ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateSelectAllCheckbox() {
            const allCheckboxes = document.querySelectorAll('.file-select-checkbox:not(:disabled)');
            const checkedCheckboxes = document.querySelectorAll('.file-select-checkbox:not(:disabled):checked');
            const selectAllCheckbox = document.getElementById('selectAllFiles');
            
            if (selectAllCheckbox) {
                if (checkedCheckboxes.length === 0) {
                    selectAllCheckbox.checked = false;
                    selectAllCheckbox.indeterminate = false;
                } else if (checkedCheckboxes.length === allCheckboxes.length) {
                    selectAllCheckbox.checked = true;
                    selectAllCheckbox.indeterminate = false;
                } else {
                    selectAllCheckbox.checked = false;
                    selectAllCheckbox.indeterminate = true;
                }
            }
        }
        
        // ì„ íƒ í”„ë¡¬í”„íŠ¸ ë³€ê²½
        function changeSelectedPrompt() {
            const selectedValue = document.getElementById('defaultPromptSelect').value;
            
            // 1ìˆœìœ„: ë°°ê²½ìƒ‰ìœ¼ë¡œ ì„ íƒëœ íŒŒì¼ ì°¾ê¸°
            const selectedRow = document.querySelector('.file-table tbody tr.selected-file-row');
            
            if (selectedRow) {
                // ë°°ê²½ìƒ‰ìœ¼ë¡œ ì„ íƒëœ íŒŒì¼ì´ ìˆëŠ” ê²½ìš°
                const fileName = selectedRow.querySelector('.file-name').textContent;
                
                if (confirm(`ì„ íƒëœ íŒŒì¼ì˜ í”„ë¡¬í”„íŠ¸ë¥¼ "${selectedValue}"ë¡œ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\níŒŒì¼: ${fileName}`)) {
                    // í”„ë¡¬í”„íŠ¸ ë³€ê²½ ë¡œì§ - ë°°ì§€ ìŠ¤íƒ€ì¼ ì ìš©
                    const promptCell = selectedRow.querySelector('td:nth-child(6)'); // í”„ë¡¬í”„íŠ¸ ì»¬ëŸ¼
                    if (promptCell) {
                        // ë°°ì§€ ìƒ‰ìƒ ì„¤ì •
                        let badgeColor = '#e5e7eb';
                        let textColor = '#374151';
                        
                        switch(selectedValue) {
                            case 'ì˜µì…˜1':
                                badgeColor = '#dbeafe';
                                textColor = '#1d4ed8';
                                break;
                            case 'ì˜µì…˜2':
                                badgeColor = '#dcfce7';
                                textColor = '#166534';
                                break;
                            case 'ì˜µì…˜3':
                                badgeColor = '#fef3c7';
                                textColor = '#92400e';
                                break;
                            case 'ì˜µì…˜4':
                                badgeColor = '#fce7f3';
                                textColor = '#be185d';
                                break;
                            case 'ì˜µì…˜5':
                                badgeColor = '#e0e7ff';
                                textColor = '#5b21b6';
                                break;
                            default: // ê¸°ë³¸
                                badgeColor = '#e5e7eb';
                                textColor = '#374151';
                        }
                        
                        promptCell.innerHTML = `<span class="prompt-badge" style="background: ${badgeColor}; color: ${textColor}; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 500;">${selectedValue}</span>`;
                    }
                    
                    alert(`íŒŒì¼ì˜ í”„ë¡¬í”„íŠ¸ê°€ "${selectedValue}"ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.\n\níŒŒì¼: ${fileName}`);
                }
                return;
            }
            
            // 2ìˆœìœ„: ì²´í¬ëœ íŒŒì¼ë“¤ ì°¾ê¸° (ë°°ê²½ìƒ‰ ì„ íƒì´ ì—†ëŠ” ê²½ìš°)
            const checkedBoxes = document.querySelectorAll('.file-select-checkbox:checked');
            const selectedFiles = [];
            
            checkedBoxes.forEach(checkbox => {
                const row = checkbox.closest('tr');
                const fileName = row.querySelector('.file-name').textContent;
                selectedFiles.push(fileName);
            });
            
            if (selectedFiles.length === 0) {
                alert('ë³€ê²½í•  íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.\n(íŒŒì¼ í–‰ì„ í´ë¦­í•˜ê±°ë‚˜ ì²´í¬ë°•ìŠ¤ë¥¼ ì²´í¬í•´ì£¼ì„¸ìš”)');
                return;
            }
            
            if (confirm(`ì„ íƒëœ ${selectedFiles.length}ê°œ íŒŒì¼ì˜ í”„ë¡¬í”„íŠ¸ë¥¼ "${selectedValue}"ë¡œ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                // í”„ë¡¬í”„íŠ¸ ë³€ê²½ ë¡œì§ - ë°°ì§€ ìŠ¤íƒ€ì¼ ì ìš©
                checkedBoxes.forEach(checkbox => {
                    const row = checkbox.closest('tr');
                    const promptCell = row.querySelector('td:nth-child(6)'); // í”„ë¡¬í”„íŠ¸ ì»¬ëŸ¼ (ì²´í¬ë°•ìŠ¤ ì¶”ê°€ë¡œ ì¸ë±ìŠ¤ ë³€ê²½)
                    if (promptCell) {
                        // ë°°ì§€ ìƒ‰ìƒ ì„¤ì •
                        let badgeColor = '#e5e7eb';
                        let textColor = '#374151';
                        
                        switch(selectedValue) {
                            case 'ì˜µì…˜1':
                                badgeColor = '#dbeafe';
                                textColor = '#1d4ed8';
                                break;
                            case 'ì˜µì…˜2':
                                badgeColor = '#dcfce7';
                                textColor = '#166534';
                                break;
                            case 'ì˜µì…˜3':
                                badgeColor = '#fef3c7';
                                textColor = '#92400e';
                                break;
                            case 'ì˜µì…˜4':
                                badgeColor = '#fce7f3';
                                textColor = '#be185d';
                                break;
                            case 'ì˜µì…˜5':
                                badgeColor = '#e0e7ff';
                                textColor = '#5b21b6';
                                break;
                            default: // ê¸°ë³¸
                                badgeColor = '#e5e7eb';
                                textColor = '#374151';
                        }
                        
                        promptCell.innerHTML = `<span class="prompt-badge" style="background: ${badgeColor}; color: ${textColor}; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 500;">${selectedValue}</span>`;
                    }
                });
                
                alert(`${selectedFiles.length}ê°œ íŒŒì¼ì˜ í”„ë¡¬í”„íŠ¸ê°€ "${selectedValue}"ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                
                // ì²´í¬ë°•ìŠ¤ í•´ì œ
                checkedBoxes.forEach(checkbox => {
                    checkbox.checked = false;
                });
                document.getElementById('selectAllFiles').checked = false;
            }
        }
        
        // ì˜ë¢°íŒŒì¼ ì¶”ê°€
        function addRequestFile() {
            document.getElementById('fileAddModal').style.display = 'flex';
            
            // í¼ ì´ˆê¸°í™”
            document.getElementById('fileAddForm').reset();
            removeNewFile();
        }
        
        // ì„ íƒëœ íŒŒì¼ë“¤ ë¶„í•  (íŒŒì¼ ë¦¬ìŠ¤íŠ¸ì—ì„œ)
        function splitSelectedFiles() {
            // 1ìˆœìœ„: ë°°ê²½ìƒ‰ìœ¼ë¡œ ì„ íƒëœ íŒŒì¼ ì°¾ê¸°
            const selectedRow = document.querySelector('.file-table tbody tr.selected-file-row');
            
            if (selectedRow) {
                // ë°°ê²½ìƒ‰ìœ¼ë¡œ ì„ íƒëœ íŒŒì¼ì´ ìˆëŠ” ê²½ìš°
                const fileName = selectedRow.querySelector('.file-name').textContent;
                const fileLength = selectedRow.querySelector('td:nth-child(5)').textContent;
                
                document.getElementById('splitFileName').value = fileName;
                document.getElementById('splitFileLength').value = fileLength;
                document.getElementById('fileSplitModal').style.display = 'flex';
                
                // ë¶„í•  ì»¨í…ìŠ¤íŠ¸ ì„¤ì •
                window.currentSplitContext = {
                    area: 'main',
                    fileName: fileName
                };
                
                console.log('ë°°ê²½ìƒ‰ ì„ íƒëœ íŒŒì¼ë¡œ ë¶„í•  ëª¨ë‹¬ ì—´ê¸°:', fileName);
                return;
            }
            
            // 2ìˆœìœ„: ì²´í¬ëœ íŒŒì¼ë“¤ ì°¾ê¸° (ë°°ê²½ìƒ‰ ì„ íƒì´ ì—†ëŠ” ê²½ìš°)
            const checkedBoxes = document.querySelectorAll('.file-select-checkbox:checked');
            const selectedFiles = [];
            
            checkedBoxes.forEach(checkbox => {
                const row = checkbox.closest('tr');
                const fileName = row.querySelector('.file-name').textContent;
                selectedFiles.push(fileName);
            });
            
            if (selectedFiles.length === 0) {
                alert('ë¶„í• í•  íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.\n(íŒŒì¼ í–‰ì„ í´ë¦­í•˜ê±°ë‚˜ ì²´í¬ë°•ìŠ¤ë¥¼ ì²´í¬í•´ì£¼ì„¸ìš”)');
                return;
            }
            
            if (selectedFiles.length > 1) {
                alert('íŒŒì¼ ë¶„í• ì€ í•œ ë²ˆì— í•˜ë‚˜ì˜ íŒŒì¼ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.\ní•˜ë‚˜ì˜ íŒŒì¼ë§Œ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì²« ë²ˆì§¸ ì„ íƒëœ íŒŒì¼ë¡œ ë¶„í•  ëª¨ë‹¬ ì—´ê¸°
            const selectedFileName = selectedFiles[0];
            const selectedFileRow = checkedBoxes[0].closest('tr');
            const fileLength = selectedFileRow.querySelector('td:nth-child(5)').textContent; // íŒŒì¼ ê¸¸ì´
            
            document.getElementById('splitFileName').value = selectedFileName;
            document.getElementById('splitFileLength').value = fileLength;
            document.getElementById('fileSplitModal').style.display = 'flex';
            
            // ë¶„í•  ì»¨í…ìŠ¤íŠ¸ ì„¤ì •
            window.currentSplitContext = {
                area: 'main',
                fileName: selectedFileName
            };
        }
        
        // ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„± (ì„ íƒëœ íŒŒì¼ ê¸°ì¤€)
        function createWorksbyProject() {
            // 1ìˆœìœ„: ë°°ê²½ìƒ‰ìœ¼ë¡œ ì„ íƒëœ íŒŒì¼ ì°¾ê¸°
            const selectedRow = document.querySelector('.file-table tbody tr.selected-file-row');
            
            if (selectedRow) {
                // ë°°ê²½ìƒ‰ìœ¼ë¡œ ì„ íƒëœ íŒŒì¼ì´ ìˆëŠ” ê²½ìš° (ë‹¨ì¼ íŒŒì¼ í”„ë¡œì íŠ¸)
                const fileName = selectedRow.querySelector('.file-name').textContent;
                const fileId = selectedRow.getAttribute('data-file-id');
                
                const selectedFile = {
                    fileName: fileName,
                    row: selectedRow,
                    fileId: fileId
                };
                
                // ì„ íƒëœ íŒŒì¼ ì •ë³´ë¥¼ ì „ì—­ ë³€ìˆ˜ì— ì €ì¥
                window.selectedFileInfo = {
                    fileName: selectedFile.fileName,
                    projectTitle: 'ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸',
                    selectedFiles: [selectedFile],
                    selectedFileIds: [selectedFile.fileId],
                    isMultiProject: false
                };
                
                console.log('ë°°ê²½ìƒ‰ ì„ íƒëœ íŒŒì¼ë¡œ ë‹¨ì¼ í”„ë¡œì íŠ¸ ìƒì„±:', window.selectedFileInfo);
                
                // ì›ìŠ¤íŒŒì´ ë“±ë¡ ëª¨ë‹¬ ì—´ê¸°
                openWorksbyRegistrationModal(selectedFile.fileName, 'ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸');
                return;
            }
            
            // 2ìˆœìœ„: ì²´í¬ëœ íŒŒì¼ë“¤ ì°¾ê¸° (ë°°ê²½ìƒ‰ ì„ íƒì´ ì—†ëŠ” ê²½ìš°)
            const checkedBoxes = document.querySelectorAll('.file-select-checkbox:not(:disabled):checked');
            
            if (checkedBoxes.length === 0) {
                alert('ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ë¡œ ìƒì„±í•  íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.\n(íŒŒì¼ í–‰ì„ í´ë¦­í•˜ê±°ë‚˜ ì²´í¬ë°•ìŠ¤ë¥¼ ì²´í¬í•´ì£¼ì„¸ìš”)');
                return;
            }
            
            // ì²´í¬ëœ íŒŒì¼ ì •ë³´ ìˆ˜ì§‘
            const selectedFiles = [];
            const selectedFileIds = [];
            
            checkedBoxes.forEach(checkbox => {
                const row = checkbox.closest('tr');
                const fileName = row.querySelector('.file-name').textContent;
                const fileId = checkbox.value;
                
                selectedFiles.push({
                    fileName: fileName,
                    row: row,
                    fileId: fileId
                });
                selectedFileIds.push(fileId);
            });
            
            if (checkedBoxes.length === 1) {
                // ë‹¨ì¼ íŒŒì¼ í”„ë¡œì íŠ¸
                window.selectedFileInfo = {
                    fileName: selectedFiles[0].fileName,
                    projectTitle: 'ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸',
                    selectedFiles: selectedFiles,
                    selectedFileIds: selectedFileIds,
                    isMultiProject: false
                };
                
                console.log('ì²´í¬ëœ ë‹¨ì¼ íŒŒì¼ë¡œ í”„ë¡œì íŠ¸ ìƒì„±:', window.selectedFileInfo);
                openWorksbyRegistrationModal(selectedFiles[0].fileName, 'ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸');
            } else {
                // ë‹¤ì¤‘ íŒŒì¼ í”„ë¡œì íŠ¸ (ê°ê° ë³„ë„ í”„ë¡œì íŠ¸ë¡œ ìƒì„±)
                window.selectedFileInfo = {
                    fileName: `${selectedFiles.length}ê°œ íŒŒì¼`,
                    projectTitle: 'ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸',
                    selectedFiles: selectedFiles,
                    selectedFileIds: selectedFileIds,
                    isMultiProject: true
                };
                
                console.log('ì²´í¬ëœ ë‹¤ì¤‘ íŒŒì¼ë¡œ ê°ê° í”„ë¡œì íŠ¸ ìƒì„±:', window.selectedFileInfo);
                openWorksbyRegistrationModal(`${selectedFiles.length}ê°œ íŒŒì¼`, 'ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸');
            }
        }
        
        // ì„ íƒíŒŒì¼ ë‹¤ìš´ë¡œë“œ
        function downloadSelectedFiles() {
            // 1ìˆœìœ„: ë°°ê²½ìƒ‰ìœ¼ë¡œ ì„ íƒëœ íŒŒì¼ ì°¾ê¸°
            const selectedRow = document.querySelector('.file-table tbody tr.selected-file-row');
            
            if (selectedRow) {
                // ë°°ê²½ìƒ‰ìœ¼ë¡œ ì„ íƒëœ íŒŒì¼ì´ ìˆëŠ” ê²½ìš°
                const fileName = selectedRow.querySelector('.file-name').textContent;
                
                alert(`ì„ íƒëœ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.\n\níŒŒì¼: ${fileName}`);
                console.log('ë°°ê²½ìƒ‰ ì„ íƒëœ íŒŒì¼ ë‹¤ìš´ë¡œë“œ:', fileName);
                return;
            }
            
            // 2ìˆœìœ„: ì²´í¬ëœ íŒŒì¼ë“¤ ì°¾ê¸° (ë°°ê²½ìƒ‰ ì„ íƒì´ ì—†ëŠ” ê²½ìš°)
            const checkedBoxes = document.querySelectorAll('.file-select-checkbox:checked');
            const selectedFiles = [];
            
            checkedBoxes.forEach(checkbox => {
                const row = checkbox.closest('tr');
                const fileName = row.querySelector('.file-name').textContent;
                selectedFiles.push(fileName);
            });
            
            if (selectedFiles.length === 0) {
                alert('ë‹¤ìš´ë¡œë“œí•  íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.\n(íŒŒì¼ í–‰ì„ í´ë¦­í•˜ê±°ë‚˜ ì²´í¬ë°•ìŠ¤ë¥¼ ì²´í¬í•´ì£¼ì„¸ìš”)');
                return;
            }
            
            alert(`ì„ íƒëœ ${selectedFiles.length}ê°œ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.\n\níŒŒì¼ ëª©ë¡:\n${selectedFiles.join('\n')}`);
            // ì¶”í›„ êµ¬í˜„ ì˜ˆì •: ì‹¤ì œ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥
        }
        
        // ì›ìŠ¤íŒŒì´ ë“±ë¡ ì²˜ë¦¬ (ìƒˆë¡œìš´ í•¨ìˆ˜)
        function handleWorksbyRegister() {
            console.log('handleWorksbyRegister í•¨ìˆ˜ í˜¸ì¶œë¨');
            saveWorksbyProject();
        }
        
        // ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ì €ì¥
        function saveWorksbyProject() {
            console.log('=== saveWorksbyProject í•¨ìˆ˜ í˜¸ì¶œë¨ ===');
            
            // í”„ë¡œì íŠ¸ëª… ì…ë ¥ ìš”ì†Œ í™•ì¸
            const projectNameElement = document.getElementById('worksbyProjectName');
            const projectName = projectNameElement ? projectNameElement.value.trim() : '';
            
            // ì„ íƒëœ íŒŒì¼ ì •ë³´ ì‚¬ìš©
            const selectedFile = window.selectedFileInfo;
            console.log('ì„ íƒëœ íŒŒì¼ ì •ë³´:', selectedFile);
            
            if (!selectedFile) {
                alert('ë“±ë¡í•  íŒŒì¼ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ì¤‘ê°„ì–´ ì˜ì—­ì—ì„œ í˜¸ì¶œëœ ê²½ìš° ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±í•˜ì§€ ì•Šê³  ê¸°ì¡´ í”„ë¡œì íŠ¸ ì—…ë°ì´íŠ¸ë§Œ í•¨
            if (selectedFile.fromIntermediateArea) {
                console.log('ì¤‘ê°„ì–´ ì˜ì—­ì—ì„œ ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„± - ê¸°ì¡´ í”„ë¡œì íŠ¸ ì—…ë°ì´íŠ¸ë§Œ ìˆ˜í–‰');
                
                // í”„ë¡œì íŠ¸ëª…ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©
                const finalProjectName = projectName || selectedFile.projectTitle || 'ê¸°ë³¸ í”„ë¡œì íŠ¸';
                
                // ì¤‘ê°„ì–´ ì˜ì—­ ì›ìŠ¤íŒŒì´ ë²„íŠ¼ ì—…ë°ì´íŠ¸
                updateIntermediateWorksbyButtons(finalProjectName);
                
                // ëª¨ë‹¬ ë‹«ê¸°
                closeWorksbyRegistrationModal();
                
                alert(`ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ "${finalProjectName}"ì´ ì¤‘ê°„ì–´ ì˜ì—­ì— ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                return;
            }
            
            // ë„ì°©ì–´ ì˜ì—­ì—ì„œ í˜¸ì¶œëœ ê²½ìš° ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±í•˜ì§€ ì•Šê³  ê¸°ì¡´ í”„ë¡œì íŠ¸ ì—…ë°ì´íŠ¸ë§Œ í•¨
            if (selectedFile.fromDestinationArea) {
                console.log('ë„ì°©ì–´ ì˜ì—­ì—ì„œ ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„± - ê¸°ì¡´ í”„ë¡œì íŠ¸ ì—…ë°ì´íŠ¸ë§Œ ìˆ˜í–‰');
                
                // í”„ë¡œì íŠ¸ëª…ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©
                const finalProjectName = projectName || selectedFile.projectTitle || 'ê¸°ë³¸ í”„ë¡œì íŠ¸';
                
                // ë„ì°©ì–´ ì˜ì—­ ì›ìŠ¤íŒŒì´ ë²„íŠ¼ ì—…ë°ì´íŠ¸
                updateDestinationWorksbyButtons(finalProjectName, selectedFile.language, selectedFile.langIndex);
                
                // ëª¨ë‹¬ ë‹«ê¸°
                closeWorksbyRegistrationModal();
                
                alert(`ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ "${finalProjectName}"ì´ ë„ì°©ì–´ ì˜ì—­ì— ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                return;
            }
            
            // í”„ë¡œì íŠ¸ëª…ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©
            const finalProjectName = projectName || selectedFile.projectTitle || 'ê¸°ë³¸ í”„ë¡œì íŠ¸';
            
            // ë‹¤ì¤‘ í”„ë¡œì íŠ¸ ìƒì„± ì—¬ë¶€ í™•ì¸
            if (selectedFile.isMultiProject) {
                // ë‹¤ì¤‘ íŒŒì¼ ê°ê° ë³„ë„ í”„ë¡œì íŠ¸ ìƒì„±
                createMultipleProjects(finalProjectName, selectedFile.selectedFiles);
                return;
            }
            
            // ë‹¨ì¼ í”„ë¡œì íŠ¸ ìƒì„±
            createSingleProject(finalProjectName, selectedFile);
        }
        
        // ë‹¤ì¤‘ íŒŒì¼ì„ ê°ê° ë³„ë„ í”„ë¡œì íŠ¸ë¡œ ìƒì„±
        function createMultipleProjects(baseProjectName, selectedFiles) {
            console.log('ë‹¤ì¤‘ í”„ë¡œì íŠ¸ ìƒì„± ì‹œì‘:', baseProjectName, selectedFiles);
            
            // ëª¨ë‹¬ ë¨¼ì € ë‹«ê¸°
            document.getElementById('worksbyRegistrationModal').style.display = 'none';
            
            // í™•ì¸ ëŒ€í™”ìƒì
            const fileList = selectedFiles.map(file => `â€¢ ${file.fileName}`).join('\n');
            const confirmMessage = `${selectedFiles.length}ê°œ íŒŒì¼ì„ ê°ê° ë³„ë„ì˜ ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ë¡œ ìƒì„±í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\n${fileList}`;
            
            setTimeout(() => {
                if (confirm(confirmMessage)) {
                    let createdProjects = [];
                    
                    // ê° íŒŒì¼ë§ˆë‹¤ ë³„ë„ í”„ë¡œì íŠ¸ ìƒì„±
                    selectedFiles.forEach((file, index) => {
                        const projectData = createProjectData(
                            `${baseProjectName}_${index + 1}`,
                            file,
                            [file],
                            [file.fileId]
                        );
                        
                        // í”„ë¡œì íŠ¸ ë°ì´í„° ì €ì¥
                        if (!window.allProjectsData) {
                            window.allProjectsData = {};
                        }
                        window.allProjectsData[projectData.projectNo] = projectData;
                        
                        // ì¶œë°œì–´ ì˜ì—­ ìƒì„±
                        createDirectSourceArea(projectData);
                        
                        createdProjects.push(projectData.title);
                        
                        console.log(`í”„ë¡œì íŠ¸ ${index + 1} ìƒì„± ì™„ë£Œ:`, projectData.title);
                    });
                    
                    // ì›ìŠ¤íŒŒì´ ìƒíƒœ ì—…ë°ì´íŠ¸
                    updateWorksbyStatusToRegistered();
                    
                    alert(`ğŸ‰ ${selectedFiles.length}ê°œì˜ ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!\n\n${createdProjects.join('\n')}`);
                    
                    // ì„ íƒëœ íŒŒì¼ ì •ë³´ ì´ˆê¸°í™”
                    window.selectedFileInfo = null;
                } else {
                    // ì·¨ì†Œí•œ ê²½ìš° ëª¨ë‹¬ì„ ë‹¤ì‹œ ì—´ì–´ì¤Œ
                    document.getElementById('worksbyRegistrationModal').style.display = 'flex';
                }
            }, 100);
        }
        
        // í”„ë¡œì íŠ¸ ë°ì´í„° ìƒì„± ê³µí†µ í•¨ìˆ˜
        function createProjectData(projectTitle, selectedFile, selectedFiles, selectedFileIds) {
            // ì‹œë‚˜ë¦¬ì˜¤ êµ¬ë¶„ (ì €ì¥ëœ ì •ë³´ ê¸°ì¤€) - ì‹œë‚˜ë¦¬ì˜¤ 1,2ë§Œ ì‚¬ìš©
            let scenarioType;
            const hasSplitFiles = selectedFiles.some(file => 
                file.row && file.row.classList.contains('tree-parent')
            );
            
            if (hasSplitFiles) {
                scenarioType = 1; // ì‹œë‚˜ë¦¬ì˜¤ 1: ë¶„í• ëœ íŒŒì¼
            } else {
                scenarioType = 2; // ì‹œë‚˜ë¦¬ì˜¤ 2: ë‹¨ì¼ íŒŒì¼
            }
            
            return {
                projectNo: 'PJ' + new Date().toISOString().slice(0, 10).replace(/-/g, '') + Math.floor(Math.random() * 1000).toString().padStart(3, '0'),
                title: projectTitle,
                service: 'ì†Œë¦¬ë°”ë¡œ',
                fileName: selectedFile.fileName,
                projectTitle: selectedFile.projectTitle,
                scenarioType: scenarioType,
                selectedFiles: selectedFileIds,
                selectedFilesData: selectedFiles,
                startDate: document.getElementById('recruitStartDate')?.value || '',
                endDate: document.getElementById('recruitEndDate')?.value || '',
                workStartDate: document.getElementById('workStartDate')?.value || '',
                workEndDate: document.getElementById('workEndDate')?.value || '',
                workerCount: document.querySelector('#worksbyRegistrationModal input[type="number"]')?.value || '5',
                budget: document.querySelector('#worksbyRegistrationModal input[type="number"]:nth-of-type(2)')?.value || '500000',
                qualification: document.querySelector('#worksbyRegistrationModal select')?.value || 'anyone',
                description: document.getElementById('projectDescription')?.value || '',
                regDate: new Date().toISOString().slice(0, 16).replace('T', ' ')
            };
        }
        
        // ë‹¨ì¼ í”„ë¡œì íŠ¸ ìƒì„±
        function createSingleProject(finalProjectName, selectedFile) {
            // í”„ë¡œì íŠ¸ ë°ì´í„° ë¯¸ë¦¬ ìƒì„± (ì €ì¥ëœ ì„ íƒ ì •ë³´ ì‚¬ìš©)
            let projectData;
            try {
                projectData = createProjectData(
                    finalProjectName,
                    selectedFile,
                    selectedFile.selectedFiles,
                    selectedFile.selectedFileIds
                );
                
                console.log('ë‹¨ì¼ í”„ë¡œì íŠ¸ ë°ì´í„° ìƒì„± ì„±ê³µ:', projectData);
            } catch (error) {
                console.error('í”„ë¡œì íŠ¸ ë°ì´í„° ìƒì„± ì¤‘ ì˜¤ë¥˜:', error);
                alert('í”„ë¡œì íŠ¸ ë°ì´í„° ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                return;
            }
            
            console.log('ëª¨ë‹¬ ë‹«ê¸° ì‹œì‘...');
            
            // ë¨¼ì € ëª¨ë‹¬ ë‹«ê¸°
            document.getElementById('worksbyRegistrationModal').style.display = 'none';
            
            // ëª¨ë‹¬ì´ ì™„ì „íˆ ë‹«íŒ í›„ í™•ì¸ ëŒ€í™”ìƒì í‘œì‹œ
            setTimeout(() => {
                console.log('í™•ì¸ ëŒ€í™”ìƒì í‘œì‹œ ì¤‘...');
                if (confirm(`"${finalProjectName}" í”„ë¡œì íŠ¸ë¡œ "${selectedFile.fileName}" íŒŒì¼ì„ ì›ìŠ¤íŒŒì´ì— ë“±ë¡í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                    console.log('ì‚¬ìš©ìê°€ í™•ì¸ì„ í´ë¦­í–ˆìŠµë‹ˆë‹¤.');
                    
                    console.log('ìƒì„±ëœ í”„ë¡œì íŠ¸ ë°ì´í„°:', projectData);
                    
                    // ì „ì—­ ë³€ìˆ˜ì— ì €ì¥
                    window.currentProjectData = projectData;
                    
                    // í”„ë¡œì íŠ¸ë³„ ë°ì´í„° ì €ì¥ì†Œì— ì €ì¥
                    if (!window.allProjectsData) {
                        window.allProjectsData = {};
                    }
                    window.allProjectsData[projectData.projectNo] = projectData;
                    
                    console.log('ì¶œë°œì–´ ì˜ì—­ ì§ì ‘ ìƒì„± ì‹œì‘...');
                    // ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ì˜ì—­ì„ ê±´ë„ˆë›°ê³  ë°”ë¡œ ì¶œë°œì–´ ì˜ì—­ ìƒì„±
                    createDirectSourceArea(projectData);
                    
                    // ì˜ì—­ë³„ ë²„íŠ¼ ì—…ë°ì´íŠ¸ ì²˜ë¦¬
                    if (selectedFile.fromIntermediateArea === true) {
                        // ì¤‘ê°„ì–´ ì˜ì—­ì—ì„œ í˜¸ì¶œëœ ê²½ìš°
                        updateIntermediateWorksbyButtons(selectedFile.projectTitle);
                    } else if (selectedFile.fromDestinationArea === true) {
                        // ë„ì°©ì–´ ì˜ì—­ì—ì„œ í˜¸ì¶œëœ ê²½ìš°
                        updateDestinationWorksbyButtons(selectedFile.projectTitle, selectedFile.language, selectedFile.langIndex);
                    }
                    
                    console.log('ë“±ë¡ ì™„ë£Œ ì•Œë¦¼ í‘œì‹œ...');
                    alert(`ğŸ‰ ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ë“±ë¡ ì™„ë£Œ!\n\ní”„ë¡œì íŠ¸ëª…: ${finalProjectName}\në“±ë¡ íŒŒì¼: ${selectedFile.fileName}`);
                    
                    console.log('ì„ íƒëœ íŒŒì¼ ì •ë³´ ì´ˆê¸°í™”...');
                    window.selectedFileInfo = null;
                } else {
                    console.log('ì‚¬ìš©ìê°€ ì·¨ì†Œë¥¼ í´ë¦­í–ˆìŠµë‹ˆë‹¤. ëª¨ë‹¬ì„ ë‹¤ì‹œ ì—´ì–´ì¤ë‹ˆë‹¤.');
                    // ì·¨ì†Œí•œ ê²½ìš° ëª¨ë‹¬ì„ ë‹¤ì‹œ ì—´ì–´ì¤Œ
                    document.getElementById('worksbyRegistrationModal').style.display = 'flex';
                }
            }, 100);
        }
        
        // ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ì˜ì—­ ê±´ë„ˆë›°ê³  ë°”ë¡œ ì¶œë°œì–´ ì˜ì—­ ìƒì„±
        function createDirectSourceArea(projectData) {
            console.log('ë°”ë¡œ ì¶œë°œì–´ ì˜ì—­ ìƒì„±:', projectData);
            
            // í”„ë¡œì íŠ¸ë³„ ì¶œë°œì–´ ì˜ì—­ì„ ë°”ë¡œ ìƒì„±
            const projectId = projectData.projectNo;
            
            // ì¶œë°œì–´ ì˜ì—­ ìƒì„±
            let detailArea = document.getElementById(`worksby-detail-area-${projectId}`);
            if (!detailArea) {
                detailArea = document.createElement('div');
                detailArea.id = `worksby-detail-area-${projectId}`;
                detailArea.className = 'worksby-detail-area';
                detailArea.style.cssText = 'display: block; margin-top: 20px;';
                
                // íŒŒì¼ ë¦¬ìŠ¤íŠ¸ ì„¹ì…˜ ë‹¤ìŒì— ë°”ë¡œ ì¶”ê°€
                const fileListSection = document.querySelector('.file-list-section');
                fileListSection.parentNode.insertBefore(detailArea, fileListSection.nextSibling);
            }
            
            // ì‹œë‚˜ë¦¬ì˜¤ë³„ë¡œ ë‹¤ë¥¸ ì¶œë°œì–´ ì˜ì—­ ìƒì„± (ì‹œë‚˜ë¦¬ì˜¤ 1,2ë§Œ ì‚¬ìš©)
            if (projectData.scenarioType === 1) {
                createScenario1SourceArea(projectData, detailArea);
            } else {
                createScenario2SourceArea(projectData, detailArea);
            }
            
            // ì„ íƒëœ íŒŒì¼ë“¤ì˜ ì›ìŠ¤íŒŒì´ ìƒíƒœë¥¼ "ë“±ë¡"ìœ¼ë¡œ ë³€ê²½
            updateWorksbyStatusToRegistered();
            
            // ìƒì„±ëœ ì¶œë°œì–´ ì˜ì—­ìœ¼ë¡œ ìŠ¤í¬ë¡¤
            setTimeout(() => {
                const createdArea = document.getElementById(`worksby-detail-area-${projectId}`);
                if (createdArea) {
                    createdArea.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    console.log('ì¶œë°œì–´ ì˜ì—­ìœ¼ë¡œ ìŠ¤í¬ë¡¤ ì™„ë£Œ');
                }
            }, 500);
            
            console.log('ë°”ë¡œ ì¶œë°œì–´ ì˜ì—­ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }
        
        // ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ í•­ëª© ìƒì„±
        function createWorksbyProjectItem(projectData) {
            console.log('ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ í•­ëª© ìƒì„±:', projectData);
            
            // ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ì„¹ì…˜ì´ ì—†ìœ¼ë©´ ìƒì„±
            let worksbySection = document.getElementById('worksby-projects-section');
            if (!worksbySection) {
                worksbySection = document.createElement('div');
                worksbySection.id = 'worksby-projects-section';
                worksbySection.className = 'file-list-section';
                worksbySection.style.marginTop = '20px';
                
                worksbySection.innerHTML = `
                    <h2 class="section-title">
                        <span>ğŸš€</span>
                        ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸
                    </h2>
                    <div id="worksby-projects-container">
                        <!-- ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ í…Œì´ë¸”ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                `;
                
                // íŒŒì¼ ë¦¬ìŠ¤íŠ¸ ì„¹ì…˜ ë‹¤ìŒì— ì¶”ê°€
                const fileListSection = document.querySelector('.file-list-section');
                fileListSection.parentNode.insertBefore(worksbySection, fileListSection.nextSibling);
            }
            
            // ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ í…Œì´ë¸” ìƒì„±
            const projectsContainer = document.getElementById('worksby-projects-container');
            if (!projectsContainer.querySelector('.worksby-projects-table')) {
                const projectTable = document.createElement('table');
                projectTable.className = 'file-table worksby-projects-table';
                projectTable.style.cssText = 'table-layout: fixed; width: 100%; margin-bottom: 20px;';
                projectTable.innerHTML = `
                    <thead>
                        <tr>
                            <th style="width: 45%;">í”„ë¡œì íŠ¸ëª…</th>
                            <th style="width: 10%;">ì›ë³¸ ì–¸ì–´</th>
                            <th style="width: 20%;">ë„ì°© ì–¸ì–´</th>
                            <th style="width: 10%;">íŒŒì¼ ê¸¸ì´</th>
                            <th style="width: 10%;">ì§„í–‰ìƒíƒœ</th>
                            <th style="width: 5%; text-align: center;">í”„ë¡œì íŠ¸ ì‚­ì œ</th>
                        </tr>
                    </thead>
                    <tbody id="worksby-projects-tbody"></tbody>
                `;
                
                projectsContainer.appendChild(projectTable);
                
                // ìƒì„¸ ì˜ì—­ë„ ìƒì„±
                const detailArea = document.createElement('div');
                detailArea.id = 'worksby-detail-area';
                detailArea.style.cssText = 'display: none; margin-top: 20px;';
                projectsContainer.appendChild(detailArea);
            }
            
            // í”„ë¡œì íŠ¸ í–‰ ì¶”ê°€
            const projectsTbody = document.getElementById('worksby-projects-tbody');
            const projectRow = document.createElement('tr');
            projectRow.className = 'template-row';
            projectRow.setAttribute('data-project-title', projectData.title);
            projectRow.style.cursor = 'pointer';
            projectRow.onclick = () => selectWorksbyProject(projectData);
            
            projectRow.innerHTML = `
                <td style="font-weight: 600; color: #3b82f6; padding-left: 16px;">ğŸ“ ${projectData.title}</td>
                <td style="text-align: center;">í•œê¸€</td>
                <td style="text-align: center;">ì˜ì–´, ì¼ë³¸ì–´, ì¤‘êµ­ì–´(ê°„ì²´)</td>
                <td style="text-align: center;">${getSelectedFilesTotalDuration()}</td>
                <td style="text-align: center;">
                    <span class="status-badge" style="background: #e5e7eb; color: #374151; padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;">
                        ì§„í–‰ì¤‘
                    </span>
                </td>
                <td style="text-align: center; vertical-align: middle;">
                    <button class="btn" onclick="deleteWorksbyProject('${projectData.projectNo}', event)" 
                            style="background: #ef4444; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; display: inline-block;">
                        ì‚­ì œ
                    </button>
                </td>
            `;
            
            projectsTbody.appendChild(projectRow);
            
            // ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ì„¹ì…˜ í‘œì‹œ
            worksbySection.style.display = 'block';
            
            // ì„ íƒëœ íŒŒì¼ë“¤ì˜ ì›ìŠ¤íŒŒì´ ìƒíƒœë¥¼ "ë“±ë¡"ìœ¼ë¡œ ë³€ê²½
            updateWorksbyStatusToRegistered();
            
            console.log('ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ í•­ëª©ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }
        
        // ì›ìŠ¤íŒŒì´ ìƒíƒœë¥¼ "ë“±ë¡"ìœ¼ë¡œ ë³€ê²½
        function updateWorksbyStatusToRegistered() {
            const checkedBoxes = document.querySelectorAll('.file-select-checkbox:not(:disabled):checked');
            
            checkedBoxes.forEach(checkbox => {
                const row = checkbox.closest('tr');
                const worksbyStatusBadge = row.querySelector('.worksby-status-badge');
                
                if (worksbyStatusBadge) {
                    worksbyStatusBadge.textContent = 'ë“±ë¡';
                    worksbyStatusBadge.style.background = '#dcfce7';
                    worksbyStatusBadge.style.color = '#166534';
                }
                
                // ë¶„í• ëœ íŒŒì¼ë“¤ë„ í•¨ê»˜ ì—…ë°ì´íŠ¸ (tree-parentì¸ ê²½ìš°)
                if (row.classList.contains('tree-parent')) {
                    let nextRow = row.nextElementSibling;
                    while (nextRow && nextRow.classList.contains('tree-child')) {
                        const splitWorksbyBadge = nextRow.querySelector('.worksby-status-badge');
                        if (splitWorksbyBadge) {
                            splitWorksbyBadge.textContent = 'ë“±ë¡';
                            splitWorksbyBadge.style.background = '#dcfce7';
                            splitWorksbyBadge.style.color = '#166534';
                        }
                        nextRow = nextRow.nextElementSibling;
                    }
                }
            });
        }
        
        // ì„ íƒëœ íŒŒì¼ë“¤ì˜ ì´ ê¸¸ì´ ê³„ì‚°
        function getSelectedFilesTotalDuration() {
            const checkedBoxes = document.querySelectorAll('.file-select-checkbox:not(:disabled):checked');
            if (checkedBoxes.length > 0) {
                const firstRow = checkedBoxes[0].closest('tr');
                const duration = firstRow.querySelector('td:nth-child(5)').textContent;
                return duration;
            }
            return '00:00:00';
        }
        
        // ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ì„ íƒ
        function selectWorksbyProject(projectData) {
            console.log('ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ì„ íƒë¨:', projectData);
            
            // ê¸°ì¡´ ì„ íƒ í•´ì œ
            document.querySelectorAll('.template-row').forEach(row => {
                row.style.backgroundColor = '';
                row.style.color = '';
            });
            
            // ì„ íƒëœ í”„ë¡œì íŠ¸ í•˜ì´ë¼ì´íŠ¸
            const selectedRow = document.querySelector(`[data-project-title="${projectData.title}"]`);
            if (selectedRow) {
                selectedRow.style.backgroundColor = '#dbeafe';
                selectedRow.style.color = '#1e40af';
            }
            
            // ëª¨ë“  í”„ë¡œì íŠ¸ ì˜ì—­ ìˆ¨ê¸°ê¸°
            const allProjectAreas = document.querySelectorAll('[id^="worksby-detail-area-"]');
            allProjectAreas.forEach(area => {
                area.style.display = 'none';
            });
            
            // ì„ íƒëœ í”„ë¡œì íŠ¸ì˜ ì˜ì—­ë§Œ í‘œì‹œ
            const projectId = projectData.projectNo;
            const targetArea = document.getElementById(`worksby-detail-area-${projectId}`);
            if (targetArea) {
                targetArea.style.display = 'block';
            } else {
                // ì˜ì—­ì´ ì—†ìœ¼ë©´ ìƒˆë¡œ ìƒì„±
                createProjectSpecificSourceArea(projectData);
            }
        }
        
        // í”„ë¡œì íŠ¸ë³„ ë…ë¦½ì ì¸ ì¶œë°œì–´ ì˜ì—­ ìƒì„±
        function createProjectSpecificSourceArea(projectData) {
            console.log('í”„ë¡œì íŠ¸ë³„ ì¶œë°œì–´ ì˜ì—­ ìƒì„±:', projectData);
            
            // ê¸°ì¡´ ì¶œë°œì–´ ì˜ì—­ë“¤ì„ ëª¨ë‘ ìˆ¨ê¸°ê¸°
            const existingAreas = document.querySelectorAll('[id^="worksby-detail-area"]');
            existingAreas.forEach(area => {
                area.style.display = 'none';
            });
            
            // í”„ë¡œì íŠ¸ë³„ ê³ ìœ  IDë¡œ ìƒˆë¡œìš´ ì¶œë°œì–´ ì˜ì—­ ìƒì„±
            const projectId = projectData.projectNo;
            let detailArea = document.getElementById(`worksby-detail-area-${projectId}`);
            
            if (!detailArea) {
                detailArea = document.createElement('div');
                detailArea.id = `worksby-detail-area-${projectId}`;
                detailArea.className = 'worksby-detail-area';
                detailArea.style.cssText = 'display: block; margin-top: 20px;';
                
                // ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ì„¹ì…˜ ë‹¤ìŒì— ì¶”ê°€
                const worksbySection = document.getElementById('worksby-projects-section');
                worksbySection.parentNode.insertBefore(detailArea, worksbySection.nextSibling);
            }
            
            // ì‹œë‚˜ë¦¬ì˜¤ë³„ë¡œ ë‹¤ë¥¸ ì¶œë°œì–´ ì˜ì—­ ìƒì„± (ì‹œë‚˜ë¦¬ì˜¤ 1,2ë§Œ ì‚¬ìš©)
            if (projectData.scenarioType === 1) {
                // ì‹œë‚˜ë¦¬ì˜¤ 1: ë¶„í• ëœ íŒŒì¼ ê¸°ì¤€
                createScenario1SourceArea(projectData, detailArea);
            } else {
                // ì‹œë‚˜ë¦¬ì˜¤ 2: ë‹¨ì¼ íŒŒì¼ ê¸°ì¤€
                createScenario2SourceArea(projectData, detailArea);
            }
        }
        
        // ì‹œë‚˜ë¦¬ì˜¤ 1: ë¶„í• ëœ íŒŒì¼ ê¸°ì¤€ ì¶œë°œì–´ ì˜ì—­ ìƒì„±
        function createScenario1SourceArea(projectData, detailArea) {
            console.log('ì‹œë‚˜ë¦¬ì˜¤ 1 ì¶œë°œì–´ ì˜ì—­ ìƒì„±:', projectData);
            
            const projectId = projectData.projectNo;
            
            // ì €ì¥ëœ íŒŒì¼ ë°ì´í„° ì‚¬ìš©
            const selectedFiles = [];
            
            if (projectData.selectedFilesData && projectData.selectedFilesData.length > 0) {
                // ì €ì¥ëœ íŒŒì¼ ë°ì´í„° ì‚¬ìš©
                projectData.selectedFilesData.forEach(fileData => {
                    const isTreeParent = fileData.row && fileData.row.classList.contains('tree-parent');
                    
                    // ì›ë³¸ íŒŒì¼ ì¶”ê°€
                    selectedFiles.push({
                        fileName: fileData.fileName,
                        isTreeParent: isTreeParent,
                        isTreeChild: false
                    });
                    
                    // ë¶„í• ëœ íŒŒì¼ë“¤ë„ ì¶”ê°€ (tree-parentì¸ ê²½ìš°)
                    if (isTreeParent) {
                        let nextRow = fileData.row.nextElementSibling;
                        while (nextRow && nextRow.classList.contains('tree-child')) {
                            const splitFileName = nextRow.querySelector('.file-name').textContent;
                            selectedFiles.push({
                                fileName: splitFileName,
                                isTreeParent: false,
                                isTreeChild: true
                            });
                            nextRow = nextRow.nextElementSibling;
                        }
                    }
                });
            } else {
                // í´ë°±: í”„ë¡œì íŠ¸ ë°ì´í„°ì—ì„œ íŒŒì¼ ì •ë³´ ë³µì›
                projectData.selectedFiles.forEach(fileId => {
                    const fileRow = document.querySelector(`[data-file-id="${fileId}"]`);
                    if (fileRow) {
                        const fileName = fileRow.querySelector('.file-name').textContent;
                        
                        // ì›ë³¸ íŒŒì¼ ì¶”ê°€
                        selectedFiles.push({
                            fileName: fileName,
                            isTreeParent: fileRow.classList.contains('tree-parent'),
                            isTreeChild: false
                        });
                        
                        // ë¶„í• ëœ íŒŒì¼ë“¤ë„ ì¶”ê°€ (tree-parentì¸ ê²½ìš°)
                        if (fileRow.classList.contains('tree-parent')) {
                            let nextRow = fileRow.nextElementSibling;
                            while (nextRow && nextRow.classList.contains('tree-child')) {
                                const splitFileName = nextRow.querySelector('.file-name').textContent;
                                selectedFiles.push({
                                    fileName: splitFileName,
                                    isTreeParent: false,
                                    isTreeChild: true
                                });
                                nextRow = nextRow.nextElementSibling;
                            }
                        }
                    }
                });
            }
            
            // ì¶œë°œì–´ ì˜ì—­ ìƒì„± (ì‹œë‚˜ë¦¬ì˜¤ 1ìš© ê³ ìœ  ID ì ìš©)
            detailArea.innerHTML = `
                <div class="work-area-container">
                    <div class="work-area-header">
                        <h2 class="work-area-title">ğŸš€ ì¶œë°œì–´ ì˜ì—­ - ${projectData.title} (ì‹œë‚˜ë¦¬ì˜¤ 1)</h2>
                    </div>
                    <div class="work-area-content">
                        <div style="background: #f8f9fa; padding: 15px 20px; border-bottom: 1px solid #e5e7eb;">
                            <h3 style="margin: 0; font-size: 16px; font-weight: 600; color: #3b82f6;">ğŸ“ ì¶œë°œì–´ ì˜ì—­</h3>
                        </div>
                        <table class="file-table" style="table-layout: fixed; width: 100%; margin-bottom: 0;">
                            <thead>
                                <tr>
                                    <th style="width: 16%;">í”„ë¡œì íŠ¸ëª…</th>
                                    <th style="width: 26%;">íŒŒì¼ ì´ë¦„</th>
                                    <th style="width: 5%;">ì¶œë°œì–´</th>
                                    <th style="width: 7%;">ì‘ì—… ì‹œê°„</th>
                                    <th style="width: 7%; text-align: center;">ì›ìŠ¤íŒŒì´ ë“±ë¡</th>
                                    <th style="width: 10%; text-align: center;">ì‘ì—…ì(ìƒíƒœ)</th>
                                    <th style="width: 7%; text-align: center;">ì‘ì—…ì ë°°ì •</th>
                                    <th style="width: 10%; text-align: center;">ì „ì‚¬íˆ´</th>
                                    <th style="width: 7%; text-align: center;">ì‚°ì¶œë¬¼</th>
                                    <th style="width: 5%; text-align: center;">ì§„í–‰ìƒíƒœ</th>
                                </tr>
                            </thead>
                            <tbody id="detail-tbody-${projectId}">
                                <!-- íŒŒì¼ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            // íŒŒì¼ë“¤ì„ ë™ì ìœ¼ë¡œ ì¶”ê°€
            const tbody = document.getElementById(`detail-tbody-${projectId}`);
            if (tbody) {
                selectedFiles.forEach((file, index) => {
                    const row = document.createElement('tr');
                    row.className = file.isTreeParent ? 'tree-parent' : file.isTreeChild ? 'tree-child' : '';
                    
                    // í”„ë¡œì íŠ¸ëª… ì…€
                    const projectCell = document.createElement('td');
                    projectCell.style.textAlign = 'center';
                    projectCell.textContent = projectData.title;
                    
                    // íŒŒì¼ëª… ì…€
                    const fileNameCell = document.createElement('td');
                    fileNameCell.className = 'file-name';
                    fileNameCell.textContent = file.fileName;
                    
                    // ì¶œë°œì–´ ì…€
                    const sourceCell = document.createElement('td');
                    sourceCell.style.textAlign = 'center';
                    sourceCell.textContent = 'í•œê¸€';
                    
                    // ì‘ì—… ì‹œê°„ ì…€
                    const timeCell = document.createElement('td');
                    timeCell.style.textAlign = 'center';
                    timeCell.textContent = file.isTreeChild ? '00:00:00 ~ 00:00:00' : '00:45:30';
                    
                    // ì›ìŠ¤íŒŒì´ ë“±ë¡ ì…€
                    const registerCell = document.createElement('td');
                    registerCell.style.textAlign = 'center';
                    if (file.isTreeChild || (index === 0 && !file.isTreeParent)) {
                        registerCell.innerHTML = `<button class="btn btn-success" onclick="openProjectDetailModal('${file.fileName}', '${projectData.title}')" 
                                                          style="padding: 6px 12px; font-size: 12px; margin: 0 auto; display: inline-block;">
                                                      <span>âœ…</span>
                                                      ë“±ë¡ í™•ì¸
                                                  </button>`;
                    } else {
                        registerCell.innerHTML = `<span style="color: #9ca3af;">-</span>`;
                    }
                    
                    // ì‘ì—…ì(ìƒíƒœ) ì…€
                    const workerStatusCell = document.createElement('td');
                    workerStatusCell.style.textAlign = 'center';
                    workerStatusCell.style.fontSize = '12px';
                    workerStatusCell.style.color = '#6b7280';
                    workerStatusCell.textContent = file.isTreeParent ? '-' : '- (ëŒ€ê¸°)';
                    
                    // ì‘ì—…ì ë°°ì • ì…€
                    const assignCell = document.createElement('td');
                    assignCell.style.textAlign = 'center';
                    if (file.isTreeParent) {
                        assignCell.innerHTML = `<span style="color: #9ca3af;">-</span>`;
                    } else if (file.isTreeChild) {
                        assignCell.innerHTML = `<button class="btn" onclick="assignNewWorker('${file.fileName}', '${projectData.title}')" 
                                                      style="background: #8b5cf6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">
                                                  ì‘ì—…ì ë°°ì •
                                              </button>`;
                    } else if (index === 0) {
                        assignCell.innerHTML = `<button class="btn" onclick="assignNewWorker('${file.fileName}', '${projectData.title}')" 
                                                      style="background: #8b5cf6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">
                                                  ì‘ì—…ì ë°°ì •
                                              </button>`;
                    } else {
                        assignCell.innerHTML = `<span style="color: #9ca3af;">-</span>`;
                    }
                    
                    // ì „ì‚¬íˆ´ ì…€
                    const toolsCell = document.createElement('td');
                    toolsCell.style.textAlign = 'center';
                    if (file.isTreeParent) {
                        toolsCell.innerHTML = `<button class="btn" onclick="mergeFiles('${file.fileName}', '${projectData.title}')" 
                                                      style="background: #f97316; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">
                                                  ê²€ìˆ˜íˆ´ ì‹¤í–‰(íŒŒì¼ í•©ì¹˜ê¸°)
                                              </button>`;
                    } else {
                        toolsCell.innerHTML = `<div style="display: flex; gap: 4px; justify-content: center; flex-wrap: nowrap;">
                                                  <button class="btn" onclick="executeTranscription('${file.fileName}')" 
                                                          style="background: #3b82f6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer;">
                                                      ì „ì‚¬íˆ´ ì‹¤í–‰
                                                  </button>
                                                  <button class="btn" onclick="executeReview('${file.fileName}')" 
                                                          style="background: #10b981; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer;">
                                                      ê²€ìˆ˜íˆ´ ì‹¤í–‰
                                                  </button>
                                              </div>`;
                    }
                    
                    // ì‚°ì¶œë¬¼ ì…€
                    const outputCell = document.createElement('td');
                    outputCell.style.textAlign = 'center';
                    if (file.isTreeParent) {
                        outputCell.innerHTML = `<span style="color: #9ca3af;">-</span>`;
                    } else {
                        outputCell.innerHTML = `<button class="btn" onclick="downloadOutput('${file.fileName}')" 
                                                      style="background: #f59e0b; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">
                                                  ì‚°ì¶œë¬¼ ë‹¤ìš´ë¡œë“œ
                                              </button>`;
                    }
                    
                    // ì§„í–‰ìƒíƒœ ì…€
                    const statusCell = document.createElement('td');
                    statusCell.style.textAlign = 'center';
                    statusCell.innerHTML = `<span class="status-badge" style="background: #e5e7eb; color: #374151; padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;">
                                                ëŒ€ê¸°
                                            </span>`;
                    
                    // ëª¨ë“  ì…€ì„ í–‰ì— ì¶”ê°€
                    row.appendChild(projectCell);
                    row.appendChild(fileNameCell);
                    row.appendChild(sourceCell);
                    row.appendChild(timeCell);
                    row.appendChild(registerCell);
                    row.appendChild(workerStatusCell);
                    row.appendChild(assignCell);
                    row.appendChild(toolsCell);
                    row.appendChild(outputCell);
                    row.appendChild(statusCell);
                    
                    tbody.appendChild(row);
                });
            }
            
            console.log(`ì‹œë‚˜ë¦¬ì˜¤ ${projectData.scenarioType} ì¶œë°œì–´ ì˜ì—­ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        }
        
        // ì‹œë‚˜ë¦¬ì˜¤ 2: ë‹¨ì¼/ë‹¤ì¤‘ íŒŒì¼ ê¸°ì¤€ ì¶œë°œì–´ ì˜ì—­ ìƒì„±
        function createScenario2SourceArea(projectData, detailArea) {
            console.log('ì‹œë‚˜ë¦¬ì˜¤ 2 ì¶œë°œì–´ ì˜ì—­ ìƒì„±:', projectData);
            
            const projectId = projectData.projectNo;
            
            // ì €ì¥ëœ íŒŒì¼ ë°ì´í„° ì‚¬ìš©
            const selectedFiles = [];
            
            if (projectData.selectedFilesData && projectData.selectedFilesData.length > 0) {
                // ì €ì¥ëœ íŒŒì¼ ë°ì´í„° ì‚¬ìš©
                projectData.selectedFilesData.forEach(fileData => {
                    selectedFiles.push({
                        fileName: fileData.fileName,
                        isTreeParent: false,
                        isTreeChild: false
                    });
                });
            } else {
                // í´ë°±: í”„ë¡œì íŠ¸ ë°ì´í„°ì—ì„œ íŒŒì¼ ì •ë³´ ë³µì›
                projectData.selectedFiles.forEach(fileId => {
                    const fileRow = document.querySelector(`[data-file-id="${fileId}"]`);
                    if (fileRow) {
                        const fileName = fileRow.querySelector('.file-name').textContent;
                        
                        selectedFiles.push({
                            fileName: fileName,
                            isTreeParent: false,
                            isTreeChild: false
                        });
                    }
                });
            }
            
            // ì¶œë°œì–´ ì˜ì—­ ìƒì„± (ì‹œë‚˜ë¦¬ì˜¤ 2: ë‹¨ì¼/ë‹¤ì¤‘ íŒŒì¼, ì‘ì—…ì ë°°ì • ë²„íŠ¼ í‘œì‹œ)
            detailArea.innerHTML = `
                <div class="work-area-container">
                    <div class="work-area-header">
                        <h2 class="work-area-title">ğŸš€ ì¶œë°œì–´ ì˜ì—­ - ${projectData.title}</h2>
                    </div>
                    <div class="work-area-content">
                        <div style="background: #f8f9fa; padding: 15px 20px; border-bottom: 1px solid #e5e7eb;">
                            <h3 style="margin: 0; font-size: 16px; font-weight: 600; color: #3b82f6;">ğŸ“ ì¶œë°œì–´ ì˜ì—­</h3>
                        </div>
                        <table class="file-table" style="table-layout: fixed; width: 100%; margin-bottom: 0;">
                            <thead>
                                <tr>
                                    <th style="width: 16%;">í”„ë¡œì íŠ¸ëª…</th>
                                    <th style="width: 26%;">íŒŒì¼ ì´ë¦„</th>
                                    <th style="width: 5%;">ì¶œë°œì–´</th>
                                    <th style="width: 7%;">ì‘ì—… ì‹œê°„</th>
                                    <th style="width: 7%; text-align: center;">ì›ìŠ¤íŒŒì´ ë“±ë¡</th>
                                    <th style="width: 10%; text-align: center;">ì‘ì—…ì(ìƒíƒœ)</th>
                                    <th style="width: 7%; text-align: center;">ì‘ì—…ì ë°°ì •</th>
                                    <th style="width: 10%; text-align: center;">ì „ì‚¬íˆ´</th>
                                    <th style="width: 7%; text-align: center;">ì‚°ì¶œë¬¼</th>
                                    <th style="width: 5%; text-align: center;">ì§„í–‰ìƒíƒœ</th>
                                </tr>
                            </thead>
                            <tbody id="detail-tbody-${projectId}">
                                <!-- íŒŒì¼ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            // ì„ íƒëœ íŒŒì¼ë“¤ì„ ë™ì ìœ¼ë¡œ ì¶”ê°€
            const tbody = document.getElementById(`detail-tbody-${projectId}`);
            if (tbody && selectedFiles.length > 0) {
                selectedFiles.forEach((file, index) => {
                    const row = document.createElement('tr');
                
                // í”„ë¡œì íŠ¸ëª… ì…€
                const projectCell = document.createElement('td');
                projectCell.style.textAlign = 'center';
                projectCell.textContent = projectData.title;
                
                // íŒŒì¼ëª… ì…€
                const fileNameCell = document.createElement('td');
                fileNameCell.className = 'file-name';
                fileNameCell.textContent = file.fileName;
                
                // ì¶œë°œì–´ ì…€
                const sourceCell = document.createElement('td');
                sourceCell.style.textAlign = 'center';
                sourceCell.textContent = 'í•œê¸€';
                
                // ì‘ì—… ì‹œê°„ ì…€
                const timeCell = document.createElement('td');
                timeCell.style.textAlign = 'center';
                timeCell.textContent = '00:45:30';
                
                // ì›ìŠ¤íŒŒì´ ë“±ë¡ ì…€
                const registerCell = document.createElement('td');
                registerCell.style.textAlign = 'center';
                registerCell.innerHTML = `<button class="btn btn-success" onclick="openProjectDetailModal('${file.fileName}', '${projectData.title}')" 
                                                  style="padding: 6px 12px; font-size: 12px; margin: 0 auto; display: inline-block;">
                                              <span>âœ…</span>
                                              ë“±ë¡ í™•ì¸
                                          </button>`;
                
                // ì‘ì—…ì(ìƒíƒœ) ì…€
                const workerStatusCell = document.createElement('td');
                workerStatusCell.style.textAlign = 'center';
                workerStatusCell.style.fontSize = '12px';
                workerStatusCell.style.color = '#6b7280';
                workerStatusCell.textContent = '- (ëŒ€ê¸°)';
                
                // ì‘ì—…ì ë°°ì • ì…€ (ì²« ë²ˆì§¸ íŒŒì¼ì—ë§Œ ì‘ì—…ì ë°°ì • ë²„íŠ¼ í‘œì‹œ)
                const assignCell = document.createElement('td');
                assignCell.style.textAlign = 'center';
                if (index === 0) {
                    assignCell.innerHTML = `<button class="btn" onclick="assignNewWorker('${file.fileName}', '${projectData.title}')" 
                                                  style="background: #8b5cf6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">
                                              ì‘ì—…ì ë°°ì •
                                          </button>`;
                } else {
                    assignCell.innerHTML = `<span style="color: #9ca3af;">-</span>`;
                }
                
                // ì „ì‚¬íˆ´ ì…€
                const toolsCell = document.createElement('td');
                toolsCell.style.textAlign = 'center';
                toolsCell.innerHTML = `<div style="display: flex; gap: 4px; justify-content: center; flex-wrap: nowrap;">
                                          <button class="btn" onclick="executeTranscription('${file.fileName}')" 
                                                  style="background: #3b82f6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer;">
                                              ì „ì‚¬íˆ´ ì‹¤í–‰
                                          </button>
                                          <button class="btn" onclick="executeReview('${file.fileName}')" 
                                                  style="background: #10b981; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer;">
                                              ê²€ìˆ˜íˆ´ ì‹¤í–‰
                                          </button>
                                      </div>`;
                
                // ì‚°ì¶œë¬¼ ì…€
                const outputCell = document.createElement('td');
                outputCell.style.textAlign = 'center';
                outputCell.innerHTML = `<button class="btn" onclick="downloadOutput('${file.fileName}')" 
                                              style="background: #f59e0b; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">
                                          ì‚°ì¶œë¬¼ ë‹¤ìš´ë¡œë“œ
                                      </button>`;
                
                // ì§„í–‰ìƒíƒœ ì…€
                const statusCell = document.createElement('td');
                statusCell.style.textAlign = 'center';
                statusCell.innerHTML = `<span class="status-badge" style="background: #e5e7eb; color: #374151; padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;">
                                            ëŒ€ê¸°
                                        </span>`;
                
                // ëª¨ë“  ì…€ì„ í–‰ì— ì¶”ê°€
                row.appendChild(projectCell);
                row.appendChild(fileNameCell);
                row.appendChild(sourceCell);
                row.appendChild(timeCell);
                row.appendChild(registerCell);
                row.appendChild(workerStatusCell);
                row.appendChild(assignCell);
                row.appendChild(toolsCell);
                row.appendChild(outputCell);
                row.appendChild(statusCell);
                
                tbody.appendChild(row);
                });
            }
            
            console.log(`ì‹œë‚˜ë¦¬ì˜¤ 2 ì¶œë°œì–´ ì˜ì—­ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        }
        
        
        // ë¶„í• ëœ íŒŒì¼ ê¸°ì¤€ìœ¼ë¡œ ì¶œë°œì–´ ì˜ì—­ ìƒì„±
        function createSourceAreaWithSplitFiles(projectData) {
            console.log('ë¶„í• ëœ íŒŒì¼ ê¸°ì¤€ ì¶œë°œì–´ ì˜ì—­ ìƒì„±:', projectData);
            
            const detailArea = document.getElementById('worksby-detail-area');
            detailArea.style.display = 'block';
            
            // ì„ íƒëœ íŒŒì¼ì—ì„œ ë¶„í• ëœ íŒŒì¼ë“¤ ìˆ˜ì§‘
            const selectedFiles = [];
            const checkedBoxes = document.querySelectorAll('.file-select-checkbox:not(:disabled):checked');
            
            checkedBoxes.forEach(checkbox => {
                const parentRow = checkbox.closest('tr');
                const fileName = parentRow.querySelector('.file-name').textContent;
                
                // ì›ë³¸ íŒŒì¼ ì¶”ê°€
                selectedFiles.push({
                    fileName: fileName,
                    isTreeParent: parentRow.classList.contains('tree-parent'),
                    isTreeChild: false
                });
                
                // ë¶„í• ëœ íŒŒì¼ë“¤ë„ ì¶”ê°€ (tree-parentì¸ ê²½ìš°)
                if (parentRow.classList.contains('tree-parent')) {
                    let nextRow = parentRow.nextElementSibling;
                    while (nextRow && nextRow.classList.contains('tree-child')) {
                        const splitFileName = nextRow.querySelector('.file-name').textContent;
                        selectedFiles.push({
                            fileName: splitFileName,
                            isTreeParent: false,
                            isTreeChild: true
                        });
                        nextRow = nextRow.nextElementSibling;
                    }
                }
            });
            
            // ì¶œë°œì–´ ì˜ì—­ ìƒì„±
            detailArea.innerHTML = `
                <div class="work-area-container">
                    <div class="work-area-header">
                        <h2 class="work-area-title">ğŸš€ ì¶œë°œì–´ ì˜ì—­</h2>
                    </div>
                    <div class="work-area-content">
                        <div style="background: #f8f9fa; padding: 15px 20px; border-bottom: 1px solid #e5e7eb;">
                            <h3 style="margin: 0; font-size: 16px; font-weight: 600; color: #3b82f6;">ğŸ“ ì¶œë°œì–´ ì˜ì—­</h3>
                        </div>
                        <table class="file-table" style="table-layout: fixed; width: 100%; margin-bottom: 0;">
                            <thead>
                                <tr>
                                    <th style="width: 16%;">í”„ë¡œì íŠ¸ëª…</th>
                                    <th style="width: 26%;">íŒŒì¼ ì´ë¦„</th>
                                    <th style="width: 5%;">ì¶œë°œì–´</th>
                                    <th style="width: 7%;">ì‘ì—… ì‹œê°„</th>
                                    <th style="width: 7%; text-align: center;">ì›ìŠ¤íŒŒì´ ë“±ë¡</th>
                                    <th style="width: 10%; text-align: center;">ì‘ì—…ì(ìƒíƒœ)</th>
                                    <th style="width: 7%; text-align: center;">ì‘ì—…ì ë°°ì •</th>
                                    <th style="width: 10%; text-align: center;">ì „ì‚¬íˆ´</th>
                                    <th style="width: 7%; text-align: center;">ì‚°ì¶œë¬¼</th>
                                    <th style="width: 5%; text-align: center;">ì§„í–‰ìƒíƒœ</th>
                                </tr>
                            </thead>
                            <tbody id="detail-tbody">
                                ${selectedFiles.map((file, index) => `
                                    <tr class="${file.isTreeParent ? 'tree-parent' : file.isTreeChild ? 'tree-child' : ''}">
                                        <td style="text-align: center;">${projectData.title}</td>
                                        <td class="file-name">${file.fileName}</td>
                                        <td style="text-align: center;">í•œê¸€</td>
                                        <td style="text-align: center;">${file.isTreeChild ? '00:00:00 ~ 00:00:00' : '00:45:30'}</td>
                                        <td style="text-align: center;">
                                            ${file.isTreeChild || (index === 0 && !file.isTreeParent)
                                                ? `<button class="btn btn-success" onclick="openProjectDetailModal('${file.fileName}', '${projectData.title}')" 
                                                          style="padding: 6px 12px; font-size: 12px; margin: 0 auto; display: inline-block;">
                                                      <span>âœ…</span>
                                                      ë“±ë¡ í™•ì¸
                                                  </button>`
                                                : `<span style="color: #9ca3af;">-</span>`
                                            }
                                        </td>
                                        <td style="text-align: center; font-size: 12px; color: #6b7280;">
                                            ${file.isTreeParent ? '-' : '- (ëŒ€ê¸°)'}
                                        </td>
                                        <td style="text-align: center;">
                                            ${file.isTreeParent 
                                                ? `<span style="color: #9ca3af;">-</span>`
                                                : file.isTreeChild
                                                    ? `<button class="btn" onclick="assignNewWorker('${file.fileName}', '${projectData.title}')" 
                                                              style="background: #8b5cf6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">
                                                          ì‘ì—…ì ë°°ì •
                                                      </button>`
                                                    : (index === 0)
                                                        ? `<button class="btn" onclick="assignNewWorker('${file.fileName}', '${projectData.title}')" 
                                                                  style="background: #8b5cf6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">
                                                              ì‘ì—…ì ë°°ì •
                                                          </button>`
                                                        : `<span style="color: #9ca3af;">-</span>`
                                            }
                                        </td>
                                        <td style="text-align: center;">
                                            ${file.isTreeParent 
                                                ? `<button class="btn" onclick="mergeFiles('${file.fileName}', '${projectData.title}')" 
                                                          style="background: #f97316; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">
                                                      ê²€ìˆ˜íˆ´ ì‹¤í–‰(íŒŒì¼ í•©ì¹˜ê¸°)
                                                  </button>`
                                                : `<div style="display: flex; gap: 4px; justify-content: center; flex-wrap: nowrap;">
                                                      <button class="btn" onclick="executeTranscription('${file.fileName}')" 
                                                              style="background: #3b82f6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer;">
                                                          ì „ì‚¬íˆ´ ì‹¤í–‰
                                                      </button>
                                                      <button class="btn" onclick="executeReview('${file.fileName}')" 
                                                              style="background: #10b981; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer;">
                                                          ê²€ìˆ˜íˆ´ ì‹¤í–‰
                                                      </button>
                                                  </div>`
                                            }
                                        </td>
                                        <td style="text-align: center;">
                                            ${file.isTreeParent 
                                                ? `<span style="color: #9ca3af;">-</span>`
                                                : `<button class="btn" onclick="downloadOutput('${file.fileName}')" 
                                                          style="background: #f59e0b; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">
                                                      ì‚°ì¶œë¬¼ ë‹¤ìš´ë¡œë“œ
                                                  </button>`
                                            }
                                        </td>
                                        <td style="text-align: center;">
                                            <span class="status-badge" style="background: #e5e7eb; color: #374151; padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;">
                                                ëŒ€ê¸°
                                            </span>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            console.log('ì¶œë°œì–´ ì˜ì—­ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }
        
        // ì›ìŠ¤íŒŒì´ ë²„íŠ¼ ì—…ë°ì´íŠ¸ (ì¶œë°œì–´ ì˜ì—­ + ì¤‘ê°„ì–´ ì˜ì—­ + ë„ì°©ì–´ ì˜ì—­)
        function updateWorksbyButton(fileName, projectTitle) {
            console.log('updateWorksbyButton í˜¸ì¶œë¨:', fileName, projectTitle);
            
            let buttonFound = false;
            
            // 1. ì¶œë°œì–´ ì˜ì—­ì—ì„œ ë²„íŠ¼ ì°¾ê¸°
            const detailTbody = document.getElementById('detail-tbody');
            if (detailTbody) {
                buttonFound = updateButtonInArea(detailTbody, fileName, projectTitle, 'ì¶œë°œì–´ ì˜ì—­') || buttonFound;
            }
            
            // 2. ì¤‘ê°„ì–´ ì˜ì—­ì—ì„œ ë²„íŠ¼ ì°¾ê¸°
            const intermediateTbody = document.getElementById('intermediate-tbody');
            if (intermediateTbody) {
                buttonFound = updateButtonInArea(intermediateTbody, fileName, projectTitle, 'ì¤‘ê°„ì–´ ì˜ì—­') || buttonFound;
            }
            
            // 3. ë„ì°©ì–´ ì˜ì—­ì—ì„œ ë²„íŠ¼ ì°¾ê¸° (ëª¨ë“  ì–¸ì–´ë³„ ì˜ì—­)
            for (let i = 0; i < 3; i++) {
                const destinationTbody = document.getElementById(`destination-tbody-${i}`);
                if (destinationTbody) {
                    buttonFound = updateButtonInArea(destinationTbody, fileName, projectTitle, 'ë„ì°©ì–´ ì˜ì—­') || buttonFound;
                }
            }
            
            if (!buttonFound) {
                console.log('ë²„íŠ¼ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. íŒŒì¼ëª…ê³¼ í”„ë¡œì íŠ¸ ì œëª©ì„ í™•ì¸í•˜ì„¸ìš”.');
            }
        }
        
        // íŠ¹ì • ì˜ì—­ì—ì„œ ë²„íŠ¼ ì—…ë°ì´íŠ¸ í—¬í¼ í•¨ìˆ˜
        function updateButtonInArea(tbody, fileName, projectTitle, areaName) {
            console.log(`=== ${areaName}ì—ì„œ ë²„íŠ¼ ì°¾ê¸° ì‹œì‘ ===`);
            console.log(`ì°¾ëŠ” íŒŒì¼ëª…: "${fileName}"`);
            
            const rows = tbody.querySelectorAll('tr');
            console.log(`${areaName} íŒŒì¼ í–‰ ìˆ˜:`, rows.length);
            
            let buttonFound = false;
            
            rows.forEach((row, rowIndex) => {
                const fileNameCell = row.querySelector('.file-name');
                if (fileNameCell) {
                    const currentFileName = fileNameCell.textContent.replace('â†’ ', '').trim();
                    console.log(`${areaName} í–‰ ${rowIndex + 1} íŒŒì¼ëª…: "${currentFileName}"`);
                    console.log(`íŒŒì¼ëª… ë¹„êµ: "${currentFileName}" === "${fileName}" ?`, currentFileName === fileName);
                    
                    if (currentFileName === fileName) {
                        console.log(`${areaName}ì—ì„œ ì¼ì¹˜í•˜ëŠ” íŒŒì¼ ì°¾ìŒ!`);
                        
                        // ëª¨ë“  ì»¬ëŸ¼ í™•ì¸
                        const allCells = row.querySelectorAll('td');
                        console.log(`${areaName} ì „ì²´ ì»¬ëŸ¼ ìˆ˜:`, allCells.length);
                        
                        // ì›ìŠ¤íŒŒì´ ë“±ë¡ ì»¬ëŸ¼ ìœ„ì¹˜ ê²°ì •
                        let registerColumnIndex;
                        if (areaName === 'ì¶œë°œì–´ ì˜ì—­') {
                            registerColumnIndex = 4; // ì¶œë°œì–´ ì˜ì—­: 4ë²ˆì§¸
                        } else if (areaName === 'ì¤‘ê°„ì–´ ì˜ì—­' || areaName === 'ë„ì°©ì–´ ì˜ì—­') {
                            registerColumnIndex = 5; // ì¤‘ê°„ì–´/ë„ì°©ì–´ ì˜ì—­: 5ë²ˆì§¸
                        }
                        const registerCell = row.querySelector(`td:nth-child(${registerColumnIndex})`);
                        console.log(`${areaName} ì›ìŠ¤íŒŒì´ ë“±ë¡ ì…€ (${registerColumnIndex}ë²ˆì§¸):`, registerCell);
                        
                        const button = registerCell ? registerCell.querySelector('button') : null;
                        console.log(`${areaName} ì›ìŠ¤íŒŒì´ ë“±ë¡ ë²„íŠ¼:`, button);
                        
                        if (button) {
                            console.log(`${areaName}ì—ì„œ ë²„íŠ¼ ì°¾ìŒ! ì—…ë°ì´íŠ¸ ì¤‘...`);
                            button.innerHTML = '<span>âœ…</span>ë“±ë¡ í™•ì¸';
                            button.onclick = () => openProjectDetailModal(fileName, projectTitle);
                            button.style.background = '#10b981';
                            button.className = 'btn btn-success';
                            buttonFound = true;
                            console.log(`${areaName} ë²„íŠ¼ ì—…ë°ì´íŠ¸ ì™„ë£Œ!`);
                        } else {
                            console.log(`${areaName}ì—ì„œ ì›ìŠ¤íŒŒì´ ë“±ë¡ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ`);
                            if (registerCell) {
                                console.log(`${areaName} ì›ìŠ¤íŒŒì´ ë“±ë¡ ì…€ ë‚´ìš©:`, registerCell.innerHTML);
                            }
                        }
                    }
                }
            });
            
            console.log(`=== ${areaName} ë²„íŠ¼ ì°¾ê¸° ì™„ë£Œ: ${buttonFound} ===`);
            return buttonFound;
        }
        
        // í”„ë¡œì íŠ¸ ìƒì„¸ì •ë³´ ëª¨ë‹¬ ì—´ê¸°
        function openProjectDetailModal(fileName, projectTitle) {
            console.log('openProjectDetailModal í˜¸ì¶œë¨:', fileName, projectTitle);
            
            const projectData = window.currentProjectData;
            if (!projectData) {
                alert('í”„ë¡œì íŠ¸ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            console.log('í”„ë¡œì íŠ¸ ë°ì´í„°:', projectData);
            
            // ëª¨ë‹¬ í‘œì‹œ
            document.getElementById('projectDetailModal').style.display = 'flex';
            
            // í”„ë¡œì íŠ¸ ì •ë³´ íƒ­ì„ ê¸°ë³¸ìœ¼ë¡œ í™œì„±í™”
            showDetailTab('info');
            
            // í”„ë¡œì íŠ¸ ì •ë³´ ì„¤ì •
            document.getElementById('detailNo').textContent = projectData.projectNo;
            document.getElementById('detailService').textContent = projectData.service;
            document.getElementById('detailRegDate').textContent = projectData.regDate.replace('T', ' ');
            document.getElementById('detailTitle').textContent = projectData.title;
            document.getElementById('detailSelectedFilesBox').textContent = `${fileName} (01:20:15)`;
            
            // ë‚ ì§œ í˜•ì‹ ë³€í™˜ í›„ ì„¤ì •
            const startDateTime = formatDateTime(projectData.startDate);
            const endDateTime = formatDateTime(projectData.endDate);
            const workStartDate = formatDisplayDate(projectData.workStartDate);
            const workEndDate = formatDisplayDate(projectData.workEndDate);
            
            document.getElementById('detailProjectPeriod').textContent = `${startDateTime} ~ ${endDateTime}`;
            document.getElementById('detailWorkPeriod').textContent = `${workStartDate} ~ ${workEndDate}`;
            document.getElementById('detailWorkerCount').textContent = `0 / ${projectData.workerCount}ëª…`;
            document.getElementById('detailBudget').textContent = formatBudget(projectData.budget);
            document.getElementById('detailQualification').textContent = projectData.qualification === 'anyone' ? 'ëˆ„êµ¬ë‚˜' : 'ì†ê¸°ì‚¬';
            document.getElementById('detailContent').innerHTML = projectData.description.replace(/\n/g, '<br>');
            
            console.log('í”„ë¡œì íŠ¸ ìƒì„¸ì •ë³´ ëª¨ë‹¬ ì„¤ì • ì™„ë£Œ');
        }
        
        // í”„ë¡œì íŠ¸ ìƒì„¸ì •ë³´ ëª¨ë‹¬ ë‹«ê¸°
        function closeProjectDetailModal() {
            document.getElementById('projectDetailModal').style.display = 'none';
        }
        
        // ìƒì„¸ ëª¨ë‹¬ íƒ­ ì „í™˜
        function showDetailTab(tabName) {
            // ëª¨ë“  íƒ­ ë²„íŠ¼ ë¹„í™œì„±í™”
            document.querySelectorAll('.detail-tab-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.style.background = '#f8fafc';
                btn.style.color = '#6b7280';
                btn.style.borderBottom = 'none';
            });
            
            // ëª¨ë“  íƒ­ íŒ¨ë„ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.detail-tab-panel').forEach(panel => {
                panel.classList.remove('active');
                panel.style.display = 'none';
            });
            
            // ì„ íƒëœ íƒ­ í™œì„±í™”
            const activeBtn = document.querySelector(`[onclick="showDetailTab('${tabName}')"]`);
            const activePanel = document.getElementById(`detail-tab-${tabName}`);
            
            if (activeBtn && activePanel) {
                activeBtn.classList.add('active');
                activeBtn.style.background = 'white';
                activeBtn.style.color = '#3b82f6';
                activeBtn.style.borderBottom = '3px solid #3b82f6';
                
                activePanel.classList.add('active');
                activePanel.style.display = 'block';
            }
            
            // í•˜ë‹¨ ë²„íŠ¼ í…ìŠ¤íŠ¸ ë° ê¸°ëŠ¥ ë³€ê²½
            const actionBtn = document.querySelector('.btn-edit');
            if (actionBtn) {
                if (tabName === 'info') {
                    actionBtn.textContent = 'ìˆ˜ì •';
                    actionBtn.onclick = editProjectDetail;
                    actionBtn.style.background = '#3b82f6';
                } else if (tabName === 'workers') {
                    actionBtn.textContent = 'í™•ì •';
                    actionBtn.onclick = confirmWorkers;
                    actionBtn.style.background = '#f59e0b';
                }
            }
        }
        
        // ë‚ ì§œ í‘œì‹œ í˜•ì‹ ë³€í™˜
        function formatDisplayDate(dateTimeString) {
            if (!dateTimeString) return '';
            const date = new Date(dateTimeString);
            return date.toISOString().slice(0, 10).replace(/-/g, '.');
        }

        // ë‚ ì§œ+ì‹œê°„ í‘œì‹œ í˜•ì‹ ë³€í™˜ (ì˜ˆ: 2025.09.19 10:00)
        function formatDateTime(dateTimeString) {
            if (!dateTimeString) return '';
            const date = new Date(dateTimeString);
            const yyyy = date.getFullYear();
            const mm = String(date.getMonth() + 1).padStart(2, '0');
            const dd = String(date.getDate()).padStart(2, '0');
            const hh = String(date.getHours()).padStart(2, '0');
            const mi = String(date.getMinutes()).padStart(2, '0');
            return `${yyyy}.${mm}.${dd} ${hh}:${mi}`;
        }

        // ê¸ˆì•¡ í‘œì‹œ í˜•ì‹ ë³€í™˜
        function formatBudget(budget) {
            if (!budget) return '0ì›';
            const number = parseInt(budget.toString().replace(/[^0-9]/g, ''));
            return number.toLocaleString() + 'ì›';
        }
        
        // í”„ë¡œì íŠ¸ ìˆ˜ì • í•¨ìˆ˜
        function editProjectDetail() {
            alert('í”„ë¡œì íŠ¸ ìˆ˜ì • ê¸°ëŠ¥ì€ í–¥í›„ êµ¬í˜„ ì˜ˆì •ì…ë‹ˆë‹¤.');
        }
        
        // í”„ë¡œì íŠ¸ ë§ˆê° í•¨ìˆ˜
        function completeProject() {
            console.log('í”„ë¡œì íŠ¸ ë§ˆê° í•¨ìˆ˜ í˜¸ì¶œë¨');
            
            const projectData = window.currentProjectData;
            if (!projectData) {
                alert('í”„ë¡œì íŠ¸ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            if (confirm(`"${projectData.title}" í”„ë¡œì íŠ¸ë¥¼ ë§ˆê°í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\në§ˆê°ëœ í”„ë¡œì íŠ¸ëŠ” ë” ì´ìƒ ì‘ì—…í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)) {
                // í”„ë¡œì íŠ¸ ìƒíƒœë¥¼ "ì™„ë£Œ"ë¡œ ë³€ê²½
                updateProjectStatus(projectData.projectNo, 'ì™„ë£Œ');
                
                // ëª¨ë‹¬ ë‹«ê¸°
                closeProjectDetailModal();
                
                alert(`"${projectData.title}" í”„ë¡œì íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }
        }
        
        // í”„ë¡œì íŠ¸ ì‚­ì œ í•¨ìˆ˜
        function deleteProject() {
            console.log('í”„ë¡œì íŠ¸ ì‚­ì œ í•¨ìˆ˜ í˜¸ì¶œë¨');
            
            const projectData = window.currentProjectData;
            if (!projectData) {
                alert('í”„ë¡œì íŠ¸ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            if (confirm(`"${projectData.title}" í”„ë¡œì íŠ¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nâš ï¸ ì‚­ì œëœ í”„ë¡œì íŠ¸ëŠ” ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\nëª¨ë“  ì‘ì—… ë°ì´í„°ê°€ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤.`)) {
                // í”„ë¡œì íŠ¸ ì‚­ì œ ì²˜ë¦¬ (ê¸°ì¡´ deleteWorksbyProject í•¨ìˆ˜ ì¬ì‚¬ìš©)
                deleteWorksbyProject(projectData.projectNo, { stopPropagation: () => {} });
                
                // ëª¨ë‹¬ ë‹«ê¸°
                closeProjectDetailModal();
            }
        }
        
        // í”„ë¡œì íŠ¸ ìƒíƒœ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateProjectStatus(projectNo, status) {
            console.log('í”„ë¡œì íŠ¸ ìƒíƒœ ì—…ë°ì´íŠ¸:', projectNo, status);
            
            // ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ í…Œì´ë¸”ì—ì„œ ìƒíƒœ ì—…ë°ì´íŠ¸
            const projectsTbody = document.getElementById('worksby-projects-tbody');
            if (projectsTbody) {
                const projectRows = projectsTbody.querySelectorAll('tr');
                projectRows.forEach(row => {
                    const deleteButton = row.querySelector(`button[onclick*="${projectNo}"]`);
                    if (deleteButton) {
                        // ì§„í–‰ìƒíƒœ ì»¬ëŸ¼ (5ë²ˆì§¸ ì»¬ëŸ¼) ì°¾ê¸°
                        const statusCell = row.querySelector('td:nth-child(5)');
                        if (statusCell) {
                            const statusBadge = statusCell.querySelector('.status-badge');
                            if (statusBadge) {
                                statusBadge.textContent = status;
                                if (status === 'ì™„ë£Œ') {
                                    statusBadge.style.background = '#10b981';
                                    statusBadge.style.color = 'white';
                                } else if (status === 'ì¤‘ë‹¨') {
                                    statusBadge.style.background = '#ef4444';
                                    statusBadge.style.color = 'white';
                                }
                            }
                        }
                        console.log(`í”„ë¡œì íŠ¸ ${projectNo} ìƒíƒœê°€ "${status}"ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                    }
                });
            }
            
            // í”„ë¡œì íŠ¸ ë°ì´í„°ì—ë„ ìƒíƒœ ì €ì¥
            if (window.allProjectsData && window.allProjectsData[projectNo]) {
                window.allProjectsData[projectNo].status = status;
                window.allProjectsData[projectNo].completedDate = new Date().toISOString().slice(0, 16).replace('T', ' ');
            }
        }
        
        // ì‘ì—…ì í™•ì • í•¨ìˆ˜
        function confirmWorkers() {
            const assignedWorkers = document.querySelectorAll('.applicant-status.status-approved');
            if (assignedWorkers.length === 0) {
                alert('ë°°ì •ëœ ì‘ì—…ìê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ë°°ì •ëœ ì‘ì—…ì ì´ë¦„ ìˆ˜ì§‘
            const workerNames = [];
            assignedWorkers.forEach(statusSpan => {
                const row = statusSpan.closest('tr');
                const nameCell = row.querySelector('td:nth-child(2)'); // ì´ë¦„ ì»¬ëŸ¼
                if (nameCell) {
                    workerNames.push(nameCell.textContent.trim());
                }
            });
            
            if (confirm(`${workerNames.length}ëª…ì˜ ì‘ì—…ìë¥¼ í™•ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\ní™•ì • ì‘ì—…ì: ${workerNames.join(', ')}`)) {
                // í˜„ì¬ ì—´ë¦° í”„ë¡œì íŠ¸ì˜ íŒŒì¼ì— ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸
                updateWorkerInfo(workerNames);
                alert(`${workerNames.length}ëª…ì˜ ì‘ì—…ìê°€ í™•ì •ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }
        }
        
        // ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ (ì¶œë°œì–´ ì˜ì—­ + ì¤‘ê°„ì–´ ì˜ì—­ + ë„ì°©ì–´ ì˜ì—­)
        function updateWorkerInfo(workerNames) {
            if (!window.currentProjectData || !window.currentProjectData.fileName || !window.currentProjectData.projectTitle) return;
            
            const fileName = window.currentProjectData.fileName;
            const projectTitle = window.currentProjectData.projectTitle;
            
            // 1. ì¶œë°œì–´ ì˜ì—­ì—ì„œ ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸
            const detailTbody = document.getElementById('detail-tbody');
            if (detailTbody) {
                updateWorkerInArea(detailTbody, fileName, workerNames, 'ì¶œë°œì–´ ì˜ì—­');
            }
            
            // 2. ì¤‘ê°„ì–´ ì˜ì—­ì—ì„œ ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸
            const intermediateTbody = document.getElementById('intermediate-tbody');
            if (intermediateTbody) {
                updateWorkerInArea(intermediateTbody, fileName, workerNames, 'ì¤‘ê°„ì–´ ì˜ì—­');
            }
            
            // 3. ë„ì°©ì–´ ì˜ì—­ì—ì„œ ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸ (ëª¨ë“  ì–¸ì–´ë³„ ì˜ì—­)
            for (let i = 0; i < 3; i++) {
                const destinationTbody = document.getElementById(`destination-tbody-${i}`);
                if (destinationTbody) {
                    updateWorkerInArea(destinationTbody, fileName, workerNames, 'ë„ì°©ì–´ ì˜ì—­');
                }
            }
        }
        
        // íŠ¹ì • ì˜ì—­ì—ì„œ ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸ í—¬í¼ í•¨ìˆ˜
        function updateWorkerInArea(tbody, fileName, workerNames, areaName) {
            console.log(`=== ${areaName}ì—ì„œ ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸ ì‹œì‘ ===`);
            console.log(`ì°¾ëŠ” íŒŒì¼ëª…: "${fileName}"`);
            
            const rows = tbody.querySelectorAll('tr');
            console.log(`${areaName} ì „ì²´ í–‰ ìˆ˜:`, rows.length);
            
            let updateCount = 0;
            
            rows.forEach((row, index) => {
                const fileNameCell = row.querySelector('.file-name');
                if (fileNameCell) {
                    const currentFileName = fileNameCell.textContent.replace('â†’ ', '').replace('[ë¶„í• ë¨]', '').trim();
                    const targetFileName = fileName.replace('[ë¶„í• ë¨]', '').trim();
                    
                    console.log(`${areaName} í–‰ ${index + 1}: "${currentFileName}" vs "${targetFileName}"`);
                    console.log(`ì •í™•í•œ ë§¤ì¹­: ${currentFileName === targetFileName}`);
                    
                    if (currentFileName === targetFileName) {
                        console.log(`${areaName}ì—ì„œ ì¼ì¹˜í•˜ëŠ” íŒŒì¼ ì°¾ìŒ!`);
                        
                        // ì‘ì—…ì(ìƒíƒœ) ì»¬ëŸ¼ ìœ„ì¹˜ ê²°ì •
                        let workerColumnIndex;
                        if (areaName === 'ì¶œë°œì–´ ì˜ì—­') {
                            workerColumnIndex = 5; // ì¶œë°œì–´ ì˜ì—­: 5ë²ˆì§¸
                        } else if (areaName === 'ì¤‘ê°„ì–´ ì˜ì—­' || areaName === 'ë„ì°©ì–´ ì˜ì—­') {
                            workerColumnIndex = 6; // ì¤‘ê°„ì–´/ë„ì°©ì–´ ì˜ì—­: 6ë²ˆì§¸
                        }
                        const workerStatusCell = row.querySelector(`td:nth-child(${workerColumnIndex})`);
                        
                        console.log(`${areaName} ì‘ì—…ì(ìƒíƒœ) ì»¬ëŸ¼ (${workerColumnIndex}ë²ˆì§¸):`, workerStatusCell);
                        
                        if (workerStatusCell) {
                            workerStatusCell.innerHTML = `<span style="color: #374151; font-size: 12px;">${workerNames.join(', ')} (ì‘ì—…ì¤‘)</span>`;
                            updateCount++;
                            console.log(`${areaName} í–‰ ${index + 1} ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸ ì™„ë£Œ!`);
                        }
                    }
                }
            });
            
            console.log(`=== ${areaName} ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸ ì™„ë£Œ: ${updateCount}ê°œ í–‰ ì—…ë°ì´íŠ¸ ===`);
        }
        
        // ì²´í¬ë°•ìŠ¤ ì „ì²´ ì„ íƒ/í•´ì œ
        function toggleAllWorkers(selectAllCheckbox) {
            const checkboxes = document.querySelectorAll('input[name="workerSelect"]');
            checkboxes.forEach(checkbox => {
                checkbox.checked = selectAllCheckbox.checked;
            });
            updateSelectedWorkerCount();
        }
        
        // ì„ íƒëœ ì²´í¬ë°•ìŠ¤ ê°œìˆ˜ ì—…ë°ì´íŠ¸
        function updateSelectedWorkerCount() {
            const checkedBoxes = document.querySelectorAll('input[name="workerSelect"]:checked');
            const countElement = document.getElementById('selectedWorkerCount');
            if (countElement) {
                countElement.textContent = checkedBoxes.length;
            }
        }
        
        // ê°œë³„ ì²´í¬ë°•ìŠ¤ í´ë¦­ ì‹œ ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
        document.addEventListener('change', function(e) {
            if (e.target.name === 'workerSelect') {
                updateSelectedWorkerCount();
            }
        });
        
        // ì‘ì—…ì ê´€ë¦¬ ëª¨ë‹¬ ë‹«ê¸°
        function closeWorkerManagementModal() {
            document.getElementById('workerManagementModal').style.display = 'none';
        }
        
        // ì‘ì—…ì ê´€ë¦¬ ëª¨ë‹¬ì—ì„œ ì‘ì—…ì í™•ì •
        function confirmWorkersModal() {
            const assignedWorkers = document.querySelectorAll('#workersListModal .applicant-status.status-approved');
            if (assignedWorkers.length === 0) {
                alert('ë°°ì •ëœ ì‘ì—…ìê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ë°°ì •ëœ ì‘ì—…ì ì´ë¦„ ìˆ˜ì§‘
            const workerNames = [];
            assignedWorkers.forEach(statusSpan => {
                const row = statusSpan.closest('tr');
                const nameCell = row.querySelector('td:nth-child(2)'); // ì´ë¦„ ì»¬ëŸ¼
                if (nameCell) {
                    workerNames.push(nameCell.textContent.trim());
                }
            });
            
            if (confirm(`${workerNames.length}ëª…ì˜ ì‘ì—…ìë¥¼ í™•ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\ní™•ì • ì‘ì—…ì: ${workerNames.join(', ')}`)) {
                // í˜„ì¬ ì„ íƒëœ íŒŒì¼ì— ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸
                updateWorkerInfoFromModal(workerNames);
                closeWorkerManagementModal();
                alert(`${workerNames.length}ëª…ì˜ ì‘ì—…ìê°€ í™•ì •ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }
        }
        
        // ì‘ì—…ì ê´€ë¦¬ ëª¨ë‹¬ì—ì„œ ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸
        function updateWorkerInfoFromModal(workerNames) {
            const selectedFile = window.selectedFileInfo;
            if (!selectedFile) return;
            
            const fileName = selectedFile.fileName;
            const projectTitle = selectedFile.projectTitle;
            
            // ëª¨ë“  ì˜ì—­ì—ì„œ í•´ë‹¹ íŒŒì¼ì˜ ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸
            updateWorkerInAllAreas(fileName, workerNames);
        }
        
        // íŒŒì¼ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì‘ì—…ì ì¼ê´„ ë°°ì • ëª¨ë‹¬ ì—´ê¸°
        function openBatchWorkerAssignmentModal() {
            console.log('íŒŒì¼ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì‘ì—…ì ì¼ê´„ ë°°ì • ëª¨ë‹¬ ì—´ê¸°');
            
            // 1ìˆœìœ„: ë°°ê²½ìƒ‰ìœ¼ë¡œ ì„ íƒëœ íŒŒì¼ ì°¾ê¸°
            const selectedRow = document.querySelector('.file-table tbody tr.selected-file-row');
            
            if (selectedRow) {
                // ë°°ê²½ìƒ‰ìœ¼ë¡œ ì„ íƒëœ íŒŒì¼ì´ ìˆëŠ” ê²½ìš°
                const fileName = selectedRow.querySelector('.file-name').textContent;
                const fileId = selectedRow.getAttribute('data-file-id');
                
                // ì„ íƒëœ íŒŒì¼ ì •ë³´ ì €ì¥ (ì¼ê´„ ë°°ì •ìš©)
                window.batchAssignmentFileInfo = {
                    fileName: fileName,
                    fileId: fileId,
                    fromFileList: true
                };
                
                console.log('ë°°ê²½ìƒ‰ ì„ íƒëœ íŒŒì¼ë¡œ ì¼ê´„ ë°°ì •:', window.batchAssignmentFileInfo);
                
                // ì‘ì—…ì ìˆ˜ë™ ë°°ì • ëª¨ë‹¬ ì—´ê¸°
                openManualWorkerAssignmentModal();
                return;
            }
            
            // 2ìˆœìœ„: ì²´í¬ëœ íŒŒì¼ë“¤ ì°¾ê¸°
            const checkedBoxes = document.querySelectorAll('.file-select-checkbox:not(:disabled):checked');
            
            if (checkedBoxes.length === 0) {
                alert('ì‘ì—…ìë¥¼ ë°°ì •í•  íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.\n(íŒŒì¼ í–‰ì„ í´ë¦­í•˜ê±°ë‚˜ ì²´í¬ë°•ìŠ¤ë¥¼ ì²´í¬í•´ì£¼ì„¸ìš”)');
                return;
            }
            
            if (checkedBoxes.length > 1) {
                alert('ì‘ì—…ì ì¼ê´„ ë°°ì •ì€ í•œ ë²ˆì— í•˜ë‚˜ì˜ íŒŒì¼ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.\ní•˜ë‚˜ì˜ íŒŒì¼ë§Œ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì²´í¬ëœ íŒŒì¼ ì •ë³´
            const checkbox = checkedBoxes[0];
            const row = checkbox.closest('tr');
            const fileName = row.querySelector('.file-name').textContent;
            const fileId = checkbox.value;
            
            // ì„ íƒëœ íŒŒì¼ ì •ë³´ ì €ì¥ (ì¼ê´„ ë°°ì •ìš©)
            window.batchAssignmentFileInfo = {
                fileName: fileName,
                fileId: fileId,
                fromFileList: true
            };
            
            console.log('ì²´í¬ëœ íŒŒì¼ë¡œ ì¼ê´„ ë°°ì •:', window.batchAssignmentFileInfo);
            
            // ì‘ì—…ì ìˆ˜ë™ ë°°ì • ëª¨ë‹¬ ì—´ê¸°
            openManualWorkerAssignmentModal();
        }
        
        // ì‘ì—…ì ìˆ˜ë™ ë°°ì • ëª¨ë‹¬ ì—´ê¸°
        function openManualWorkerAssignmentModal() {
            console.log('ì‘ì—…ì ìˆ˜ë™ ë°°ì • ëª¨ë‹¬ ì—´ê¸°');
            
            // ê²€ìƒ‰ ì´ˆê¸°í™”
            document.getElementById('searchInput').value = '';
            document.getElementById('searchOption').value = 'name';
            document.getElementById('searchResultCount').textContent = '0';
            
            // ê²€ìƒ‰ ê²°ê³¼ ì´ˆê¸°í™”
            const searchResults = document.getElementById('searchResults');
            searchResults.innerHTML = `
                <div id="noSearchResults" style="padding: 60px 20px; text-align: center; color: #9ca3af; font-size: 14px;">
                    ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ê³  ê²€ìƒ‰ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”
                </div>
            `;
            
            // ë°°ì • ë²„íŠ¼ ë¹„í™œì„±í™”
            const assignBtn = document.getElementById('assignSelectedWorkerBtn');
            if (assignBtn) {
                assignBtn.disabled = true;
                assignBtn.style.opacity = '0.5';
            }
            
            document.getElementById('manualWorkerAssignmentModal').style.display = 'flex';
        }
        
        // ì‘ì—…ì ìˆ˜ë™ ë°°ì • ëª¨ë‹¬ ë‹«ê¸°
        function closeManualWorkerAssignmentModal() {
            document.getElementById('manualWorkerAssignmentModal').style.display = 'none';
        }
        
        // ê²€ìƒ‰ í‚¤ ì…ë ¥ ì²˜ë¦¬
        function handleSearchKeypress(event) {
            if (event.key === 'Enter') {
                event.preventDefault();
                searchWorkers();
            }
        }
        
        // ì‘ì—…ì ê²€ìƒ‰ í•¨ìˆ˜
        function searchWorkers() {
            const searchOption = document.getElementById('searchOption').value;
            const searchInput = document.getElementById('searchInput').value.trim();
            
            if (!searchInput) {
                alert('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            console.log('ì‘ì—…ì ê²€ìƒ‰:', searchOption, searchInput);
            
            // ì‹œë‚˜ë¦¬ì˜¤: "ì°¨ì •í›ˆ" ê²€ìƒ‰ ì‹œ ê²°ê³¼ í‘œì‹œ
            let searchResults = [];
            
            if (searchInput.includes('ì°¨ì •í›ˆ') || searchInput.includes('ì •í›ˆ')) {
                searchResults = [{
                    id: 'worker_001',
                    name: 'ì°¨ì •í›ˆ',
                    email: 'jeonghoon@email.com',
                    phone: '010-1234-5678',
                    address: 'ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬',
                    certificate: '1ê¸‰'
                }];
            }
            
            // ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ
            displaySearchResults(searchResults);
        }
        
        // ê²€ìƒ‰ í”Œë ˆì´ìŠ¤í™€ë” ê´€ë¦¬ í•¨ìˆ˜
        function clearSearchPlaceholder(input) {
            if (input.value === '' || input.value === 'ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”') {
                input.value = '';
                input.style.color = '#374151';
            }
        }
        
        function restoreSearchPlaceholder(input) {
            if (input.value === '') {
                input.placeholder = 'ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”';
                input.style.color = '#9ca3af';
            }
        }
        
        // ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜ (ì‹¬í”Œí•œ ë””ìì¸)
        function displaySearchResults(results) {
            const searchResultsContainer = document.getElementById('searchResults');
            const searchResultCount = document.getElementById('searchResultCount');
            
            searchResultCount.textContent = results.length;
            
            if (results.length === 0) {
                searchResultsContainer.innerHTML = `
                    <div style="padding: 60px 20px; text-align: center; color: #9ca3af; font-size: 14px;">
                        ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤
                    </div>
                `;
                return;
            }
            
            // ê²€ìƒ‰ ê²°ê³¼ HTML ìƒì„± (ì‹¬í”Œí•œ ë””ìì¸)
            let resultsHTML = '';
            results.forEach((worker, index) => {
                resultsHTML += `
                    <div class="worker-result-item" style="padding: 16px 20px; border-bottom: ${index < results.length - 1 ? '1px solid #f3f4f6' : 'none'}; cursor: pointer;" 
                         onclick="selectWorkerRadio('${worker.id}')">
                        <div style="display: flex; align-items: flex-start; gap: 12px;">
                            <input type="radio" name="selectedWorker" value="${worker.id}" 
                                   onchange="handleWorkerSelection()" 
                                   style="width: 16px; height: 16px; cursor: pointer; margin-top: 2px;">
                            <div style="flex: 1;">
                                <div style="font-size: 16px; font-weight: 600; color: #374151; margin-bottom: 4px;">
                                    ${worker.name}
                                </div>
                                <div style="font-size: 14px; color: #6b7280; margin-bottom: 2px;">
                                    ${worker.email}
                                </div>
                                <div style="display: flex; gap: 15px; font-size: 14px; color: #6b7280;">
                                    <span>ğŸ“ ${worker.phone}</span>
                                    <span>ğŸ“ ${worker.address}</span>
                                    <span style="background: #f3f4f6; color: #374151; padding: 2px 6px; border-radius: 8px; font-size: 12px;">
                                        ğŸ† ${worker.certificate}ê¸‰
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            searchResultsContainer.innerHTML = resultsHTML;
        }
        
        // ì‘ì—…ì ë¼ë””ì˜¤ ë²„íŠ¼ ì„ íƒ í—¬í¼ í•¨ìˆ˜
        function selectWorkerRadio(workerId) {
            const radio = document.querySelector(`input[name="selectedWorker"][value="${workerId}"]`);
            if (radio) {
                radio.checked = true;
                handleWorkerSelection();
            }
        }
        
        // ì‘ì—…ì ì„ íƒ ì²˜ë¦¬
        function handleWorkerSelection() {
            const selectedRadio = document.querySelector('input[name="selectedWorker"]:checked');
            const assignBtn = document.getElementById('assignSelectedWorkerBtn');
            
            if (selectedRadio && assignBtn) {
                assignBtn.disabled = false;
                assignBtn.style.opacity = '1';
            }
        }
        
        // ì„ íƒí•œ ì‘ì—…ì ë°°ì •
        function assignSelectedWorker() {
            const selectedRadio = document.querySelector('input[name="selectedWorker"]:checked');
            
            if (!selectedRadio) {
                alert('ë°°ì •í•  ì‘ì—…ìë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì„ íƒëœ ì‘ì—…ì ì •ë³´ ì°¾ê¸°
            const workerId = selectedRadio.value;
            const workerItem = selectedRadio.closest('.worker-result-item');
            const workerName = workerItem.querySelector('div[style*="font-weight: 600"]').textContent;
            
            console.log('ì„ íƒëœ ì‘ì—…ì:', workerId, workerName);
            
            // íŒŒì¼ ë¦¬ìŠ¤íŠ¸ì—ì„œ í˜¸ì¶œëœ ê²½ìš°ì™€ ì¶œë°œì–´ ì˜ì—­ì—ì„œ í˜¸ì¶œëœ ê²½ìš° êµ¬ë¶„
            const batchFileInfo = window.batchAssignmentFileInfo;
            const selectedFile = window.selectedFileInfo;
            
            let targetFileName = '';
            let confirmMessage = '';
            
            if (batchFileInfo && batchFileInfo.fromFileList) {
                // íŒŒì¼ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì¼ê´„ ë°°ì • í˜¸ì¶œëœ ê²½ìš°
                targetFileName = batchFileInfo.fileName;
                confirmMessage = `"${workerName}" ì‘ì—…ìë¥¼ "${targetFileName}" íŒŒì¼ì˜ ëª¨ë“  ì‘ì—… ì˜ì—­ì— ì¼ê´„ ë°°ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\në°°ì • ëŒ€ìƒ: ì¶œë°œì–´/ì¤‘ê°„ì–´/ë„ì°©ì–´ ì˜ì—­ ì „ì²´`;
            } else if (selectedFile) {
                // ì¶œë°œì–´ ì˜ì—­ì—ì„œ í˜¸ì¶œëœ ê²½ìš°
                targetFileName = selectedFile.fileName;
                confirmMessage = `"${workerName}" ì‘ì—…ìë¥¼ ë°°ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`;
            } else {
                alert('ë°°ì •í•  íŒŒì¼ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            if (confirm(confirmMessage)) {
                if (batchFileInfo && batchFileInfo.fromFileList) {
                    // íŒŒì¼ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì¼ê´„ ë°°ì •: í•´ë‹¹ íŒŒì¼ì˜ ëª¨ë“  ì˜ì—­ì— ì‘ì—…ì ë°°ì •
                    updateWorkerInAllAreasForFile(targetFileName, [workerName]);
                    
                    // ëª¨ë‹¬ ë‹«ê¸°
                    closeManualWorkerAssignmentModal();
                    
                    // ì¼ê´„ ë°°ì • ì •ë³´ ì´ˆê¸°í™”
                    window.batchAssignmentFileInfo = null;
                    
                    alert(`"${workerName}" ì‘ì—…ìê°€ "${targetFileName}" íŒŒì¼ì˜ ëª¨ë“  ì‘ì—… ì˜ì—­ì— ì¼ê´„ ë°°ì •ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                } else {
                    // ì¶œë°œì–´ ì˜ì—­ì—ì„œ ê°œë³„ ë°°ì •: ê¸°ì¡´ ë¡œì§ ì‚¬ìš©
                    updateWorkerInAllAreas(targetFileName, [workerName]);
                    
                    // ëª¨ë‹¬ë“¤ ë‹«ê¸°
                    closeManualWorkerAssignmentModal();
                    closeWorkerManagementModal();
                    
                    alert(`"${workerName}" ì‘ì—…ìê°€ ì„±ê³µì ìœ¼ë¡œ ë°°ì •ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                }
            }
        }
        
        // íŠ¹ì • íŒŒì¼ì˜ ëª¨ë“  ì˜ì—­ì— ì‘ì—…ì ì¼ê´„ ë°°ì •
        function updateWorkerInAllAreasForFile(fileName, workerNames) {
            console.log(`íŒŒì¼ "${fileName}"ì˜ ëª¨ë“  ì˜ì—­ì— ì‘ì—…ì ì¼ê´„ ë°°ì •:`, workerNames);
            
            // í•´ë‹¹ íŒŒì¼ë¡œ ìƒì„±ëœ ëª¨ë“  í”„ë¡œì íŠ¸ ì°¾ê¸°
            const targetProjects = [];
            if (window.allProjectsData) {
                for (const [projectId, projectData] of Object.entries(window.allProjectsData)) {
                    if (projectData.fileName && projectData.fileName.includes(fileName.replace(/\.[^/.]+$/, ""))) {
                        targetProjects.push(projectId);
                    }
                }
            }
            
            console.log('ì‘ì—…ì ë°°ì • ëŒ€ìƒ í”„ë¡œì íŠ¸ë“¤:', targetProjects);
            
            // ê° í”„ë¡œì íŠ¸ì˜ ëª¨ë“  ì˜ì—­ì— ì‘ì—…ì ë°°ì •
            targetProjects.forEach(projectId => {
                // ì¶œë°œì–´ ì˜ì—­
                const detailTbody = document.getElementById(`detail-tbody-${projectId}`);
                if (detailTbody) {
                    updateWorkerInAllFilesInArea(detailTbody, workerNames, `ì¶œë°œì–´ ì˜ì—­(${projectId})`);
                }
                
                // ì¤‘ê°„ì–´ ì˜ì—­
                const intermediateTbody = document.getElementById(`intermediate-tbody-${projectId}`);
                if (intermediateTbody) {
                    updateWorkerInAllFilesInArea(intermediateTbody, workerNames, `ì¤‘ê°„ì–´ ì˜ì—­(${projectId})`);
                }
                
                // ë„ì°©ì–´ ì˜ì—­ (ëª¨ë“  ì–¸ì–´)
                for (let i = 0; i < 3; i++) {
                    const destinationTbody = document.getElementById(`destination-tbody-${projectId}-${i}`);
                    if (destinationTbody) {
                        const destinationLanguages = ["ì˜ì–´", "ì¼ë³¸ì–´", "ì¤‘êµ­ì–´(ê°„ì²´)"];
                        updateWorkerInAllFilesInArea(destinationTbody, workerNames, `ë„ì°©ì–´ ì˜ì—­(${destinationLanguages[i]}, ${projectId})`);
                    }
                }
            });
            
            console.log(`íŒŒì¼ "${fileName}"ì˜ ëª¨ë“  ì˜ì—­ì— ì‘ì—…ì ì¼ê´„ ë°°ì • ì™„ë£Œ`);
        }
        
        // í•˜ë‹¨ ì˜ì—­ì„ í•­ìƒ ìµœí•˜ë‹¨ìœ¼ë¡œ ì´ë™ì‹œí‚¤ëŠ” í•¨ìˆ˜
        function moveBottomSectionsToEnd() {
            const bottomSectionsContainer = document.getElementById('bottom-sections-container');
            const body = document.querySelector('body');
            
            if (bottomSectionsContainer && body) {
                // í•˜ë‹¨ ì˜ì—­ì„ bodyì˜ ë§ˆì§€ë§‰ ìì‹ìœ¼ë¡œ ì´ë™ (ëª¨ë‹¬ë“¤ ì œì™¸)
                const modals = document.querySelectorAll('.modal-overlay');
                const lastModal = modals[modals.length - 1];
                
                if (lastModal) {
                    // ë§ˆì§€ë§‰ ëª¨ë‹¬ ì•ì— ì‚½ì…
                    body.insertBefore(bottomSectionsContainer, lastModal);
                } else {
                    // ëª¨ë‹¬ì´ ì—†ìœ¼ë©´ body ë§ˆì§€ë§‰ì— ì¶”ê°€
                    body.appendChild(bottomSectionsContainer);
                }
                
                console.log('í•˜ë‹¨ ì˜ì—­ì´ ìµœí•˜ë‹¨ìœ¼ë¡œ ì´ë™ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ í•˜ë‹¨ ì˜ì—­ ìœ„ì¹˜ ì¡°ì •
        document.addEventListener('DOMContentLoaded', function() {
            moveBottomSectionsToEnd();
        });
        
        // ìƒˆë¡œìš´ ì˜ì—­ì´ ìƒì„±ë  ë•Œë§ˆë‹¤ í•˜ë‹¨ ì˜ì—­ì„ ìµœí•˜ë‹¨ìœ¼ë¡œ ì´ë™
        function ensureBottomSectionsAtEnd() {
            setTimeout(moveBottomSectionsToEnd, 100);
        }
        
        // íŒŒì¼ê³µìœ  ê¸°ëŠ¥ë“¤ (trans-detail.htmlì—ì„œ ê°€ì ¸ì˜´)
        function addSharedFile() {
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.multiple = true;
            fileInput.accept = '.hwp,.doc,.docx,.pdf,.txt,.zip';
            fileInput.onchange = function(e) {
                if (e.target.files.length > 0) {
                    const filesList = document.getElementById('shared-files-list');
                    
                    for (let i = 0; i < e.target.files.length; i++) {
                        const fileName = e.target.files[i].name;
                        
                        // ìƒˆ íŒŒì¼ í•­ëª© ìƒì„±
                        const fileItem = document.createElement('div');
                        fileItem.style.cssText = 'display: flex; align-items: center; padding: 6px 0; border-bottom: 1px solid #e5e7eb;';
                        fileItem.innerHTML = `
                            <input type="checkbox" style="margin-right: 18px;">
                            <span style="color: #3b82f6; cursor: pointer; text-decoration: none; font-size: 12px;">${fileName}</span>
                        `;
                        
                        filesList.appendChild(fileItem);
                    }
                    
                    alert(`${e.target.files.length}ê°œì˜ íŒŒì¼ì´ ê³µìœ  ëª©ë¡ì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                }
            }
            fileInput.click();
        }

        function deleteSharedFile() {
            const checkboxes = document.querySelectorAll('#shared-files-list input[type="checkbox"]:checked');
            
            if (checkboxes.length === 0) {
                alert('ì‚­ì œí•  íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (confirm(`ì„ íƒëœ ${checkboxes.length}ê°œì˜ íŒŒì¼ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                checkboxes.forEach(checkbox => {
                    checkbox.parentElement.remove();
                });
                alert(`${checkboxes.length}ê°œì˜ íŒŒì¼ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }
        }

        // ê³ ê° ì„¸ë¶€ ìš”ì²­ì‚¬í•­ ê´€ë ¨ í•¨ìˆ˜ë“¤ (trans-detail.htmlì—ì„œ ê°€ì ¸ì˜´)
        function shareCustomerRequest() {
            const shareBtn = document.getElementById('share-request-btn');
            const currentStatus = shareBtn.getAttribute('data-status');
            
            if (currentStatus === 'idle') {
                // ê³µìœ  ì‹¤í–‰
                const shareText = document.getElementById('customer-request-share').value;
                
                if (!shareText.trim()) {
                    alert('ê³µìœ í•  ìš”ì²­ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                
                // ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” ê³µìœ  API í˜¸ì¶œ
                alert('ê³ ê° ì„¸ë¶€ ìš”ì²­ì‚¬í•­ì´ ì‘ì—…ìì—ê²Œ ê³µìœ ë˜ì—ˆìŠµë‹ˆë‹¤.');
                
                // ë²„íŠ¼ ìƒíƒœë¥¼ "ê³µìœ ì¤‘"ìœ¼ë¡œ ë³€ê²½
                shareBtn.setAttribute('data-status', 'sharing');
                shareBtn.textContent = 'ê³µìœ ì¤‘';
                shareBtn.style.background = '#f59e0b'; // ì£¼í™©ìƒ‰
                
            } else if (currentStatus === 'sharing') {
                // ê³µìœ  ì·¨ì†Œ í™•ì¸
                if (confirm('ê³µìœ ë¥¼ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    // ë²„íŠ¼ ìƒíƒœë¥¼ "ê³µìœ "ë¡œ ë˜ëŒë¦¬ê¸°
                    shareBtn.setAttribute('data-status', 'idle');
                    shareBtn.textContent = 'ê³µìœ ';
                    shareBtn.style.background = '#3b82f6'; // ì›ë˜ íŒŒë€ìƒ‰
                    
                    alert('ê³µìœ ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                }
            }
        }

        // ì‘ì—… íŠ¹ì´ì‚¬í•­ ê¸°ëŠ¥ë“¤ (trans-detail.htmlì—ì„œ ê°€ì ¸ì˜´)
        let notesModified = false;
        
        function markNotesAsModified() {
            notesModified = true;
        }

        function saveWorkNotes() {
            const notes = document.getElementById('work-notes').value;
            
            if (!notes.trim()) {
                alert('ì‘ì—… íŠ¹ì´ì‚¬í•­ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” ì„œë²„ë¡œ ë°ì´í„° ì „ì†¡
            setTimeout(() => {
                notesModified = false;
                alert('ì‘ì—… íŠ¹ì´ì‚¬í•­ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }, 500);
        }
        
        // íŒŒì¼ì¶”ê°€ ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜ë“¤ (trans-detail.htmlì—ì„œ ê°€ì ¸ì˜´)
        function closeFileAddModal() {
            document.getElementById('fileAddModal').style.display = 'none';
            document.getElementById('fileAddForm').reset();
            removeNewFile();
        }
        
        function handleNewFileUpload(input) {
            if (input.files && input.files[0]) {
                const file = input.files[0];
                
                // íŒŒì¼ í¬ê¸° ì²´í¬ (100MB)
                if (file.size > 100 * 1024 * 1024) {
                    alert('íŒŒì¼ í¬ê¸°ëŠ” 100MBë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    input.value = '';
                    return;
                }
                
                // íŒŒì¼ ì •ë³´ í‘œì‹œ
                document.getElementById('newFileName').textContent = file.name;
                document.getElementById('newFileSize').textContent = (file.size / 1024 / 1024).toFixed(1) + ' MB';
                
                // ì—…ë¡œë“œ ì˜ì—­ ìˆ¨ê¸°ê³  ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ
                document.querySelector('#fileAddModal .file-upload-content').style.display = 'none';
                document.getElementById('newFilePreview').style.display = 'flex';
            }
        }
        
        function removeNewFile() {
            document.getElementById('newFileInput').value = '';
            document.getElementById('newFileName').textContent = '';
            document.getElementById('newFileSize').textContent = '';
            document.querySelector('#fileAddModal .file-upload-content').style.display = 'flex';
            document.getElementById('newFilePreview').style.display = 'none';
        }
        
        function addNewFile() {
            // íŒŒì¼ì´ ì„ íƒë˜ì—ˆëŠ”ì§€ í™•ì¸
            const fileInput = document.getElementById('newFileInput');
            if (!fileInput.files || fileInput.files.length === 0) {
                alert('íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const file = fileInput.files[0];
            
            // ì‹œì—°ìš© ì„ì˜ ë°ì´í„° ìƒì„±
            const sampleDurations = ['00:25:30', '00:45:15', '01:12:45', '00:38:20', '00:52:10'];
            
            // ëœë¤ ë°ì´í„° ì„ íƒ
            const randomIndex = Math.floor(Math.random() * sampleDurations.length);
            const duration = sampleDurations[randomIndex];
            
            // ìƒˆ íŒŒì¼ ë°ì´í„° ìƒì„± (ì‹œì—°ìš©)
            const newFileData = {
                file: { name: file.name },
                duration: duration
            };
            
            // íŒŒì¼ ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€
            addFileToMainList(newFileData);
            
            // ëª¨ë‹¬ ë‹«ê¸°
            closeFileAddModal();
            
            alert('ì˜ë¢°íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }
        
        function addFileToMainList(fileData) {
            const tbody = document.querySelector('#main-file-list-table tbody');
            if (!tbody) return;
            
            // ìƒˆ íŒŒì¼ ID ìƒì„± (ê¸°ì¡´ íŒŒì¼ ìˆ˜ + 1)
            const existingRows = tbody.querySelectorAll('tr').length;
            const newFileId = existingRows + 1;
            
            // ìƒˆ í–‰ ìƒì„±
            const newRow = document.createElement('tr');
            newRow.onclick = () => selectFileRow(newRow);
            newRow.style.cursor = 'pointer';
            newRow.setAttribute('data-file-id', newFileId);
            
            newRow.innerHTML = `
                <td style="text-align: center; padding: 12px 8px; border: 1px solid #e5e7eb; vertical-align: middle;">
                    <input type="checkbox" class="file-select-checkbox" value="${newFileId}" onclick="handleCheckboxClick(event, this);">
                </td>
                <td style="text-align: left; padding: 12px 8px; border: 1px solid #e5e7eb; vertical-align: middle;" class="file-name">
                    ${fileData.file.name}
                </td>
                <td style="text-align: center; padding: 12px 8px; border: 1px solid #e5e7eb; vertical-align: middle;">
                    í•œê¸€
                </td>
                <td style="text-align: center; padding: 12px 8px; border: 1px solid #e5e7eb; vertical-align: middle;">
                    ì˜ì–´, ì¼ë³¸ì–´, ì¤‘êµ­ì–´(ê°„ì²´)
                </td>
                <td style="text-align: center; padding: 12px 8px; border: 1px solid #e5e7eb; vertical-align: middle;">
                    ${fileData.duration}
                </td>
                <td style="text-align: center; padding: 12px 8px; border: 1px solid #e5e7eb; vertical-align: middle;">
                    <span style="background: #e5e7eb; color: #374151; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 500;">ê¸°ë³¸</span>
                </td>
                <td style="text-align: center; padding: 12px 8px; border: 1px solid #e5e7eb; vertical-align: middle;">
                    <span class="worksby-status-badge" style="background: #fef2f2; color: #991b1b; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 500;">ë¯¸ë“±ë¡</span>
                </td>
            `;
            
            tbody.appendChild(newRow);
        }
        
        // ì‚°ì¶œë¬¼ ë‹¤ìš´ë¡œë“œ ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜ë“¤ (trans-detail.htmlì—ì„œ ê°€ì ¸ì˜´)
        function closeOutputDownloadModal() {
            document.getElementById('outputDownloadModal').style.display = 'none';
            currentDownloadFileName = '';
        }
        
        // SMI tag ì˜µì…˜ í™œì„±í™”/ë¹„í™œì„±í™” í† ê¸€
        function toggleSmiTagOptions() {
            const ansiSelected = document.querySelector('input[name="smi-encoding"][value="ansi"]').checked;
            const tagSection = document.getElementById('smi-tag-section');
            const tagRadios = document.querySelectorAll('input[name="smi-tag"]');
            
            if (ansiSelected) {
                // ANSI ì„ íƒ ì‹œ í™œì„±í™”
                tagSection.style.opacity = '1';
                tagSection.style.pointerEvents = 'auto';
                tagRadios.forEach(radio => radio.disabled = false);
            } else {
                // UTF-8 ì„ íƒ ì‹œ ë¹„í™œì„±í™”
                tagSection.style.opacity = '0.5';
                tagSection.style.pointerEvents = 'none';
                tagRadios.forEach(radio => radio.disabled = true);
            }
        }
        
        // íŠ¹ì • íŒŒì¼ í˜•ì‹ ë‹¤ìš´ë¡œë“œ
        function downloadFile(fileType) {
            const fileBaseName = currentDownloadFileName.replace(/\.[^/.]+$/, ""); // í™•ì¥ì ì œê±°
            let downloadFileName = '';
            let options = {};
            
            // ê° íŒŒì¼ í˜•ì‹ë³„ë¡œ ì˜µì…˜ ìˆ˜ì§‘
            switch(fileType) {
                case 'txt':
                    const txtBlank = document.querySelector('input[name="txt-blank"]:checked').value;
                    downloadFileName = `${fileBaseName}.txt`;
                    options.blankLines = txtBlank;
                    break;
                    
                case 'smi':
                    const smiPosition = document.querySelector('input[name="smi-position"]:checked').value;
                    const smiNbsp = document.querySelector('input[name="smi-nbsp"]:checked').value;
                    const smiEncoding = document.querySelector('input[name="smi-encoding"]:checked').value;
                    const smiTag = document.querySelector('input[name="smi-tag"]:checked').value;
                    downloadFileName = `${fileBaseName}.smi`;
                    options = { position: smiPosition, nbsp: smiNbsp, encoding: smiEncoding, tag: smiTag };
                    break;
                    
                case 'srt':
                    const srtPosition = document.querySelector('input[name="srt-position"]:checked').value;
                    const srtSync = document.querySelector('input[name="srt-sync"]:checked').value;
                    const srtBlank = document.querySelector('input[name="srt-blank"]:checked').value;
                    downloadFileName = `${fileBaseName}.srt`;
                    options = { position: srtPosition, sync: srtSync, blankLines: srtBlank };
                    break;
                    
                case 'vtt':
                    downloadFileName = `${fileBaseName}.vtt`;
                    break;
                    
                case 'capt':
                    downloadFileName = `${fileBaseName}.capt`;
                    break;
                    
                case 'hwp':
                    downloadFileName = `${fileBaseName}.hwp`;
                    break;
                    
                default:
                    downloadFileName = `${fileBaseName}.txt`;
                    break;
            }
            
            // ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” ì„œë²„ì—ì„œ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ëŠ” API í˜¸ì¶œ
            const optionsText = Object.keys(options).length > 0 
                ? `\n\nì„¤ì • ì˜µì…˜: ${JSON.stringify(options, null, 2)}`
                : '';
            
            alert(`${fileType.toUpperCase()} íŒŒì¼ ë‹¤ìš´ë¡œë“œë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.\n\níŒŒì¼ëª…: ${downloadFileName}${optionsText}\n\nì‹¤ì œ í™˜ê²½ì—ì„œëŠ” íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë©ë‹ˆë‹¤.`);
            
            // ë‹¤ìš´ë¡œë“œ í›„ ëª¨ë‹¬ ë‹«ê¸°
            closeOutputDownloadModal();
            
            // ì‹œì—°ìš© - ì‹¤ì œë¡œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œê°€ ì‚¬ìš©ë©ë‹ˆë‹¤:
            // const link = document.createElement('a');
            // link.href = `/api/download/output/${encodeURIComponent(currentDownloadFileName)}/${fileType}?options=${encodeURIComponent(JSON.stringify(options))}`;
            // link.download = downloadFileName;
            // document.body.appendChild(link);
            // link.click();
            // document.body.removeChild(link);
        }
        
        // ëª¨ë“  ì˜ì—­ì—ì„œ ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸ (ì‹œë‚˜ë¦¬ì˜¤ë³„ êµ¬ë¶„)
        function updateWorkerInAllAreas(fileName, workerNames) {
            // ì‹œë‚˜ë¦¬ì˜¤ êµ¬ë¶„: ë¶„í• ëœ íŒŒì¼ëª…ì— â†’ ê°€ ìˆìœ¼ë©´ ì‹œë‚˜ë¦¬ì˜¤ 1 (íŠ¹ì • íŒŒì¼ë§Œ ë°°ì •)
            const isScenario1 = fileName.includes('â†’') || fileName.includes('êµ¬ê°„');
            
            if (isScenario1) {
                // ì‹œë‚˜ë¦¬ì˜¤ 1: íŠ¹ì • ë¶„í• ëœ íŒŒì¼ì—ë§Œ ì‘ì—…ì ë°°ì •
                updateWorkerInSpecificFile(fileName, workerNames);
            } else {
                // ì‹œë‚˜ë¦¬ì˜¤ 2,3: ëª¨ë“  íŒŒì¼ì— ì‘ì—…ì ë°°ì •
                updateWorkerInAllFilesInAllAreas(workerNames);
            }
        }
        
        // íŠ¹ì • íŒŒì¼ì—ë§Œ ì‘ì—…ì ë°°ì • (ì‹œë‚˜ë¦¬ì˜¤ 1ìš©)
        function updateWorkerInSpecificFile(fileName, workerNames) {
            console.log(`=== íŠ¹ì • íŒŒì¼ "${fileName}"ì—ë§Œ ì‘ì—…ì ë°°ì • ===`);
            
            // í˜„ì¬ í”„ë¡œì íŠ¸ ID ê°€ì ¸ì˜¤ê¸°
            const currentProjectId = window.selectedFileInfo?.currentProjectId;
            if (!currentProjectId) {
                console.log('í˜„ì¬ í”„ë¡œì íŠ¸ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            console.log(`í˜„ì¬ í”„ë¡œì íŠ¸ ID: ${currentProjectId}`);
            
            // 1. ì¶œë°œì–´ ì˜ì—­ (í”„ë¡œì íŠ¸ë³„ ê³ ìœ  ID ì‚¬ìš©)
            const detailTbody = document.getElementById(`detail-tbody-${currentProjectId}`);
            if (detailTbody) {
                updateWorkerInSpecificFileInArea(detailTbody, fileName, workerNames, 'ì¶œë°œì–´ ì˜ì—­');
            } else {
                console.log(`ì¶œë°œì–´ ì˜ì—­ í…Œì´ë¸”ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: detail-tbody-${currentProjectId}`);
            }
            
            // 2. ì¤‘ê°„ì–´ ì˜ì—­ (í”„ë¡œì íŠ¸ë³„ ê³ ìœ  ID ì‚¬ìš©)
            const intermediateTbody = document.getElementById(`intermediate-tbody-${currentProjectId}`);
            if (intermediateTbody) {
                updateWorkerInSpecificFileInArea(intermediateTbody, fileName, workerNames, 'ì¤‘ê°„ì–´ ì˜ì—­');
            }
            
            // 3. ë„ì°©ì–´ ì˜ì—­ (í”„ë¡œì íŠ¸ë³„ ê³ ìœ  ID ì‚¬ìš©)
            for (let i = 0; i < 3; i++) {
                const destinationTbody = document.getElementById(`destination-tbody-${currentProjectId}-${i}`);
                if (destinationTbody) {
                    const destinationLanguages = ["ì˜ì–´", "ì¼ë³¸ì–´", "ì¤‘êµ­ì–´(ê°„ì²´)"];
                    updateWorkerInSpecificFileInArea(destinationTbody, fileName, workerNames, `ë„ì°©ì–´ ì˜ì—­(${destinationLanguages[i]})`);
                }
            }
        }
        
        // ëª¨ë“  íŒŒì¼ì— ì‘ì—…ì ë°°ì • (ì‹œë‚˜ë¦¬ì˜¤ 2,3ìš©)
        function updateWorkerInAllFilesInAllAreas(workerNames) {
            console.log('=== ëª¨ë“  íŒŒì¼ì— ì‘ì—…ì ë°°ì • (ì‹œë‚˜ë¦¬ì˜¤ 2,3) ===');
            
            // í˜„ì¬ í”„ë¡œì íŠ¸ ID ê°€ì ¸ì˜¤ê¸°
            const currentProjectId = window.selectedFileInfo?.currentProjectId;
            if (!currentProjectId) {
                console.log('í˜„ì¬ í”„ë¡œì íŠ¸ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            console.log(`í˜„ì¬ í”„ë¡œì íŠ¸ ID: ${currentProjectId}`);
            
            // 1. ì¶œë°œì–´ ì˜ì—­ - ëª¨ë“  íŒŒì¼ì— ì‘ì—…ì ì ìš© (í”„ë¡œì íŠ¸ë³„ ê³ ìœ  ID ì‚¬ìš©)
            const detailTbody = document.getElementById(`detail-tbody-${currentProjectId}`);
            if (detailTbody) {
                updateWorkerInAllFilesInArea(detailTbody, workerNames, 'ì¶œë°œì–´ ì˜ì—­');
            } else {
                console.log(`ì¶œë°œì–´ ì˜ì—­ í…Œì´ë¸”ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: detail-tbody-${currentProjectId}`);
            }
            
            // 2. ì¤‘ê°„ì–´ ì˜ì—­ - ëª¨ë“  íŒŒì¼ì— ì‘ì—…ì ì ìš© (í”„ë¡œì íŠ¸ë³„ ê³ ìœ  ID ì‚¬ìš©)
            const intermediateTbody = document.getElementById(`intermediate-tbody-${currentProjectId}`);
            if (intermediateTbody) {
                updateWorkerInAllFilesInArea(intermediateTbody, workerNames, 'ì¤‘ê°„ì–´ ì˜ì—­');
            }
            
            // 3. ë„ì°©ì–´ ì˜ì—­ - ëª¨ë“  ì–¸ì–´ë³„ ì˜ì—­ì˜ ëª¨ë“  íŒŒì¼ì— ì‘ì—…ì ì ìš© (í”„ë¡œì íŠ¸ë³„ ê³ ìœ  ID ì‚¬ìš©)
            for (let i = 0; i < 3; i++) {
                const destinationTbody = document.getElementById(`destination-tbody-${currentProjectId}-${i}`);
                if (destinationTbody) {
                    const destinationLanguages = ["ì˜ì–´", "ì¼ë³¸ì–´", "ì¤‘êµ­ì–´(ê°„ì²´)"];
                    updateWorkerInAllFilesInArea(destinationTbody, workerNames, `ë„ì°©ì–´ ì˜ì—­(${destinationLanguages[i]})`);
                }
            }
        }
        
        // íŠ¹ì • íŒŒì¼ì—ë§Œ ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸ (ì‹œë‚˜ë¦¬ì˜¤ 1ìš©)
        function updateWorkerInSpecificFileInArea(tbody, fileName, workerNames, areaName) {
            console.log(`=== ${areaName}ì—ì„œ íŠ¹ì • íŒŒì¼ "${fileName}"ì—ë§Œ ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸ ì‹œì‘ ===`);
            
            const rows = tbody.querySelectorAll('tr');
            console.log(`${areaName} ì „ì²´ í–‰ ìˆ˜:`, rows.length);
            
            let updateCount = 0;
            
            rows.forEach((row, index) => {
                const fileNameCell = row.querySelector('.file-name') || row.querySelector('td:nth-child(2)');
                if (fileNameCell) {
                    const currentFileName = fileNameCell.textContent.replace('â†’ ', '').replace('[ë¶„í• ë¨]', '').trim();
                    console.log(`${areaName} í–‰ ${index + 1}: "${currentFileName}" vs "${fileName}"`);
                    
                    // ì •í™•íˆ ì¼ì¹˜í•˜ëŠ” íŒŒì¼ì—ë§Œ ì‘ì—…ì ë°°ì •
                    if (currentFileName === fileName) {
                        console.log(`${areaName}ì—ì„œ ì¼ì¹˜í•˜ëŠ” íŒŒì¼ ì°¾ìŒ: "${currentFileName}"`);
                        
                        // ì‘ì—…ì(ìƒíƒœ) ì»¬ëŸ¼ ì°¾ê¸° (ì˜ì—­ë³„ë¡œ ë‹¤ë¥¸ ìœ„ì¹˜)
                        let workerColumnIndex;
                        if (areaName.includes('ì¶œë°œì–´')) {
                            workerColumnIndex = 6; // ì¶œë°œì–´ ì˜ì—­: í”„ë¡œì íŠ¸ëª…(1) â†’ íŒŒì¼ëª…(2) â†’ ì¶œë°œì–´(3) â†’ ì‘ì—…ì‹œê°„(4) â†’ ì›ìŠ¤íŒŒì´ë“±ë¡(5) â†’ ì‘ì—…ì(ìƒíƒœ)(6)
                        } else if (areaName.includes('ì¤‘ê°„ì–´')) {
                            workerColumnIndex = 7; // ì¤‘ê°„ì–´ ì˜ì—­: í”„ë¡œì íŠ¸ëª…(1) â†’ íŒŒì¼ëª…(2) â†’ ì¶œë°œì–´(3) â†’ ì¤‘ê°„ì–´(4) â†’ ì‘ì—…ì‹œê°„(5) â†’ ì›ìŠ¤íŒŒì´ë“±ë¡(6) â†’ ì‘ì—…ì(ìƒíƒœ)(7)
                        } else if (areaName.includes('ë„ì°©ì–´')) {
                            workerColumnIndex = 7; // ë„ì°©ì–´ ì˜ì—­: í”„ë¡œì íŠ¸ëª…(1) â†’ íŒŒì¼ëª…(2) â†’ ì¶œë°œì–´(3) â†’ ë„ì°©ì–´(4) â†’ ì‘ì—…ì‹œê°„(5) â†’ ì›ìŠ¤íŒŒì´ë“±ë¡(6) â†’ ì‘ì—…ì(ìƒíƒœ)(7)
                        } else {
                            workerColumnIndex = 6; // ê¸°ë³¸ê°’
                        }
                        
                        const workerStatusCell = row.querySelector(`td:nth-child(${workerColumnIndex})`);
                        if (workerStatusCell) {
                            const workerDisplayText = workerNames.length > 0 
                                ? `${workerNames[0]} (ë°°ì •ì™„ë£Œ)` 
                                : '- (ëŒ€ê¸°)';
                            
                            workerStatusCell.innerHTML = `<span style="color: #10b981; font-weight: 500;">${workerDisplayText}</span>`;
                            updateCount++;
                            console.log(`${areaName} "${currentFileName}" ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸ ì™„ë£Œ: ${workerDisplayText}`);
                        }
                    }
                }
            });
            
            console.log(`${areaName} íŠ¹ì • íŒŒì¼ ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸ ì™„ë£Œ: ${updateCount}ê°œ íŒŒì¼`);
        }
        
        // íŠ¹ì • ì˜ì—­ì˜ ëª¨ë“  íŒŒì¼ì— ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸ (ì‹œë‚˜ë¦¬ì˜¤ 3ìš©)
        function updateWorkerInAllFilesInArea(tbody, workerNames, areaName) {
            console.log(`=== ${areaName}ì˜ ëª¨ë“  íŒŒì¼ì— ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸ ì‹œì‘ ===`);
            
            const rows = tbody.querySelectorAll('tr');
            console.log(`${areaName} ì „ì²´ í–‰ ìˆ˜:`, rows.length);
            
            let updateCount = 0;
            
            rows.forEach((row, index) => {
                // tree-childëŠ” ì œì™¸í•˜ê³  ì›ë³¸ íŒŒì¼ê³¼ ì¼ë°˜ íŒŒì¼ë§Œ ì—…ë°ì´íŠ¸
                if (!row.classList.contains('tree-child')) {
                    // í”„ë¡œì íŠ¸ëª… ì»¬ëŸ¼ì´ ì¶”ê°€ë˜ì–´ íŒŒì¼ëª…ì€ ë‘ ë²ˆì§¸ ì…€
                    const fileNameCell = row.querySelector('.file-name') || row.querySelector('td:nth-child(2)');
                    if (fileNameCell) {
                        const currentFileName = fileNameCell.textContent.replace('â†’ ', '').replace('[ë¶„í• ë¨]', '').trim();
                        console.log(`${areaName} í–‰ ${index + 1}: "${currentFileName}" - ì‘ì—…ì ì—…ë°ì´íŠ¸ ì¤‘...`);
                        
                        // ì‘ì—…ì(ìƒíƒœ) ì»¬ëŸ¼ ì°¾ê¸° (ì˜ì—­ë³„ë¡œ ë‹¤ë¥¸ ìœ„ì¹˜, í”„ë¡œì íŠ¸ëª… ì»¬ëŸ¼ ì¶”ê°€ë¡œ +1)
                        let workerColumnIndex;
                        if (areaName.includes('ì¶œë°œì–´')) {
                            workerColumnIndex = 6; // ì¶œë°œì–´ ì˜ì—­: í”„ë¡œì íŠ¸ëª…(1) â†’ íŒŒì¼ëª…(2) â†’ ì¶œë°œì–´(3) â†’ ì‘ì—…ì‹œê°„(4) â†’ ì›ìŠ¤íŒŒì´ë“±ë¡(5) â†’ ì‘ì—…ì(ìƒíƒœ)(6)
                        } else if (areaName.includes('ì¤‘ê°„ì–´')) {
                            workerColumnIndex = 7; // ì¤‘ê°„ì–´ ì˜ì—­: í”„ë¡œì íŠ¸ëª…(1) â†’ íŒŒì¼ëª…(2) â†’ ì¶œë°œì–´(3) â†’ ì¤‘ê°„ì–´(4) â†’ ì‘ì—…ì‹œê°„(5) â†’ ì›ìŠ¤íŒŒì´ë“±ë¡(6) â†’ ì‘ì—…ì(ìƒíƒœ)(7)
                        } else if (areaName.includes('ë„ì°©ì–´')) {
                            workerColumnIndex = 7; // ë„ì°©ì–´ ì˜ì—­: í”„ë¡œì íŠ¸ëª…(1) â†’ íŒŒì¼ëª…(2) â†’ ì¶œë°œì–´(3) â†’ ë„ì°©ì–´(4) â†’ ì‘ì—…ì‹œê°„(5) â†’ ì›ìŠ¤íŒŒì´ë“±ë¡(6) â†’ ì‘ì—…ì(ìƒíƒœ)(7)
                        } else {
                            workerColumnIndex = 6; // ê¸°ë³¸ê°’
                        }
                        
                        const workerStatusCell = row.querySelector(`td:nth-child(${workerColumnIndex})`);
                        if (workerStatusCell) {
                            const workerDisplayText = workerNames.length > 0 
                                ? `${workerNames[0]} (ë°°ì •ì™„ë£Œ)` 
                                : '- (ëŒ€ê¸°)';
                            
                            workerStatusCell.innerHTML = `<span style="color: #10b981; font-weight: 500;">${workerDisplayText}</span>`;
                            updateCount++;
                            console.log(`${areaName} "${currentFileName}" ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸ ì™„ë£Œ: ${workerDisplayText}`);
                        }
                    }
                }
            });
            
            console.log(`${areaName} ì‘ì—…ì ì •ë³´ ì—…ë°ì´íŠ¸ ì™„ë£Œ: ${updateCount}ê°œ íŒŒì¼`);
        }
        
        // ì‘ì—…ì ê´€ë¦¬ ëª¨ë‹¬ ì¼ê´„ ë°°ì •/ë¯¸ë°°ì • ì²˜ë¦¬
        function batchUpdateWorkerStatusModal(status) {
            const checkedBoxes = document.querySelectorAll('input[name="workerSelectModal"]:checked');
            if (checkedBoxes.length === 0) {
                alert('ì„ íƒëœ ì‘ì—…ìê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const statusText = status === 'assigned' ? 'ë°°ì •' : 'ë¯¸ë°°ì •';
            const confirmMessage = `ì„ íƒëœ ${checkedBoxes.length}ëª…ì˜ ì‘ì—…ìë¥¼ ${statusText}í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`;
            
            if (confirm(confirmMessage)) {
                checkedBoxes.forEach(checkbox => {
                    const row = checkbox.closest('tr');
                    const statusCell = row.querySelector('td:nth-child(9)');
                    const statusSpan = statusCell.querySelector('.applicant-status');
                    
                    if (status === 'assigned') {
                        statusSpan.textContent = 'ë°°ì •';
                        statusSpan.className = 'applicant-status status-approved';
                        statusSpan.style.background = '#dcfce7';
                        statusSpan.style.color = '#166534';
                        // ë°°ì •ì¼ ì¶”ê°€
                        const assignDateCell = row.querySelector('td:nth-child(8)');
                        const today = new Date();
                        assignDateCell.textContent = today.toISOString().slice(0, 10).replace(/-/g, '.');
                    } else if (status === 'unassigned') {
                        statusSpan.textContent = 'ë¯¸ë°°ì •';
                        statusSpan.className = 'applicant-status status-cancelled';
                        statusSpan.style.background = '#fef2f2';
                        statusSpan.style.color = '#991b1b';
                        // ë°°ì •ì¼ ì œê±°
                        const assignDateCell = row.querySelector('td:nth-child(8)');
                        assignDateCell.textContent = '-';
                    }
                    
                    // ì²´í¬ë°•ìŠ¤ í•´ì œ
                    checkbox.checked = false;
                });
                
                // ì „ì²´ ì„ íƒ ì²´í¬ë°•ìŠ¤ë„ í•´ì œ
                const selectAllCheckbox = document.getElementById('selectAllWorkersModal');
                if (selectAllCheckbox) {
                    selectAllCheckbox.checked = false;
                }
                
                updateSelectedWorkerCountModal();
                
                alert(`${checkedBoxes.length}ëª…ì˜ ì‘ì—…ìê°€ ${statusText}ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }
        }
        
        // ì‘ì—…ì ê´€ë¦¬ ëª¨ë‹¬ ì„ íƒëœ ì‘ì—…ì ìˆ˜ ì—…ë°ì´íŠ¸
        function updateSelectedWorkerCountModal() {
            const checkedBoxes = document.querySelectorAll('input[name="workerSelectModal"]:checked');
            const countElement = document.getElementById('selectedWorkerCountModal');
            if (countElement) {
                countElement.textContent = checkedBoxes.length + 'ëª…';
            }
        }
        
        // ì‘ì—…ì ê´€ë¦¬ ëª¨ë‹¬ ì²´í¬ë°•ìŠ¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        document.addEventListener('change', function(e) {
            if (e.target.name === 'workerSelectModal') {
                updateSelectedWorkerCountModal();
            }
        });
        
        // ìƒˆë¡œìš´ ê¸°ëŠ¥ë“¤ì„ ìœ„í•œ í•¨ìˆ˜ë“¤
        function executeTranscription(fileName) {
            alert(`${fileName} íŒŒì¼ì˜ ì „ì‚¬íˆ´ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.`);
            // ì¶”í›„ êµ¬í˜„ ì˜ˆì •
        }
        
        // ì¶œë°œì–´ ì˜ì—­ì˜ ëª¨ë“  íŒŒì¼ì´ ê²€ìˆ˜ì™„ë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” í•¨ìˆ˜
        function checkAllSourceFilesReviewComplete() {
            // í˜„ì¬ í‘œì‹œëœ í”„ë¡œì íŠ¸ ID ì°¾ê¸°
            const visibleProjectArea = document.querySelector('[id^="worksby-detail-area-"][style*="block"]');
            if (!visibleProjectArea) {
                console.log('í‘œì‹œëœ í”„ë¡œì íŠ¸ ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return false;
            }
            
            const currentProjectId = visibleProjectArea.id.replace('worksby-detail-area-', '');
            console.log(`ì¶œë°œì–´ ê²€ìˆ˜ ì™„ë£Œ ì²´í¬ - í˜„ì¬ í”„ë¡œì íŠ¸ ID: ${currentProjectId}`);
            
            const detailTbody = document.getElementById(`detail-tbody-${currentProjectId}`);
            if (!detailTbody) {
                console.log(`ì¶œë°œì–´ ì˜ì—­ í…Œì´ë¸”ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: detail-tbody-${currentProjectId}`);
                return false;
            }
            
            const rows = detailTbody.querySelectorAll('tr');
            let totalFiles = 0;
            let completedFiles = 0;
            
            rows.forEach(row => {
                // tree-childëŠ” ì œì™¸í•˜ê³  ì›ë³¸ íŒŒì¼ê³¼ ì¼ë°˜ íŒŒì¼ë§Œ ì²´í¬
                if (!row.classList.contains('tree-child')) {
                    totalFiles++;
                    
                    // ì§„í–‰ìƒíƒœ ì»¬ëŸ¼ (ë§ˆì§€ë§‰ ì»¬ëŸ¼) í™•ì¸
                    const progressCell = row.querySelector('td:last-child');
                    if (progressCell) {
                        const progressText = progressCell.textContent.trim();
                        if (progressText.includes('ê²€ìˆ˜ì™„ë£Œ')) {
                            completedFiles++;
                        }
                    }
                }
            });
            
            console.log(`ì¶œë°œì–´ ì˜ì—­ ê²€ìˆ˜ ìƒíƒœ: ${completedFiles}/${totalFiles}`);
            return totalFiles > 0 && completedFiles === totalFiles;
        }
        
        // ì¤‘ê°„ì–´ ì˜ì—­ì˜ ëª¨ë“  íŒŒì¼ì´ ê²€ìˆ˜ì™„ë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” í•¨ìˆ˜
        function checkAllIntermediateFilesReviewComplete() {
            // í˜„ì¬ í‘œì‹œëœ í”„ë¡œì íŠ¸ ID ì°¾ê¸°
            const visibleProjectArea = document.querySelector('[id^="worksby-detail-area-"][style*="block"]');
            if (!visibleProjectArea) {
                console.log('í‘œì‹œëœ í”„ë¡œì íŠ¸ ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return false;
            }
            
            const currentProjectId = visibleProjectArea.id.replace('worksby-detail-area-', '');
            console.log(`ì¤‘ê°„ì–´ ê²€ìˆ˜ ì™„ë£Œ ì²´í¬ - í˜„ì¬ í”„ë¡œì íŠ¸ ID: ${currentProjectId}`);
            
            const intermediateTbody = document.getElementById(`intermediate-tbody-${currentProjectId}`);
            if (!intermediateTbody) {
                console.log(`ì¤‘ê°„ì–´ ì˜ì—­ í…Œì´ë¸”ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: intermediate-tbody-${currentProjectId}`);
                return false;
            }
            
            const rows = intermediateTbody.querySelectorAll('tr');
            let totalFiles = 0;
            let completedFiles = 0;
            
            rows.forEach(row => {
                // tree-childëŠ” ì œì™¸í•˜ê³  ì›ë³¸ íŒŒì¼ê³¼ ì¼ë°˜ íŒŒì¼ë§Œ ì²´í¬
                if (!row.classList.contains('tree-child')) {
                    totalFiles++;
                    
                    // ì§„í–‰ìƒíƒœ ì»¬ëŸ¼ (ë§ˆì§€ë§‰ ì»¬ëŸ¼) í™•ì¸
                    const progressCell = row.querySelector('td:last-child');
                    if (progressCell) {
                        const progressText = progressCell.textContent.trim();
                        if (progressText.includes('ê²€ìˆ˜ì™„ë£Œ')) {
                            completedFiles++;
                        }
                    }
                }
            });
            
            console.log(`ì¤‘ê°„ì–´ ì˜ì—­ ê²€ìˆ˜ ìƒíƒœ: ${completedFiles}/${totalFiles}`);
            return totalFiles > 0 && completedFiles === totalFiles;
        }
        
        // í˜„ì¬ ë„ì°©ì–´ ì˜ì—­ì˜ ì–¸ì–´ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
        function getCurrentDestinationLanguageInfo(fileName) {
            // ë„ì°©ì–´ ì˜ì—­ë“¤ì„ ìˆœíšŒí•˜ë©° í•´ë‹¹ íŒŒì¼ì´ ìˆëŠ” ì–¸ì–´ ì°¾ê¸°
            const destinationLanguages = ["ì˜ì–´", "ì¼ë³¸ì–´", "ì¤‘êµ­ì–´(ê°„ì²´)"];
            
            for (let langIndex = 0; langIndex < destinationLanguages.length; langIndex++) {
                const destinationTbody = document.getElementById(`destination-tbody-${langIndex}`);
                if (destinationTbody) {
                    const rows = destinationTbody.querySelectorAll('tr');
                    for (let row of rows) {
                        // í”„ë¡œì íŠ¸ëª… ì»¬ëŸ¼ì´ ì¶”ê°€ë˜ì–´ íŒŒì¼ëª…ì€ ë‘ ë²ˆì§¸ ì…€
                        const fileNameCell = row.querySelector('td:nth-child(2)') || row.querySelector('.file-name');
                        if (fileNameCell) {
                            const currentFileName = fileNameCell.textContent.replace('â†’ ', '').replace('[ë¶„í• ë¨]', '').trim();
                            if (currentFileName === fileName) {
                                return {
                                    language: destinationLanguages[langIndex],
                                    langIndex: langIndex
                                };
                            }
                        }
                    }
                }
            }
            return null;
        }
        
        // íŠ¹ì • ë„ì°©ì–´ ì–¸ì–´ ì˜ì—­ì˜ ëª¨ë“  íŒŒì¼ì´ ê²€ìˆ˜ì™„ë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” í•¨ìˆ˜
        function checkAllDestinationFilesReviewComplete(langIndex) {
            const destinationTbody = document.getElementById(`destination-tbody-${langIndex}`);
            if (!destinationTbody) return false;
            
            const rows = destinationTbody.querySelectorAll('tr');
            let totalFiles = 0;
            let completedFiles = 0;
            
            rows.forEach(row => {
                // tree-childëŠ” ì œì™¸í•˜ê³  ì›ë³¸ íŒŒì¼ê³¼ ì¼ë°˜ íŒŒì¼ë§Œ ì²´í¬
                if (!row.classList.contains('tree-child')) {
                    totalFiles++;
                    
                    // ì§„í–‰ìƒíƒœ ì»¬ëŸ¼ (ë§ˆì§€ë§‰ ì»¬ëŸ¼) í™•ì¸
                    const progressCell = row.querySelector('td:last-child');
                    if (progressCell) {
                        const progressText = progressCell.textContent.trim();
                        if (progressText.includes('ê²€ìˆ˜ì™„ë£Œ')) {
                            completedFiles++;
                        }
                    }
                }
            });
            
            const destinationLanguages = ["ì˜ì–´", "ì¼ë³¸ì–´", "ì¤‘êµ­ì–´(ê°„ì²´)"];
            console.log(`${destinationLanguages[langIndex]} ì˜ì—­ ê²€ìˆ˜ ìƒíƒœ: ${completedFiles}/${totalFiles}`);
            return totalFiles > 0 && completedFiles === totalFiles;
        }
        
        function executeReview(fileName) {
            // í˜„ì¬ ì–´ëŠ ì˜ì—­ì—ì„œ ì‹¤í–‰ë˜ëŠ”ì§€ í™•ì¸
            const currentArea = determineCurrentArea(fileName);
            
            if (currentArea === 'source') {
                // ì¶œë°œì–´ ì˜ì—­ì—ì„œ ê²€ìˆ˜íˆ´ ì‹¤í–‰
                if (confirm(`${fileName} íŒŒì¼ì˜ ê²€ìˆ˜íˆ´ì„ ì‹¤í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                    // ì¶œë°œì–´ ì˜ì—­ì˜ ì§„í–‰ìƒíƒœë¥¼ "ê²€ìˆ˜ì™„ë£Œ"ë¡œ ë³€ê²½
                    updateSourceAreaProgressStatus(fileName, 'ê²€ìˆ˜ì™„ë£Œ');
                    
                    // í”„ë¡œì íŠ¸ ì œëª© ê°€ì ¸ì˜¤ê¸°
                        const projectTitle = getProjectTitleForFile(fileName);
                    
                    // ì¶œë°œì–´ ì˜ì—­ì˜ ëª¨ë“  íŒŒì¼ì´ ê²€ìˆ˜ ì™„ë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸
                    if (checkAllSourceFilesReviewComplete()) {
                        // ëª¨ë“  íŒŒì¼ ì™„ë£Œ ì‹œì—ë§Œ ì¤‘ê°„ì–´ ì˜ì—­ ìƒì„±
                        createIntermediateLanguageAreaFromWorksby(fileName, projectTitle);
                        alert(`ëª¨ë“  íŒŒì¼ì˜ ê²€ìˆ˜ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.\nì¤‘ê°„ì–´ ì˜ì—­ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                    } else {
                        alert(`${fileName} íŒŒì¼ì˜ ê²€ìˆ˜ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.\në‹¤ë¥¸ íŒŒì¼ë“¤ì˜ ê²€ìˆ˜ë„ ì™„ë£Œí•´ì£¼ì„¸ìš”.`);
                    }
                }
            } else if (currentArea === 'intermediate') {
                // ì¤‘ê°„ì–´ ì˜ì—­ì—ì„œ ê²€ìˆ˜íˆ´ ì‹¤í–‰
                if (confirm(`${fileName} íŒŒì¼ì˜ ê²€ìˆ˜íˆ´ì„ ì‹¤í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                    // ì¤‘ê°„ì–´ ì˜ì—­ì˜ ì§„í–‰ìƒíƒœë¥¼ "ê²€ìˆ˜ì™„ë£Œ"ë¡œ ë³€ê²½
                    updateIntermediateAreaProgressStatus(fileName, 'ê²€ìˆ˜ì™„ë£Œ');
                    
                    // í”„ë¡œì íŠ¸ ì œëª© ê°€ì ¸ì˜¤ê¸°
                        const projectTitle = getProjectTitleForFile(fileName);
                    
                    // í˜„ì¬ í”„ë¡œì íŠ¸ ID ì°¾ê¸°
                    const visibleProjectArea = document.querySelector('[id^="worksby-detail-area-"][style*="block"]');
                    const currentProjectId = visibleProjectArea ? visibleProjectArea.id.replace('worksby-detail-area-', '') : null;
                    
                    if (!currentProjectId) {
                        console.log('í˜„ì¬ í”„ë¡œì íŠ¸ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                        alert('í˜„ì¬ í”„ë¡œì íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                        return;
                    }
                    
                    // ì¤‘ê°„ì–´ ì˜ì—­ì˜ ëª¨ë“  íŒŒì¼ì´ ê²€ìˆ˜ ì™„ë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸
                    if (checkAllIntermediateFilesReviewComplete()) {
                        // ëª¨ë“  íŒŒì¼ ì™„ë£Œ ì‹œì—ë§Œ ë„ì°©ì–´ ì˜ì—­ ìƒì„± (í”„ë¡œì íŠ¸ ID ì „ë‹¬)
                        createDestinationLanguageAreaFromIntermediate(fileName, projectTitle, currentProjectId);
                        alert(`ëª¨ë“  íŒŒì¼ì˜ ê²€ìˆ˜ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.\nëª¨ë“  ë„ì°© ì–¸ì–´ë³„ ë„ì°©ì–´ ì˜ì—­ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                    } else {
                        alert(`${fileName} íŒŒì¼ì˜ ê²€ìˆ˜ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.\në‹¤ë¥¸ íŒŒì¼ë“¤ì˜ ê²€ìˆ˜ë„ ì™„ë£Œí•´ì£¼ì„¸ìš”.`);
                    }
                }
            } else {
                // ë„ì°©ì–´ ì˜ì—­ì—ì„œ ê²€ìˆ˜íˆ´ ì‹¤í–‰
                if (confirm(`${fileName} íŒŒì¼ì˜ ê²€ìˆ˜íˆ´ì„ ì‹¤í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                    // í˜„ì¬ ì–¸ì–´ì™€ ì¸ë±ìŠ¤ í™•ì¸
                    const currentLanguageInfo = getCurrentDestinationLanguageInfo(fileName);
                    
                    if (currentLanguageInfo) {
                        // í•´ë‹¹ ì–¸ì–´ ì˜ì—­ì˜ ì§„í–‰ìƒíƒœë¥¼ "ê²€ìˆ˜ì™„ë£Œ"ë¡œ ë³€ê²½
                        updateDestinationAreaProgressStatus(fileName, currentLanguageInfo.language, currentLanguageInfo.langIndex, 'ê²€ìˆ˜ì™„ë£Œ');
                        
                        // í•´ë‹¹ ì–¸ì–´ ì˜ì—­ì˜ ëª¨ë“  íŒŒì¼ì´ ê²€ìˆ˜ ì™„ë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸
                        if (checkAllDestinationFilesReviewComplete(currentLanguageInfo.langIndex)) {
                            alert(`${currentLanguageInfo.language} ì˜ì—­ì˜ ëª¨ë“  íŒŒì¼ ê²€ìˆ˜ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\n${currentLanguageInfo.language} ë²ˆì—­ ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`);
                        } else {
                            alert(`${fileName} íŒŒì¼ì˜ ê²€ìˆ˜ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.\n${currentLanguageInfo.language} ì˜ì—­ì˜ ë‹¤ë¥¸ íŒŒì¼ë“¤ì˜ ê²€ìˆ˜ë„ ì™„ë£Œí•´ì£¼ì„¸ìš”.`);
                        }
                    } else {
                    alert(`${fileName} íŒŒì¼ì˜ ê²€ìˆ˜ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`);
                    }
                }
            }
        }
        
        // ì§„í–‰ ìƒíƒœ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateProgressStatus(fileName, status, area) {
            console.log(`ì§„í–‰ ìƒíƒœ ì—…ë°ì´íŠ¸: ${fileName} â†’ ${status} (${area})`);
            
            let tbody;
            let statusColumnIndex;
            
            if (area === 'source') {
                tbody = document.getElementById('detail-tbody');
                statusColumnIndex = 9; // ì¶œë°œì–´ ì˜ì—­ ì§„í–‰ ìƒíƒœ ì»¬ëŸ¼
            } else if (area === 'intermediate') {
                tbody = document.getElementById('intermediate-tbody');
                statusColumnIndex = 10; // ì¤‘ê°„ì–´ ì˜ì—­ ì§„í–‰ ìƒíƒœ ì»¬ëŸ¼
            } else if (area === 'destination') {
                // ë„ì°©ì–´ ì˜ì—­ì€ ëª¨ë“  ì–¸ì–´ë³„ ì˜ì—­ í™•ì¸
                for (let i = 0; i < 3; i++) {
                    const destTbody = document.getElementById(`destination-tbody-${i}`);
                    if (destTbody) {
                        updateStatusInTbody(destTbody, fileName, status, 10);
                    }
                }
                return;
            }
            
            if (tbody) {
                updateStatusInTbody(tbody, fileName, status, statusColumnIndex);
            }
        }
        
        // íŠ¹ì • í…Œì´ë¸”ì—ì„œ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateStatusInTbody(tbody, fileName, status, columnIndex) {
            const rows = tbody.querySelectorAll('tr');
            
            rows.forEach(row => {
                const fileNameCell = row.querySelector('.file-name');
                if (fileNameCell) {
                    const currentFileName = fileNameCell.textContent.replace('â†’ ', '').replace('[ë¶„í• ë¨]', '').trim();
                    
                    if (currentFileName === fileName.replace('â†’ ', '').replace('[ë¶„í• ë¨]', '').trim()) {
                        const statusCell = row.querySelector(`td:nth-child(${columnIndex})`);
                        if (statusCell) {
                            const statusColor = status === 'ê²€ìˆ˜ì™„ë£Œ' ? '#10b981' : '#e5e7eb';
                            const textColor = status === 'ê²€ìˆ˜ì™„ë£Œ' ? 'white' : '#374151';
                            
                            statusCell.innerHTML = `
                                <span class="status-badge" style="background: ${statusColor}; color: ${textColor}; padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;">
                                    ${status}
                                </span>
                            `;
                        }
                    }
                }
            });
        }
        
        // íŠ¹ì • ì˜ì—­ì˜ ëª¨ë“  íŒŒì¼ì´ ê²€ìˆ˜ ì™„ë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸
        function checkAllFilesReviewComplete(area) {
            console.log(`${area} ì˜ì—­ ê²€ìˆ˜ ì™„ë£Œ ì—¬ë¶€ í™•ì¸`);
            
            let tbody;
            let statusColumnIndex;
            
            if (area === 'source') {
                tbody = document.getElementById('detail-tbody');
                statusColumnIndex = 9;
            } else if (area === 'intermediate') {
                tbody = document.getElementById('intermediate-tbody');
                statusColumnIndex = 10;
            } else {
                return false;
            }
            
            if (!tbody) return false;
            
            const rows = tbody.querySelectorAll('tr');
            let totalFiles = 0;
            let completedFiles = 0;
            
            rows.forEach(row => {
                // ì›ë³¸ íŒŒì¼(tree-parent)ì´ ì•„ë‹Œ ì‹¤ì œ ì‘ì—… íŒŒì¼ë§Œ í™•ì¸
                if (!row.classList.contains('tree-parent')) {
                    const statusCell = row.querySelector(`td:nth-child(${statusColumnIndex})`);
                    if (statusCell) {
                        totalFiles++;
                        const statusText = statusCell.textContent.trim();
                        if (statusText === 'ê²€ìˆ˜ì™„ë£Œ') {
                            completedFiles++;
                        }
                    }
                }
            });
            
            console.log(`${area} ì˜ì—­: ì „ì²´ ${totalFiles}ê°œ, ì™„ë£Œ ${completedFiles}ê°œ`);
            return totalFiles > 0 && totalFiles === completedFiles;
        }
        
        // íŒŒì¼ëª…ìœ¼ë¡œ í”„ë¡œì íŠ¸ ì œëª© ì°¾ê¸°
        function getProjectTitleForFile(fileName) {
            // í˜„ì¬ ì„ íƒëœ í…œí”Œë¦¿ì—ì„œ í”„ë¡œì íŠ¸ ì œëª© ê°€ì ¸ì˜¤ê¸°
            const selectedTemplate = document.querySelector('.template-row[style*="background-color"]');
            if (selectedTemplate) {
                return selectedTemplate.getAttribute('data-project-title');
            }
            
            // ê¸°ë³¸ê°’
            return window.currentProjectData ? window.currentProjectData.projectTitle : 'ê¸°ë³¸ í”„ë¡œì íŠ¸';
        }
        
        // í˜„ì¬ íŒŒì¼ì´ ì–´ëŠ ì˜ì—­ì— ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” í•¨ìˆ˜
        function determineCurrentArea(fileName) {
            const cleanFileName = fileName.replace('â†’ ', '').replace('[ë¶„í• ë¨]', '').trim();
            
            // í˜„ì¬ í‘œì‹œëœ í”„ë¡œì íŠ¸ ID ì°¾ê¸°
            const visibleProjectArea = document.querySelector('[id^="worksby-detail-area-"][style*="block"]');
            if (!visibleProjectArea) {
                console.log('í‘œì‹œëœ í”„ë¡œì íŠ¸ ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return 'source'; // ê¸°ë³¸ê°’
            }
            
            const currentProjectId = visibleProjectArea.id.replace('worksby-detail-area-', '');
            console.log(`ì˜ì—­ í™•ì¸ - í˜„ì¬ í”„ë¡œì íŠ¸ ID: ${currentProjectId}`);
            
            // ë„ì°©ì–´ ì˜ì—­ ë¨¼ì € í™•ì¸ (ê°€ì¥ êµ¬ì²´ì )
            for (let i = 0; i < 3; i++) {
                const destinationTbody = document.getElementById(`destination-tbody-${currentProjectId}-${i}`);
                if (destinationTbody) {
                    const destinationRows = destinationTbody.querySelectorAll('tr');
                    
                    for (let row of destinationRows) {
                        const fileNameCell = row.querySelector('.file-name') || row.querySelector('td:nth-child(2)');
                        if (fileNameCell) {
                            const currentFileName = fileNameCell.textContent.replace('â†’ ', '').replace('[ë¶„í• ë¨]', '').trim();
                            
                            if (currentFileName === cleanFileName) {
                                console.log(`íŒŒì¼ "${cleanFileName}"ì´ ë„ì°©ì–´ ì˜ì—­ì—ì„œ ë°œê²¬ë¨`);
                                return 'destination';
                            }
                        }
                    }
                }
            }
            
            // ì¤‘ê°„ì–´ ì˜ì—­ í™•ì¸ (ë‘ ë²ˆì§¸ë¡œ êµ¬ì²´ì )
            const intermediateTbody = document.getElementById(`intermediate-tbody-${currentProjectId}`);
            if (intermediateTbody) {
                const intermediateRows = intermediateTbody.querySelectorAll('tr');
                
                for (let row of intermediateRows) {
                    const fileNameCell = row.querySelector('.file-name');
                    if (fileNameCell) {
                        const currentFileName = fileNameCell.textContent.replace('â†’ ', '').replace('[ë¶„í• ë¨]', '').trim();
                        
                        if (currentFileName === cleanFileName) {
                            return 'intermediate';
                        }
                    }
                }
            }
            
            // ì¶œë°œì–´ ì˜ì—­ í™•ì¸ (ê°€ì¥ ë§ˆì§€ë§‰, ê°€ì¥ ì¼ë°˜ì )
            const detailTbody = document.getElementById(`detail-tbody-${currentProjectId}`);
            if (detailTbody) {
                const detailRows = detailTbody.querySelectorAll('tr');
                
                for (let row of detailRows) {
                    const fileNameCell = row.querySelector('.file-name') || row.querySelector('td:nth-child(2)');
                    if (fileNameCell) {
                        const currentFileName = fileNameCell.textContent.replace('â†’ ', '').replace('[ë¶„í• ë¨]', '').trim();
                        
                        if (currentFileName === cleanFileName) {
                            console.log(`íŒŒì¼ "${cleanFileName}"ì´ ì¶œë°œì–´ ì˜ì—­ì—ì„œ ë°œê²¬ë¨`);
                            return 'source';
                        }
                    }
                }
            }
            
            return 'unknown';
        }
        
        // ì‚°ì¶œë¬¼ ë‹¤ìš´ë¡œë“œ ëª¨ë‹¬ ì—´ê¸°
        let currentDownloadFileName = '';
        
        function downloadOutput(fileName, outputType) {
            currentDownloadFileName = fileName;
            document.getElementById('outputDownloadModal').style.display = 'flex';
        }
        
        // ì‘ì—…ì ë°°ì • í•¨ìˆ˜ (ì‘ì—…ì ê´€ë¦¬ ëª¨ë‹¬ ì—´ê¸°)
        function assignNewWorker(fileName, projectTitle) {
            console.log('ì‘ì—…ì ë°°ì • ëª¨ë‹¬ ì—´ê¸°:', fileName, projectTitle);
            
            // í˜„ì¬ í‘œì‹œëœ í”„ë¡œì íŠ¸ ID ì°¾ê¸°
            const visibleProjectArea = document.querySelector('[id^="worksby-detail-area-"][style*="block"]');
            let currentProjectId = null;
            
            if (visibleProjectArea) {
                currentProjectId = visibleProjectArea.id.replace('worksby-detail-area-', '');
            }
            
            // ì„ íƒëœ íŒŒì¼ ì •ë³´ë¥¼ ì „ì—­ ë³€ìˆ˜ì— ì €ì¥
            window.selectedFileInfo = {
                fileName: fileName,
                projectTitle: projectTitle,
                currentProjectId: currentProjectId
            };
            
            console.log('ì €ì¥ëœ íŒŒì¼ ì •ë³´:', window.selectedFileInfo);
            
            // ì‘ì—…ì ê´€ë¦¬ ëª¨ë‹¬ ì—´ê¸°
            document.getElementById('workerManagementModal').style.display = 'flex';
        }
        
        // ì¤‘ê°„ì–´ ì˜ì—­ì—ì„œ ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„±
        function createIntermediateWorksbyProject(fileName, projectTitle) {
            console.log('ì¤‘ê°„ì–´ ì˜ì—­ ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„±:', fileName, projectTitle);
            
            // í˜„ì¬ í”„ë¡œì íŠ¸ ID ì°¾ê¸°
            const visibleProjectArea = document.querySelector('[id^="worksby-detail-area-"][style*="block"]');
            const currentProjectId = visibleProjectArea ? visibleProjectArea.id.replace('worksby-detail-area-', '') : null;
            
            // ì„ íƒëœ íŒŒì¼ ì •ë³´ë¥¼ ì „ì—­ ë³€ìˆ˜ì— ì €ì¥
            window.selectedFileInfo = {
                fileName: fileName,
                projectTitle: projectTitle,
                fromIntermediateArea: true,  // ì¤‘ê°„ì–´ ì˜ì—­ì—ì„œ í˜¸ì¶œë¨ì„ í‘œì‹œ
                currentProjectId: currentProjectId
            };
            
            console.log('ì¤‘ê°„ì–´ ì˜ì—­ ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„± - ì €ì¥ëœ ì •ë³´:', window.selectedFileInfo);
            
            // ì›ìŠ¤íŒŒì´ ë“±ë¡ ëª¨ë‹¬ ì—´ê¸°
            openWorksbyRegistrationModal(fileName, projectTitle);
        }
        
        // ì¤‘ê°„ì–´ ì˜ì—­ ì›ìŠ¤íŒŒì´ ë“±ë¡ ì™„ë£Œ í›„ ë²„íŠ¼ ì—…ë°ì´íŠ¸
        function updateIntermediateWorksbyButtons(projectTitle) {
            // í˜„ì¬ í”„ë¡œì íŠ¸ ID ê°€ì ¸ì˜¤ê¸°
            const currentProjectId = window.selectedFileInfo?.currentProjectId;
            if (!currentProjectId) {
                console.log('í˜„ì¬ í”„ë¡œì íŠ¸ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            console.log(`ì¤‘ê°„ì–´ ì›ìŠ¤íŒŒì´ ë²„íŠ¼ ì—…ë°ì´íŠ¸ - í”„ë¡œì íŠ¸ ID: ${currentProjectId}`);
            
            const intermediateTbody = document.getElementById(`intermediate-tbody-${currentProjectId}`);
            
            if (!intermediateTbody) {
                return;
            }
            
            const rows = intermediateTbody.querySelectorAll('tr');
            
            rows.forEach((row, index) => {
                // ì›ë³¸ íŒŒì¼(tree-parent)ì€ ë“±ë¡ í™•ì¸ ë²„íŠ¼ ì—…ë°ì´íŠ¸ ì œì™¸
                if (row.classList.contains('tree-parent')) {
                    return;
                }
                
                // í”„ë¡œì íŠ¸ëª… ì»¬ëŸ¼ ì—…ë°ì´íŠ¸ (ë¶„í• ëœ íŒŒì¼ê³¼ ì¼ë°˜ íŒŒì¼ êµ¬ë¶„)
                let projectNameCell;
                if (row.classList.contains('tree-child')) {
                    // ë¶„í• ëœ íŒŒì¼ì˜ ê²½ìš° split IDë¡œ ì°¾ê¸°
                    const splitIndex = Array.from(intermediateTbody.querySelectorAll('tr.tree-child')).indexOf(row);
                    projectNameCell = document.getElementById(`intermediate-project-split-${splitIndex}`);
                } else {
                    // ì¼ë°˜ íŒŒì¼ì˜ ê²½ìš° ê¸°ë³¸ IDë¡œ ì°¾ê¸°
                    projectNameCell = document.getElementById(`intermediate-project-${index}`);
                }
                
                if (projectNameCell) {
                    projectNameCell.textContent = projectTitle;
                }
                
                // ë¶„í• ëœ íŒŒì¼ì¸ ê²½ìš°ì™€ ì¼ë°˜ íŒŒì¼ì¸ ê²½ìš° ID êµ¬ë¶„
                let registerCell;
                if (row.classList.contains('tree-child')) {
                    // ë¶„í• ëœ íŒŒì¼ì˜ ê²½ìš° split IDë¡œ ì°¾ê¸°
                    const splitIndex = Array.from(intermediateTbody.querySelectorAll('tr.tree-child')).indexOf(row);
                    registerCell = document.getElementById(`intermediate-register-split-${splitIndex}`);
                } else {
                    // ì¼ë°˜ íŒŒì¼ì˜ ê²½ìš° ê¸°ë³¸ IDë¡œ ì°¾ê¸°
                    registerCell = document.getElementById(`intermediate-register-${index}`);
                }
                
                if (registerCell) {
                    const fileName = row.querySelector('.file-name').textContent;
                    
                    registerCell.innerHTML = `
                        <button class="btn btn-success" onclick="openProjectDetailModal('${fileName}', '${projectTitle}')" 
                                style="padding: 6px 12px; font-size: 12px; margin: 0 auto; display: inline-block;">
                            <span>âœ…</span>
                            ë“±ë¡ í™•ì¸
                        </button>
                    `;
                }
            });
        }
        
        // ì¤‘ê°„ì–´ ì˜ì—­ ê±´ë„ˆë›°ê¸° í•¨ìˆ˜ (í”„ë¡œì íŠ¸ë³„ ê³ ìœ  ID ì‚¬ìš©)
        function skipIntermediateArea(fileName, projectTitle, projectId) {
            console.log('ì¤‘ê°„ì–´ ì˜ì—­ ê±´ë„ˆë›°ê¸°:', fileName, projectTitle, projectId);
            
            if (confirm('ì¤‘ê°„ì–´ë¥¼ ê±´ë„ˆë›°ê³  ë„ì°©ì–´ ì˜ì—­ì„ ì—½ë‹ˆë‹¤.\nì¶œë°œì–´ > ë„ì°©ì–´ LLM ë²ˆì—­ì„ ì‹œì‘í•©ë‹ˆë‹¤.')) {
                console.log('ì¤‘ê°„ì–´ ì˜ì—­ ê±´ë„ˆë›°ê¸° í™•ì¸ë¨ - ë„ì°©ì–´ ì˜ì—­ ìƒì„± ì‹œì‘');
                
                // ë°”ë¡œ ë„ì°©ì–´ ì˜ì—­ ìƒì„± (ì¤‘ê°„ì–´ í”„ë¡œì„¸ìŠ¤ ê±´ë„ˆë›°ê¸°)
                createDestinationLanguageAreaFromIntermediate(fileName, projectTitle, projectId);
                
                alert('ì¤‘ê°„ì–´ ì˜ì—­ì„ ê±´ë„ˆë›°ê³  ë„ì°©ì–´ ì˜ì—­ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.\nLLM ë²ˆì—­ì´ ì‹œì‘ë©ë‹ˆë‹¤.');
            }
        }
        
        // ì¤‘ê°„ì–´ ì˜ì—­ ê±´ë„ˆë›°ê¸° í•¨ìˆ˜ (ë ˆê±°ì‹œ - í”„ë¡œì íŠ¸ ID ì—†ëŠ” ê²½ìš°)
        function skipIntermediateAreaLegacy(fileName, projectTitle) {
            console.log('ì¤‘ê°„ì–´ ì˜ì—­ ê±´ë„ˆë›°ê¸° (ë ˆê±°ì‹œ):', fileName, projectTitle);
            
            if (confirm('ì¤‘ê°„ì–´ë¥¼ ê±´ë„ˆë›°ê³  ë„ì°©ì–´ ì˜ì—­ì„ ì—½ë‹ˆë‹¤.\nì¶œë°œì–´ > ë„ì°©ì–´ LLM ë²ˆì—­ì„ ì‹œì‘í•©ë‹ˆë‹¤.')) {
                console.log('ì¤‘ê°„ì–´ ì˜ì—­ ê±´ë„ˆë›°ê¸° í™•ì¸ë¨ - ë„ì°©ì–´ ì˜ì—­ ìƒì„± ì‹œì‘');
                
                // ë°”ë¡œ ë„ì°©ì–´ ì˜ì—­ ìƒì„± (ë ˆê±°ì‹œ ë°©ì‹)
                createDestinationLanguageArea(fileName, projectTitle);
                
                alert('ì¤‘ê°„ì–´ ì˜ì—­ì„ ê±´ë„ˆë›°ê³  ë„ì°©ì–´ ì˜ì—­ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.\nLLM ë²ˆì—­ì´ ì‹œì‘ë©ë‹ˆë‹¤.');
            }
        }
        
        // ì¤‘ê°„ì–´ ì˜ì—­ íŒŒì¼ ë¶„í•  í•¨ìˆ˜
        function splitIntermediateFile(fileName, projectTitle) {
            console.log('ì¤‘ê°„ì–´ ì˜ì—­ íŒŒì¼ ë¶„í• :', fileName, projectTitle);
            
            // íŒŒì¼ ë¶„í•  ëª¨ë‹¬ì— íŒŒì¼ëª…ê³¼ íŒŒì¼ ê¸¸ì´ ì„¤ì •
            const splitFileNameInput = document.getElementById('splitFileName');
            const splitFileLengthInput = document.getElementById('splitFileLength');
            
            if (splitFileNameInput) {
                splitFileNameInput.value = fileName.replace('[ë¶„í• ë¨]', '').trim();
            }
            
            if (splitFileLengthInput) {
                splitFileLengthInput.value = '00:45:30'; // ê¸°ë³¸ê°’ ë˜ëŠ” ì‹¤ì œ íŒŒì¼ ê¸¸ì´
            }
            
            // ë¶„í•  ëª¨ë‹¬ ì—´ê¸°
            const modal = document.getElementById('fileSplitModal');
            if (modal) {
                modal.style.display = 'flex';
                
                // í˜„ì¬ í”„ë¡œì íŠ¸ ID ì°¾ê¸°
                const visibleProjectArea = document.querySelector('[id^="worksby-detail-area-"][style*="block"]');
                const currentProjectId = visibleProjectArea ? visibleProjectArea.id.replace('worksby-detail-area-', '') : null;
                
                // ì¤‘ê°„ì–´ ì˜ì—­ ë¶„í• ì„ì„ í‘œì‹œ
                window.currentSplitContext = {
                    area: 'intermediate',
                    fileName: fileName,
                    projectTitle: projectTitle,
                    projectId: currentProjectId
                };
            }
        }
        
        // ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ì‚­ì œ í•¨ìˆ˜
        function deleteWorksbyProject(projectNo, event) {
            // ì´ë²¤íŠ¸ ë²„ë¸”ë§ ë°©ì§€ (í–‰ í´ë¦­ ì´ë²¤íŠ¸ì™€ ì¶©ëŒ ë°©ì§€)
            event.stopPropagation();
            
            if (!confirm('ì´ ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì‚­ì œëœ í”„ë¡œì íŠ¸ëŠ” ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                return;
            }
            
            console.log('ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ì‚­ì œ:', projectNo);
            
            // 1. ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ í…Œì´ë¸”ì—ì„œ í•´ë‹¹ í–‰ ì œê±°
            const projectsTbody = document.getElementById('worksby-projects-tbody');
            if (projectsTbody) {
                const projectRows = projectsTbody.querySelectorAll('tr');
                projectRows.forEach(row => {
                    const deleteButton = row.querySelector(`button[onclick*="${projectNo}"]`);
                    if (deleteButton) {
                        row.remove();
                        console.log('ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ í…Œì´ë¸”ì—ì„œ í–‰ ì‚­ì œë¨');
                    }
                });
            }
            
            // 2. í•´ë‹¹ í”„ë¡œì íŠ¸ì˜ ìƒì„¸ ì˜ì—­ ì œê±°
            const detailArea = document.querySelector(`[id^="worksby-detail-area-${projectNo}"]`);
            if (detailArea) {
                detailArea.remove();
                console.log('ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„¸ ì˜ì—­ ì‚­ì œë¨');
            }
            
            // 3. ì¤‘ê°„ì–´ ì˜ì—­ ì œê±°
            const intermediateArea = document.querySelector(`[id^="intermediate-language-area-${projectNo}"]`);
            if (intermediateArea) {
                intermediateArea.remove();
                console.log('ì¤‘ê°„ì–´ ì˜ì—­ ì‚­ì œë¨');
            }
            
            // 4. ë„ì°©ì–´ ì˜ì—­ ì œê±°
            const destinationContainer = document.querySelector(`[id^="destination-container-${projectNo}"]`);
            if (destinationContainer) {
                destinationContainer.remove();
                console.log('ë„ì°©ì–´ ì˜ì—­ ì‚­ì œë¨');
            }
            
            // 5. íŒŒì¼ ë¦¬ìŠ¤íŠ¸ì˜ ì›ìŠ¤íŒŒì´ ë“±ë¡ ìƒíƒœë¥¼ "ë¯¸ë“±ë¡"ìœ¼ë¡œ ë³€ê²½
            updateFileListWorksbyStatus(projectNo, 'ë¯¸ë“±ë¡');
            
            // 6. í”„ë¡œì íŠ¸ ë°ì´í„° ì €ì¥ì†Œì—ì„œ ì œê±°
            if (window.allProjectsData && window.allProjectsData[projectNo]) {
                delete window.allProjectsData[projectNo];
                console.log('í”„ë¡œì íŠ¸ ë°ì´í„° ì €ì¥ì†Œì—ì„œ ì œê±°ë¨:', projectNo);
            }
            
            // 7. ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ê°€ ëª¨ë‘ ì‚­ì œëœ ê²½ìš° ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            const remainingProjects = document.querySelectorAll('#worksby-projects-tbody tr');
            if (remainingProjects.length === 0) {
                const worksbySection = document.getElementById('worksby-projects-section');
                if (worksbySection) {
                    worksbySection.style.display = 'none';
                }
                console.log('ëª¨ë“  ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ê°€ ì‚­ì œë˜ì–´ ì„¹ì…˜ì„ ìˆ¨ê¹€');
            }
            
            alert('ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.\níŒŒì¼ ë¦¬ìŠ¤íŠ¸ì˜ ì›ìŠ¤íŒŒì´ ë“±ë¡ ìƒíƒœê°€ "ë¯¸ë“±ë¡"ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }
        
        // íŒŒì¼ ë¦¬ìŠ¤íŠ¸ì˜ ì›ìŠ¤íŒŒì´ ë“±ë¡ ìƒíƒœ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateFileListWorksbyStatus(projectNo, status) {
            console.log('íŒŒì¼ ë¦¬ìŠ¤íŠ¸ ì›ìŠ¤íŒŒì´ ìƒíƒœ ì—…ë°ì´íŠ¸:', projectNo, status);
            
            // í•´ë‹¹ í”„ë¡œì íŠ¸ì˜ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const projectData = window.allProjectsData?.[projectNo];
            if (!projectData || !projectData.selectedFiles) {
                console.log('í”„ë¡œì íŠ¸ ë°ì´í„° ë˜ëŠ” ì„ íƒëœ íŒŒì¼ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', projectNo);
                return;
            }
            
            const selectedFileIds = projectData.selectedFiles;
            console.log('ì‚­ì œí•  í”„ë¡œì íŠ¸ì˜ ì„ íƒëœ íŒŒì¼ IDë“¤:', selectedFileIds);
            
            // ë©”ì¸ íŒŒì¼ ë¦¬ìŠ¤íŠ¸ í…Œì´ë¸” ì°¾ê¸°
            const mainFileTable = document.querySelector('.main-file-table tbody');
            if (!mainFileTable) {
                console.log('ë©”ì¸ íŒŒì¼ í…Œì´ë¸”ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const rows = mainFileTable.querySelectorAll('tr');
            console.log(`ë©”ì¸ íŒŒì¼ í…Œì´ë¸”ì—ì„œ ${rows.length}ê°œì˜ í–‰ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤.`);
            
            rows.forEach((row, index) => {
                // ê° í–‰ì˜ data-file-id ì†ì„± í™•ì¸
                const fileId = row.getAttribute('data-file-id');
                
                // í•´ë‹¹ í”„ë¡œì íŠ¸ì— í¬í•¨ëœ íŒŒì¼ì¸ì§€ í™•ì¸
                if (selectedFileIds.includes(fileId)) {
                    console.log(`í”„ë¡œì íŠ¸ì— í¬í•¨ëœ íŒŒì¼ ë°œê²¬: ID ${fileId}`);
                    
                    // ì›ìŠ¤íŒŒì´ ì»¬ëŸ¼ (7ë²ˆì§¸ ì»¬ëŸ¼)
                    const worksbyCell = row.querySelector('td:nth-child(7)');
                    if (worksbyCell) {
                        const currentStatus = worksbyCell.textContent.trim();
                        console.log(`íŒŒì¼ ID ${fileId}: í˜„ì¬ ì›ìŠ¤íŒŒì´ ìƒíƒœ = "${currentStatus}"`);
                        
                        // "ë“±ë¡" ìƒíƒœì¸ ê²½ìš°ë§Œ "ë¯¸ë“±ë¡"ìœ¼ë¡œ ë³€ê²½
                        if (currentStatus === 'ë“±ë¡') {
                            const statusBadge = worksbyCell.querySelector('.status-badge');
                            if (statusBadge) {
                                statusBadge.textContent = status;
                                statusBadge.style.cssText = 'background: #f3f4f6; color: #6b7280; padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;';
                            } else {
                                worksbyCell.innerHTML = `<span class="status-badge" style="background: #f3f4f6; color: #6b7280; padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;">${status}</span>`;
                            }
                            const fileName = row.querySelector('td:nth-child(2)')?.textContent || 'ì•Œ ìˆ˜ ì—†ëŠ” íŒŒì¼';
                            console.log(`íŒŒì¼ ì›ìŠ¤íŒŒì´ ìƒíƒœ ì—…ë°ì´íŠ¸ë¨: ${fileName} (ID: ${fileId}) -> ${status}`);
                        }
                    }
                }
            });
        }
        
        // ì¶œë°œì–´ ì˜ì—­ ì§„í–‰ìƒíƒœ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateSourceAreaProgressStatus(fileName, status) {
            console.log('ì¶œë°œì–´ ì˜ì—­ ì§„í–‰ìƒíƒœ ì—…ë°ì´íŠ¸:', fileName, status);
            
            // í˜„ì¬ í‘œì‹œëœ í”„ë¡œì íŠ¸ ID ì°¾ê¸°
            const visibleProjectArea = document.querySelector('[id^="worksby-detail-area-"][style*="block"]');
            if (!visibleProjectArea) {
                console.log('í‘œì‹œëœ í”„ë¡œì íŠ¸ ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const currentProjectId = visibleProjectArea.id.replace('worksby-detail-area-', '');
            console.log(`í˜„ì¬ í”„ë¡œì íŠ¸ ID: ${currentProjectId}`);
            
            const detailTbody = document.getElementById(`detail-tbody-${currentProjectId}`);
            if (!detailTbody) {
                console.log(`ì¶œë°œì–´ ì˜ì—­ í…Œì´ë¸”ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: detail-tbody-${currentProjectId}`);
                return;
            }
            
            const rows = detailTbody.querySelectorAll('tr');
            rows.forEach(row => {
                // í”„ë¡œì íŠ¸ëª… ì»¬ëŸ¼ì´ ì¶”ê°€ë˜ì–´ íŒŒì¼ëª…ì€ ë‘ ë²ˆì§¸ ì…€
                const fileNameCell = row.querySelector('td:nth-child(2)') || row.querySelector('.file-name');
                if (fileNameCell) {
                    const currentFileName = fileNameCell.textContent.replace('â†’ ', '').replace('[ë¶„í• ë¨]', '').trim();
                    if (currentFileName === fileName) {
                        // ì§„í–‰ìƒíƒœ ì»¬ëŸ¼ ì°¾ê¸° (ë§ˆì§€ë§‰ ì»¬ëŸ¼)
                        const progressCell = row.querySelector('td:last-child');
                        if (progressCell) {
                            // ë°°ì§€ ìŠ¤íƒ€ì¼ë¡œ ì—…ë°ì´íŠ¸
                            const badgeColor = status === 'ê²€ìˆ˜ì™„ë£Œ' ? '#10b981' : '#6b7280';
                            progressCell.innerHTML = `<span style="background: ${badgeColor}; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;">${status}</span>`;
                            console.log(`ì¶œë°œì–´ ì˜ì—­ "${fileName}" ì§„í–‰ìƒíƒœ ì—…ë°ì´íŠ¸ ì™„ë£Œ: ${status}`);
                        }
                    }
                }
            });
        }
        
        // íŒŒì¼ í•©ì¹˜ê¸° í•¨ìˆ˜ (ë¶„í• ëœ ì›ë³¸ íŒŒì¼ìš©)
        function mergeFiles(fileName, projectTitle) {
            console.log('íŒŒì¼ í•©ì¹˜ê¸° ì‹¤í–‰:', fileName, projectTitle);
            
            if (confirm(`${fileName} íŒŒì¼ì˜ ë¶„í• ëœ êµ¬ê°„ë“¤ì„ í•©ì¹˜ëŠ” ê²€ìˆ˜íˆ´ì„ ì‹¤í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                // ì¶œë°œì–´ ì˜ì—­ì˜ ì§„í–‰ìƒíƒœë¥¼ "ê²€ìˆ˜ì™„ë£Œ"ë¡œ ë³€ê²½
                updateSourceAreaProgressStatus(fileName, 'ê²€ìˆ˜ì™„ë£Œ');
                
                // ì¤‘ê°„ì–´ ì˜ì—­ ìƒì„±
                createIntermediateLanguageAreaFromWorksby(fileName, projectTitle);
                alert(`${fileName} íŒŒì¼ì˜ ê²€ìˆ˜íˆ´ì´ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤.\nì¶œë°œì–´ ì˜ì—­ ì§„í–‰ìƒíƒœê°€ "ê²€ìˆ˜ì™„ë£Œ"ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.\nì¤‘ê°„ì–´ ì˜ì—­ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }
        }
        
        // ì›ìŠ¤íŒŒì´ì—ì„œ ì¤‘ê°„ì–´ ì˜ì—­ ìƒì„± í•¨ìˆ˜
        function createIntermediateLanguageAreaFromWorksby(fileName, projectTitle) {
            console.log('ì›ìŠ¤íŒŒì´ì—ì„œ ì¤‘ê°„ì–´ ì˜ì—­ ìƒì„±:', fileName, projectTitle);
            
            // í˜„ì¬ í‘œì‹œëœ í”„ë¡œì íŠ¸ ID ì°¾ê¸°
            const visibleProjectArea = document.querySelector('[id^="worksby-detail-area-"][style*="block"]');
            if (!visibleProjectArea) {
                console.log('í‘œì‹œëœ í”„ë¡œì íŠ¸ ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const currentProjectId = visibleProjectArea.id.replace('worksby-detail-area-', '');
            console.log(`ì¤‘ê°„ì–´ ì˜ì—­ ìƒì„± - í˜„ì¬ í”„ë¡œì íŠ¸ ID: ${currentProjectId}`);
            
            // ì›ìŠ¤íŒŒì´ ìƒì„¸ ì˜ì—­ì—ì„œ íŒŒì¼ ëª©ë¡ ìˆ˜ì§‘ (ì¤‘ê°„ì–´ ì˜ì—­ì—ì„œëŠ” ë¶„í• í•˜ì§€ ì•Šê³  ì›ë³¸ íŒŒì¼ë§Œ)
            const detailTbody = document.getElementById(`detail-tbody-${currentProjectId}`);
            const allFiles = [];
            let hasTreeStructure = false;
            
            if (detailTbody) {
                const rows = detailTbody.querySelectorAll('tr');
                rows.forEach(row => {
                    if (row.classList.contains('tree-parent')) {
                        hasTreeStructure = true;
                        // ë¶„í• ëœ íŒŒì¼ì˜ ê²½ìš° ì›ë³¸ íŒŒì¼ëª…ë§Œ ì¶”ê°€ (ì¤‘ê°„ì–´ì—ì„œëŠ” ë¶„í• í•˜ì§€ ì•ŠìŒ)
                        const fileNameCell = row.querySelector('.file-name') || row.querySelector('td:nth-child(2)');
                        if (fileNameCell) {
                            const originalFileName = fileNameCell.textContent.replace('[ë¶„í• ë¨]', '').trim();
                            allFiles.push(originalFileName);
                        }
                    } else if (!row.classList.contains('tree-child')) {
                        // ì¼ë°˜ íŒŒì¼ë“¤ (ë¶„í• ëœ ìì‹ íŒŒì¼ë“¤ì€ ì œì™¸)
                        const fileNameCell = row.querySelector('.file-name') || row.querySelector('td:nth-child(2)');
                        if (fileNameCell) {
                            const currentFileName = fileNameCell.textContent.replace('â†’ ', '').replace('[ë¶„í• ë¨]', '').trim();
                            allFiles.push(currentFileName);
                        }
                    }
                });
            }
            
            console.log('ì›ìŠ¤íŒŒì´ ìƒì„¸ ì˜ì—­ì—ì„œ ìˆ˜ì§‘ëœ íŒŒì¼ë“¤:', allFiles);
            console.log('íŠ¸ë¦¬ êµ¬ì¡° ì¡´ì¬ ì—¬ë¶€:', hasTreeStructure);
            
            // ì‹œë‚˜ë¦¬ì˜¤ êµ¬ë¶„
            const isMultipleFiles = allFiles.length > 1 && !hasTreeStructure;
            const isSingleFile = allFiles.length === 1 && !hasTreeStructure;
            const isSplitFile = hasTreeStructure;
            
            // í˜„ì¬ í”„ë¡œì íŠ¸ì˜ ìƒì„¸ ì˜ì—­ í•˜ë‹¨ì— ì¤‘ê°„ì–´ ì˜ì—­ ì¶”ê°€
            const detailArea = document.getElementById(`worksby-detail-area-${currentProjectId}`);
            if (!detailArea) {
                console.log(`í”„ë¡œì íŠ¸ ìƒì„¸ ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: worksby-detail-area-${currentProjectId}`);
                return;
            }
            
            // ì¤‘ê°„ì–´ ì˜ì—­ì´ ì´ë¯¸ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸ (í”„ë¡œì íŠ¸ë³„ ê³ ìœ  ID)
            let intermediateArea = document.getElementById(`intermediate-language-area-${currentProjectId}`);
            if (!intermediateArea) {
                intermediateArea = document.createElement('div');
                intermediateArea.id = `intermediate-language-area-${currentProjectId}`;
                intermediateArea.style.cssText = 'margin-top: 20px;';
                detailArea.appendChild(intermediateArea);
            }
            
            // ì¤‘ê°„ì–´ ì˜ì—­ ë‚´ìš© ìƒì„±
            intermediateArea.innerHTML = `
                <div class="work-area-container">
                    <div class="work-area-header">
                        <h2 class="work-area-title">ğŸ”„ ì¤‘ê°„ì–´ ì˜ì—­</h2>
                    </div>
                    <div class="work-area-content">
                        <div style="background: #fff3cd; padding: 15px 20px; border-bottom: 1px solid #e5e7eb;">
                            <h3 style="margin: 0; font-size: 16px; font-weight: 600; color: #f59e0b;">ğŸ”„ ì¤‘ê°„ì–´ ì˜ì—­</h3>
                        </div>
                        <table class="file-table" style="table-layout: fixed; width: 100%; margin-bottom: 0;">
                            <thead>
                                <tr>
                                    <th style="width: 16%;">í”„ë¡œì íŠ¸ëª…</th>
                                    <th style="width: 21%;">íŒŒì¼ ì´ë¦„</th>
                                    <th style="width: 5%;">ì¶œë°œì–´</th>
                                    <th style="width: 5%;">ì¤‘ê°„ì–´</th>
                                    <th style="width: 7%;">ì‘ì—… ì‹œê°„</th>
                                    <th style="width: 7%; text-align: center;">ì›ìŠ¤íŒŒì´ ë“±ë¡</th>
                                    <th style="width: 10%; text-align: center;">ì‘ì—…ì(ìƒíƒœ)</th>
                                    <th style="width: 7%; text-align: center;">ì‘ì—…ì ë°°ì •</th>
                                    <th style="width: 10%; text-align: center;">ì „ì‚¬íˆ´</th>
                                    <th style="width: 7%; text-align: center;">ì‚°ì¶œë¬¼</th>
                                    <th style="width: 5%; text-align: center;">ì§„í–‰ìƒíƒœ</th>
                                </tr>
                            </thead>
                            <tbody id="intermediate-tbody-${currentProjectId}">
                                <!-- ì¤‘ê°„ì–´ ì˜ì—­ íŒŒì¼ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                            </tbody>
                        </table>
                        
                        <!-- ì¤‘ê°„ì–´ ì˜ì—­ ë²„íŠ¼ë“¤ (í…Œì´ë¸” ì•„ë˜) -->
                        <div style="padding: 15px 20px; border-top: 1px solid #e5e7eb; background: #f8f9fa; display: flex; justify-content: space-between; align-items: center;">
                            <!-- ì™¼ìª½ ì •ë ¬ ë²„íŠ¼ -->
                            <div>
                                <button class="btn" onclick="skipIntermediateArea('${fileName}', '${projectTitle}', '${currentProjectId}')" 
                                        style="background: #f97316; color: white; padding: 8px 16px; font-size: 14px; border: none; border-radius: 6px; cursor: pointer;">
                                    <span>â­ï¸</span>
                                    ì¤‘ê°„ì–´ ì˜ì—­ ê±´ë„ˆë›°ê¸°
                                </button>
                            </div>
                            
                            <!-- ì˜¤ë¥¸ìª½ ì •ë ¬ ë²„íŠ¼ë“¤ -->
                            <div style="display: flex; gap: 10px;">
                                ${(isSingleFile || isSplitFile) 
                                    ? `<button class="btn btn-warning" onclick="splitIntermediateFile('${fileName}', '${projectTitle}')" 
                                              style="padding: 8px 16px; font-size: 14px;">
                                          <span>âœ‚ï¸</span>
                                          íŒŒì¼ ë¶„í• 
                                      </button>`
                                    : ''
                                }
                                <button class="btn" onclick="createIntermediateWorksbyProject('${fileName}', '${projectTitle}')" 
                                        style="background: #8b5cf6; color: white; padding: 8px 16px; font-size: 14px; border: none; border-radius: 6px; cursor: pointer;">
                                    <span>ğŸš€</span>
                                    ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„±
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // ì¤‘ê°„ì–´ ì˜ì—­ íŒŒì¼ í–‰ë“¤ì„ ë™ì ìœ¼ë¡œ ì¶”ê°€ (ì›ë³¸ íŒŒì¼ë§Œ, ë¶„í• í•˜ì§€ ì•ŠìŒ)
            const intermediateTbody = document.getElementById(`intermediate-tbody-${currentProjectId}`);
            if (intermediateTbody) {
                allFiles.forEach((file, index) => {
                    const row = document.createElement('tr');
                    
                    // ê° ì…€ì„ ê°œë³„ì ìœ¼ë¡œ ìƒì„±
                    const projectNameCell = document.createElement('td');
                    projectNameCell.style.textAlign = 'center';
                    projectNameCell.textContent = ''; // ì´ˆê¸°ì—ëŠ” ë¹„ì–´ìˆìŒ, ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„± í›„ ì±„ì›Œì§
                    projectNameCell.id = 'intermediate-project-' + index;
                    
                    const fileNameCell = document.createElement('td');
                    fileNameCell.className = 'file-name';
                    fileNameCell.textContent = file;
                    
                    const sourceCell = document.createElement('td');
                    sourceCell.style.textAlign = 'center';
                    sourceCell.textContent = 'í•œê¸€';
                    
                    const targetCell = document.createElement('td');
                    targetCell.style.textAlign = 'center';
                    targetCell.textContent = 'ì˜ì–´';
                    
                    const timeCell = document.createElement('td');
                    timeCell.style.textAlign = 'center';
                    timeCell.textContent = '00:45:30';
                    
                    const registerCell = document.createElement('td');
                    registerCell.style.textAlign = 'center';
                    registerCell.id = 'intermediate-register-' + index;
                    registerCell.innerHTML = '<span style="color: #9ca3af;">-</span>';
                    
                    const workerCell = document.createElement('td');
                    workerCell.style.textAlign = 'center';
                    workerCell.style.fontSize = '12px';
                    workerCell.style.color = '#6b7280';
                    workerCell.textContent = '- (ëŒ€ê¸°)';
                    
                    const assignCell = document.createElement('td');
                    assignCell.style.textAlign = 'center';
                    
                    // ì²« ë²ˆì§¸ íŒŒì¼ì—ë§Œ ì‘ì—…ì ë°°ì • ë²„íŠ¼ í‘œì‹œ (ì‹œë‚˜ë¦¬ì˜¤ 3)
                    if (index === 0) {
                        assignCell.innerHTML = '<button class="btn" onclick="assignNewWorker(\'' + file + '\', \'' + projectTitle + '\')" style="background: #8b5cf6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">ì‘ì—…ì ë°°ì •</button>';
                    } else {
                        assignCell.innerHTML = '<span style="color: #9ca3af;">-</span>';
                    }
                    
                    const toolsCell = document.createElement('td');
                    toolsCell.style.textAlign = 'center';
                    toolsCell.innerHTML = '<div style="display: flex; gap: 4px; justify-content: center; flex-wrap: nowrap;"><button class="btn" onclick="executeTranscription(\'' + file + '\')" style="background: #3b82f6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer;">ì „ì‚¬íˆ´ ì‹¤í–‰</button><button class="btn" onclick="executeReview(\'' + file + '\')" style="background: #10b981; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer;">ê²€ìˆ˜íˆ´ ì‹¤í–‰</button></div>';
                    
                    const outputCell = document.createElement('td');
                    outputCell.style.textAlign = 'center';
                    outputCell.innerHTML = '<button class="btn" onclick="downloadOutput(\'' + file + '\')" style="background: #f59e0b; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">ì‚°ì¶œë¬¼ ë‹¤ìš´ë¡œë“œ</button>';
                    
                    const statusCell = document.createElement('td');
                    statusCell.style.textAlign = 'center';
                    statusCell.innerHTML = '<span class="status-badge" style="background: #e5e7eb; color: #374151; padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;">ëŒ€ê¸°</span>';
                    
                    // ëª¨ë“  ì…€ì„ í–‰ì— ì¶”ê°€
                    row.appendChild(projectNameCell);
                    row.appendChild(fileNameCell);
                    row.appendChild(sourceCell);
                    row.appendChild(targetCell);
                    row.appendChild(timeCell);
                    row.appendChild(registerCell);
                    row.appendChild(workerCell);
                    row.appendChild(assignCell);
                    row.appendChild(toolsCell);
                    row.appendChild(outputCell);
                    row.appendChild(statusCell);
                    
                    intermediateTbody.appendChild(row);
                });
            }
            
            console.log('ì¤‘ê°„ì–´ ì˜ì—­ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.');
            
            // í•˜ë‹¨ ì˜ì—­ì„ ìµœí•˜ë‹¨ìœ¼ë¡œ ì´ë™
            ensureBottomSectionsAtEnd();
        }
        
        // ì¶œë°œì–´ ì˜ì—­ì˜ ëª¨ë“  ì›ìŠ¤íŒŒì´ ë“±ë¡ ì™„ë£Œ ì—¬ë¶€ í™•ì¸
        function checkAllRegistrationComplete() {
            console.log('ì›ìŠ¤íŒŒì´ ë“±ë¡ ì™„ë£Œ ì—¬ë¶€ í™•ì¸ ì‹œì‘');
            
            const detailTbody = document.getElementById('detail-tbody');
            if (!detailTbody) {
                console.log('ì¶œë°œì–´ ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return false;
            }
            
            const rows = detailTbody.querySelectorAll('tr');
            console.log('ì¶œë°œì–´ ì˜ì—­ íŒŒì¼ í–‰ ìˆ˜:', rows.length);
            
            let incompleteFiles = [];
            
            rows.forEach((row, index) => {
                const fileNameCell = row.querySelector('.file-name');
                const registerCell = row.querySelector('td:nth-child(4)'); // ì¶œë°œì–´ ì˜ì—­ ì›ìŠ¤íŒŒì´ ë“±ë¡ ì»¬ëŸ¼
                const button = registerCell ? registerCell.querySelector('button') : null;
                
                if (fileNameCell && button) {
                    const fileName = fileNameCell.textContent.replace('â†’ ', '').trim();
                    const buttonText = button.textContent.trim();
                    
                    console.log(`íŒŒì¼ ${index + 1}: ${fileName} - ë²„íŠ¼ ìƒíƒœ: ${buttonText}`);
                    
                    // ë²„íŠ¼ í…ìŠ¤íŠ¸ê°€ "ë“±ë¡"ì¸ ê²½ìš° (ë“±ë¡ í™•ì¸ì´ ì•„ë‹Œ ê²½ìš°)
                    if (buttonText.includes('ë“±ë¡') && !buttonText.includes('ë“±ë¡ í™•ì¸')) {
                        incompleteFiles.push(fileName);
                    }
                }
            });
            
            console.log('ë“±ë¡ ë¯¸ì™„ë£Œ íŒŒì¼ë“¤:', incompleteFiles);
            
            if (incompleteFiles.length > 0) {
                console.log(`ë“±ë¡ì´ ì™„ë£Œë˜ì§€ ì•Šì€ íŒŒì¼ ${incompleteFiles.length}ê°œ ë°œê²¬`);
                return false;
            }
            
            console.log('ëª¨ë“  íŒŒì¼ì˜ ì›ìŠ¤íŒŒì´ ë“±ë¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
            return true;
        }
        
        // ì¤‘ê°„ì–´ ì˜ì—­ ìƒì„± í•¨ìˆ˜ (ì¶œë°œì–´ ì˜ì—­ì˜ ëª¨ë“  íŒŒì¼ í¬í•¨)
        function createIntermediateLanguageArea(fileName, projectTitle) {
            console.log('ì¤‘ê°„ì–´ ì˜ì—­ ìƒì„±:', fileName, projectTitle);
            
            // ì¶œë°œì–´ ì˜ì—­ì—ì„œ íŒŒì¼ ëª©ë¡ ìˆ˜ì§‘ ë° ì‹œë‚˜ë¦¬ì˜¤ êµ¬ë¶„
            const detailTbody = document.getElementById('detail-tbody');
            const allFiles = [];
            let hasTreeStructure = false; // ë¶„í• ëœ íŒŒì¼(íŠ¸ë¦¬ êµ¬ì¡°)ì´ ìˆëŠ”ì§€ í™•ì¸
            
            if (detailTbody) {
                const rows = detailTbody.querySelectorAll('tr');
                rows.forEach(row => {
                    if (row.classList.contains('tree-parent')) {
                        hasTreeStructure = true; // ì‹œë‚˜ë¦¬ì˜¤ 1: íŒŒì¼ ë¶„í• 
                        // ë¶„í• ëœ íŒŒì¼ì˜ ê²½ìš° ì›ë³¸ íŒŒì¼ëª… ì¶”ê°€
                        const fileNameCell = row.querySelector('.file-name') || row.querySelector('td:nth-child(2)');
                        if (fileNameCell) {
                            const originalFileName = fileNameCell.textContent.replace('[ë¶„í• ë¨]', '').trim();
                            allFiles.push(originalFileName);
                        }
                    } else if (!row.classList.contains('tree-child')) {
                        // tree-parentë„ tree-childë„ ì•„ë‹Œ ì¼ë°˜ íŒŒì¼ë“¤ (ì‹œë‚˜ë¦¬ì˜¤ 2, 3)
                        const fileNameCell = row.querySelector('.file-name') || row.querySelector('td:nth-child(2)');
                        if (fileNameCell) {
                            const currentFileName = fileNameCell.textContent.replace('â†’ ', '').replace('[ë¶„í• ë¨]', '').trim();
                            allFiles.push(currentFileName);
                        }
                    }
                });
            }
            
            console.log('ì¶œë°œì–´ ì˜ì—­ì—ì„œ ìˆ˜ì§‘ëœ íŒŒì¼ë“¤:', allFiles);
            console.log('íŠ¸ë¦¬ êµ¬ì¡° ì¡´ì¬ ì—¬ë¶€ (ë¶„í•  íŒŒì¼):', hasTreeStructure);
            
            // ì‹œë‚˜ë¦¬ì˜¤ êµ¬ë¶„
            const isMultipleFiles = allFiles.length > 1 && !hasTreeStructure; // ì‹œë‚˜ë¦¬ì˜¤ 3: ë³µìˆ˜ íŒŒì¼ (ë¶„í•  ì•„ë‹˜)
            const isSingleFile = allFiles.length === 1 && !hasTreeStructure; // ì‹œë‚˜ë¦¬ì˜¤ 2: ë‹¨ì¼ íŒŒì¼
            const isSplitFile = hasTreeStructure; // ì‹œë‚˜ë¦¬ì˜¤ 1: ë¶„í•  íŒŒì¼
            
            console.log(`ì‹œë‚˜ë¦¬ì˜¤ êµ¬ë¶„: ë¶„í• íŒŒì¼=${isSplitFile}, ë‹¨ì¼íŒŒì¼=${isSingleFile}, ë³µìˆ˜íŒŒì¼=${isMultipleFiles}`);
            
            // ì¶œë°œì–´ ì˜ì—­ í•˜ë‹¨ì— ì¤‘ê°„ì–´ ì˜ì—­ ì¶”ê°€
            const detailArea = document.getElementById('template-detail-area');
            if (!detailArea) return;
            
            // ì¤‘ê°„ì–´ ì˜ì—­ì´ ì´ë¯¸ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
            let intermediateArea = document.getElementById('intermediate-language-area');
            if (!intermediateArea) {
                intermediateArea = document.createElement('div');
                intermediateArea.id = 'intermediate-language-area';
                intermediateArea.style.cssText = 'margin-top: 20px;';
                detailArea.appendChild(intermediateArea);
            }
            
            // ì¤‘ê°„ì–´ ì˜ì—­ ë‚´ìš© ìƒì„±
            intermediateArea.innerHTML = `
                <div class="work-area-container">
                    <div class="work-area-header">
                        <h2 class="work-area-title">ğŸ”„ ì¤‘ê°„ì–´ ì˜ì—­</h2>
                    </div>
                    <div class="work-area-content">
                        <div style="background: #fff3cd; padding: 15px 20px; border-bottom: 1px solid #e5e7eb; display: flex; justify-content: space-between; align-items: center;">
                            <h3 style="margin: 0; font-size: 16px; font-weight: 600; color: #f59e0b;">ğŸ”„ ì¤‘ê°„ì–´ ì˜ì—­</h3>
                            ${(isSingleFile || isSplitFile) 
                                ? `<button class="btn btn-warning" onclick="splitIntermediateFile('${fileName}', '${projectTitle}')" 
                                          style="padding: 8px 16px; font-size: 14px;">
                                      <span>âœ‚ï¸</span>
                                      íŒŒì¼ ë¶„í• 
                                  </button>`
                                : ''
                            }
                        </div>
                    <table class="file-table" style="table-layout: fixed; width: 100%; margin-bottom: 0;">
                        <thead>
                            <tr>
                                <th style="width: 5%;">í”„ë¡œì íŠ¸ëª…</th>
                                <th style="width: 15%;">íŒŒì¼ ì´ë¦„</th>
                                <th style="width: 8%;">ì¶œë°œì–´</th>
                                <th style="width: 8%;">ì¤‘ê°„ì–´</th>
                                <th style="width: 9%;">ì‘ì—… ì‹œê°„</th>
                                <th style="width: 10%; text-align: center;">ì›ìŠ¤íŒŒì´ ë“±ë¡</th>
                                <th style="width: 10%; text-align: center;">ì‘ì—…ì(ìƒíƒœ)</th>
                                <th style="width: 11%; text-align: center;">ìƒˆ ì‘ì—…ì ë°°ì •</th>
                                <th style="width: 13%; text-align: center;">ì „ì‚¬íˆ´</th>
                                <th style="width: 11%; text-align: center;">ì‚°ì¶œë¬¼</th>
                                <th style="width: 6%; text-align: center;">ì§„í–‰ ìƒíƒœ</th>
                            </tr>
                        </thead>
                        <tbody id="intermediate-tbody">
                            <!-- ì¤‘ê°„ì–´ ì˜ì—­ íŒŒì¼ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                        </tbody>
                        </table>
                        
                        <!-- ì¤‘ê°„ì–´ ì˜ì—­ ë²„íŠ¼ë“¤ (í…Œì´ë¸” ì•„ë˜) -->
                        <div style="padding: 15px 20px; border-top: 1px solid #e5e7eb; background: #f8f9fa; display: flex; justify-content: space-between; align-items: center;">
                            <!-- ì™¼ìª½ ì •ë ¬ ë²„íŠ¼ -->
                            <div>
                                <button class="btn" onclick="skipIntermediateAreaLegacy('${fileName}', '${projectTitle}')" 
                                        style="background: #f97316; color: white; padding: 8px 16px; font-size: 14px; border: none; border-radius: 6px; cursor: pointer;">
                                    <span>â­ï¸</span>
                                    ì¤‘ê°„ì–´ ì˜ì—­ ê±´ë„ˆë›°ê¸°
                                </button>
                            </div>
                            
                            <!-- ì˜¤ë¥¸ìª½ ì •ë ¬ ë²„íŠ¼ë“¤ -->
                            <div style="display: flex; gap: 10px;">
                                ${(isSingleFile || isSplitFile) 
                                    ? `<button class="btn btn-warning" onclick="splitIntermediateFile('${fileName}', '${projectTitle}')" 
                                              style="padding: 8px 16px; font-size: 14px;">
                                          <span>âœ‚ï¸</span>
                                          íŒŒì¼ ë¶„í• 
                                      </button>`
                                    : ''
                                }
                                <button class="btn" onclick="createIntermediateWorksbyProject('${fileName}', '${projectTitle}')" 
                                        style="background: #8b5cf6; color: white; padding: 8px 16px; font-size: 14px; border: none; border-radius: 6px; cursor: pointer;">
                                    <span>ğŸš€</span>
                                    ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„±
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // ì¤‘ê°„ì–´ ì˜ì—­ íŒŒì¼ í–‰ë“¤ì„ ë™ì ìœ¼ë¡œ ì¶”ê°€
            const intermediateTbody = document.getElementById('intermediate-tbody');
            if (intermediateTbody) {
                allFiles.forEach((file, index) => {
                    const row = document.createElement('tr');
                    
                    // ê° ì…€ì„ ê°œë³„ì ìœ¼ë¡œ ìƒì„±
                    const projectNameCell = document.createElement('td');
                    projectNameCell.style.textAlign = 'center';
                    projectNameCell.textContent = ''; // ì´ˆê¸°ì—ëŠ” ë¹„ì–´ìˆìŒ, ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ìƒì„± í›„ ì±„ì›Œì§
                    projectNameCell.id = 'intermediate-project-' + index;
                    
                    const fileNameCell = document.createElement('td');
                    fileNameCell.className = 'file-name';
                    fileNameCell.textContent = file;
                    
                    const sourceCell = document.createElement('td');
                    sourceCell.style.textAlign = 'center';
                    sourceCell.textContent = 'í•œê¸€';
                    
                    const targetCell = document.createElement('td');
                    targetCell.style.textAlign = 'center';
                    targetCell.textContent = 'ì˜ì–´';
                    
                    const timeCell = document.createElement('td');
                    timeCell.style.textAlign = 'center';
                    timeCell.textContent = '00:45:30';
                    
                    const registerCell = document.createElement('td');
                    registerCell.style.textAlign = 'center';
                    registerCell.id = 'intermediate-register-' + index;
                    registerCell.innerHTML = '<span style="color: #9ca3af;">-</span>';
                    
                    const workerCell = document.createElement('td');
                    workerCell.style.textAlign = 'center';
                    workerCell.style.fontSize = '12px';
                    workerCell.style.color = '#6b7280';
                    workerCell.textContent = '- (ëŒ€ê¸°)';
                    
                    const assignCell = document.createElement('td');
                    assignCell.style.textAlign = 'center';
                    
                    // ì²« ë²ˆì§¸ íŒŒì¼ì—ë§Œ ì‘ì—…ì ë°°ì • ë²„íŠ¼ í‘œì‹œ (ì‹œë‚˜ë¦¬ì˜¤ 3)
                    if (index === 0) {
                        assignCell.innerHTML = '<button class="btn" onclick="assignNewWorker(\'' + file + '\', \'' + projectTitle + '\')" style="background: #8b5cf6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">ì‘ì—…ì ë°°ì •</button>';
                    } else {
                        assignCell.innerHTML = '<span style="color: #9ca3af;">-</span>';
                    }
                    
                    const toolsCell = document.createElement('td');
                    toolsCell.style.textAlign = 'center';
                    toolsCell.innerHTML = '<div style="display: flex; gap: 4px; justify-content: center; flex-wrap: nowrap;"><button class="btn" onclick="executeTranscription(\'' + file + '\')" style="background: #3b82f6; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer;">ì „ì‚¬íˆ´ ì‹¤í–‰</button><button class="btn" onclick="executeReview(\'' + file + '\')" style="background: #10b981; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer;">ê²€ìˆ˜íˆ´ ì‹¤í–‰</button></div>';
                    
                    const outputCell = document.createElement('td');
                    outputCell.style.textAlign = 'center';
                    outputCell.innerHTML = '<button class="btn" onclick="downloadOutput(\'' + file + '\')" style="background: #f59e0b; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; margin: 0 auto; display: inline-block;">ì‚°ì¶œë¬¼ ë‹¤ìš´ë¡œë“œ</button>';
                    
                    const statusCell = document.createElement('td');
                    statusCell.style.textAlign = 'center';
                    statusCell.innerHTML = '<span class="status-badge" style="background: #e5e7eb; color: #374151; padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;">ëŒ€ê¸°</span>';
                    
                    // ëª¨ë“  ì…€ì„ í–‰ì— ì¶”ê°€
                    row.appendChild(projectNameCell);
                    row.appendChild(fileNameCell);
                    row.appendChild(sourceCell);
                    row.appendChild(targetCell);
                    row.appendChild(timeCell);
                    row.appendChild(registerCell);
                    row.appendChild(workerCell);
                    row.appendChild(assignCell);
                    row.appendChild(toolsCell);
                    row.appendChild(outputCell);
                    row.appendChild(statusCell);
                    
                    intermediateTbody.appendChild(row);
                });
            }
            
            console.log('ì¤‘ê°„ì–´ ì˜ì—­ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.');
            
            // í•˜ë‹¨ ì˜ì—­ì„ ìµœí•˜ë‹¨ìœ¼ë¡œ ì´ë™
            ensureBottomSectionsAtEnd();
        }
        
        // íŒŒì¼ ì„¸íŒ… ì™„ë£Œ íŒŒì¼ì—ì„œ ì„ íƒ ì‹œ ë°”ë¡œ ì¶œë°œì–´ ì˜ì—­ ì—´ê¸° (ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)
        function selectTemplate(projectTitle, files) {
            console.log('selectTemplate í•¨ìˆ˜ í˜¸ì¶œë¨ - íŒŒì¼ ì„¸íŒ… ì™„ë£Œ íŒŒì¼ ì˜ì—­ ì œê±°ë¡œ ì¸í•´ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ');
            // íŒŒì¼ ì„¸íŒ… ì™„ë£Œ íŒŒì¼ ì˜ì—­ì´ ì œê±°ë˜ì–´ ì´ í•¨ìˆ˜ëŠ” ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
        }
        
        
        
    </script>

    <!-- í”„ë¡œì íŠ¸ ìƒì„¸ì •ë³´ ëª¨ë‹¬ -->
    <div id="projectDetailModal" class="modal-overlay" style="display: none;">
        <div class="modal-container detail-modal" style="max-width: 1000px; width: 95%; max-height: 95vh;">
            <div class="modal-header">
                <h2>ğŸ“‹ í”„ë¡œì íŠ¸ ìƒì„¸ì •ë³´</h2>
                <button class="modal-close" onclick="closeProjectDetailModal()">&times;</button>
            </div>
            
            <div class="detail-content" style="padding: 24px;">
                <!-- í”„ë¡œì íŠ¸ ì •ë³´ ì œëª© -->
                <div style="margin-bottom: 30px; border-bottom: 2px solid #e5e7eb; padding-bottom: 15px;">
                    <h2 style="margin: 0; font-size: 20px; font-weight: 700; color: #1f2937; display: flex; align-items: center; gap: 10px;">
                        ğŸ“„ í”„ë¡œì íŠ¸ ì •ë³´
                    </h2>
                </div>
                
                <!-- í”„ë¡œì íŠ¸ ì •ë³´ ë‚´ìš© -->
                <div style="min-height: 400px;">
                        <div class="detail-section" style="margin-bottom: 30px;">
                            <div class="info-grid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 20px; align-items: end;">
                                <div class="info-item" style="display: flex; flex-direction: column; gap: 6px;">
                                    <label style="font-size: 12px; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px;">í”„ë¡œì íŠ¸ë²ˆí˜¸</label>
                                    <span id="detailNo" style="font-size: 14px; color: #374151;">PJ202508060001</span>
                                </div>
                                <div class="info-item" style="display: flex; flex-direction: column; gap: 6px;">
                                    <label style="font-size: 12px; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px;">ì„œë¹„ìŠ¤</label>
                                    <span id="detailService" style="font-size: 14px; color: #374151;">ì†Œë¦¬ë°”ë¡œ</span>
                                </div>
                                <div class="info-item" style="display: flex; flex-direction: column; gap: 6px;">
                                    <label style="font-size: 12px; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px;">ë“±ë¡ì¼</label>
                                    <span id="detailRegDate" style="font-size: 14px; color: #374151;">2025.08.06 09:00</span>
                                </div>
                            </div>
                            
                            <div class="info-item full-width" style="margin-bottom: 15px; grid-column: 1 / -1;">
                                <label style="font-size: 12px; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px;">í”„ë¡œì íŠ¸ëª…</label>
                                <h3 id="detailTitle" style="margin: 0; font-size: 18px; font-weight: 600; color: #1f2937;">ì •ì±…ìœ„ì›íšŒ íšŒì˜ë¡ ì „ì‚¬ í”„ë¡œì íŠ¸</h3>
                            </div>
                            
                            <!-- ì„ íƒëœ íŒŒì¼ ëª©ë¡ -->
                            <div class="info-item full-width" style="margin-bottom: 25px; z-index: 1; position: relative; grid-column: 1 / -1;">
                                <label style="font-size: 12px; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px;">ì„ íƒëœ íŒŒì¼</label>
                                <div id="detailSelectedFilesBox" style="margin-top: 8px; background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 6px; padding: 10px 12px; min-height: 72px; white-space: pre-line; color: #374151; display: flex; flex-direction: column; justify-content: center;">ì •ì±…ìœ„ì›íšŒ_íšŒì˜ë¡_ìŒì„±1.m4a (00:15:30)</div>
                            </div>
                            
                            <div class="project-summary-row" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; align-items: end; position: relative; z-index: 0;">
                                <div class="summary-item" style="flex: 1; display: flex; flex-direction: column; gap: 8px; padding: 16px; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; min-height: 86px;">
                                    <label style="font-size: 12px; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; margin: 0;">ëª¨ì§‘ê¸°ê°„</label>
                                    <div class="summary-value" id="detailProjectPeriod" style="font-size: 14px; font-weight: 500; color: #1f2937; padding: 4px 0; min-width: 240px;">2025.08.06 11:00 ~ 2025.08.20 11:00</div>
                                </div>
                                <div class="summary-item" style="flex: 1; display: flex; flex-direction: column; gap: 8px; padding: 16px; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; min-height: 86px;">
                                    <label style="font-size: 12px; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; margin: 0;">ëª¨ì§‘ìƒíƒœ</label>
                                    <div class="summary-value"><span id="detailRecruitStatusBadge" style="display:inline-block; background: #3b82f6; color: white; padding: 4px 10px; border-radius: 12px; font-size: 12px; font-weight: 700; min-width: 86px; text-align: center;">ì§„í–‰ì¤‘</span></div>
                                </div>
                                <div class="summary-item" style="flex: 1; display: flex; flex-direction: column; gap: 8px; padding: 16px; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; min-height: 86px;">
                                    <label style="font-size: 12px; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; margin: 0;">ì‘ì—…ê¸°ê°„</label>
                                    <div class="summary-value" id="detailWorkPeriod" style="font-size: 14px; font-weight: 500; color: #1f2937; padding: 4px 0; min-width: 240px;">2025.08.21 ~ 2025.09.02</div>
                                </div>
                                <div class="summary-item" style="flex: 1; display: flex; flex-direction: column; gap: 8px; padding: 16px; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; min-height: 86px;">
                                    <label style="font-size: 12px; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; margin: 0;">ì‘ì—…ìƒíƒœ</label>
                                    <div class="summary-value"><span id="detailWorkStatusBadge" style="display:inline-block; background: #3b82f6; color: white; padding: 4px 10px; border-radius: 12px; font-size: 12px; font-weight: 700; min-width: 86px; text-align: center;">ì§„í–‰ì¤‘</span></div>
                                </div>
                                <div class="summary-item" style="flex: 1; display: flex; flex-direction: column; gap: 8px; padding: 16px; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; min-height: 86px; margin-top: 10px;">
                                    <label style="font-size: 12px; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; margin: 0;">ì‘ì—…ì ìˆ˜</label>
                                    <div class="summary-value" id="detailWorkerCount" style="font-size: 14px; font-weight: 500; color: #1f2937; padding: 4px 0;">0 / 5ëª…</div>
                                </div>
                                <div class="summary-item" style="flex: 1; display: flex; flex-direction: column; gap: 8px; padding: 16px; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; min-height: 86px; margin-top: 10px;">
                                    <label style="font-size: 12px; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; margin: 0;">ê¸ˆì•¡</label>
                                    <div class="summary-value" id="detailBudget" style="font-size: 14px; font-weight: 500; color: #1f2937; padding: 4px 0;">500,000ì›</div>
                                </div>
                                <div class="summary-item" style="flex: 1; display: flex; flex-direction: column; gap: 8px; padding: 16px; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; min-height: 86px; margin-top: 10px;">
                                    <label style="font-size: 12px; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; margin: 0;">ì§€ì›ìê²©</label>
                                    <div class="summary-value" id="detailQualification" style="font-size: 14px; font-weight: 500; color: #1f2937; padding: 4px 0;">ëˆ„êµ¬ë‚˜</div>
                                </div>
                            </div>

                            <div class="info-item full-width" style="margin-bottom: 25px; grid-column: 1 / -1;">
                                <label style="font-size: 12px; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px;">í”„ë¡œì íŠ¸ ì„¤ëª…</label>
                                <div id="detailContent" class="content-box" style="background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 6px; padding: 12px; font-size: 14px; line-height: 1.6; color: #374151;">ì‹œê¸‰ êµ¬í•¨<br>ì—°ìŠµí•©ë‹ˆë‹¤.<br>êµ¬í•©ë‹ˆë‹¤. êµ¬í•©ë‹ˆë‹¤.</div>
                            </div>
                            
                            <div class="info-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                                <div class="info-item" style="display: flex; flex-direction: column; gap: 6px;">
                                    <label style="font-size: 12px; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px;">ì¸ë„¤ì¼</label>
                                    <div id="detailThumbnail" class="thumbnail-preview" style="background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 6px; padding: 20px; text-align: center; color: #6b7280; font-size: 14px;">ì´ë¯¸ì§€ ì—†ìŒ</div>
                                </div>
                                <div class="info-item" style="display: flex; flex-direction: column; gap: 6px;">
                                    <label style="font-size: 12px; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px;">ì²¨ë¶€íŒŒì¼</label>
                                    <div id="detailAttachments" class="attachments-list" style="background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 6px; padding: 20px; text-align: center; color: #6b7280; font-size: 14px;">íŒŒì¼ ì—†ìŒ</div>
                                </div>
                            </div>
                        </div>
                </div>
            </div>
            
            <!-- ëª¨ë‹¬ í•˜ë‹¨ ë²„íŠ¼ -->
            <div class="modal-footer" style="display: flex; justify-content: space-between; align-items: center; padding: 15px 25px; border-top: 1px solid #e2e8f0; background: white; flex-shrink: 0;">
                <!-- ì™¼ìª½ ë²„íŠ¼ë“¤ -->
                <div style="display: flex; gap: 10px;">
                    <button type="button" class="btn-deadline" onclick="completeProject()" style="background: #10b981; color: white; border: none; border-radius: 6px; padding: 10px 20px; font-size: 14px; cursor: pointer; transition: background-color 0.2s;">
                        <span>âœ…</span>
                        í”„ë¡œì íŠ¸ ë§ˆê°
                    </button>
                    <button type="button" class="btn-delete" onclick="deleteProject()" style="background: #ef4444; color: white; border: none; border-radius: 6px; padding: 10px 20px; font-size: 14px; cursor: pointer; transition: background-color 0.2s;">
                        <span>ğŸ—‘ï¸</span>
                        í”„ë¡œì íŠ¸ ì‚­ì œ
                    </button>
                </div>
                
                <!-- ì˜¤ë¥¸ìª½ ë²„íŠ¼ë“¤ -->
                <div style="display: flex; gap: 10px;">
                    <button type="button" class="btn-edit" onclick="editProjectDetail()" style="background: #3b82f6; color: white; border: none; border-radius: 6px; padding: 10px 20px; font-size: 14px; cursor: pointer; transition: background-color 0.2s;">ìˆ˜ì •</button>
                    <button type="button" class="btn-secondary" onclick="closeProjectDetailModal()" style="background: #6b7280; color: white; border: none; border-radius: 6px; padding: 10px 20px; font-size: 14px; cursor: pointer; transition: background-color 0.2s;">ë‹«ê¸°</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ì‘ì—…ì ê´€ë¦¬ ëª¨ë‹¬ -->
    <div id="workerManagementModal" class="modal-overlay" style="display: none;">
        <div class="modal-container" style="max-width: 1000px; width: 95%; max-height: 95vh;">
            <div class="modal-header">
                <h2>ğŸ‘¥ ì‘ì—…ì ê´€ë¦¬</h2>
                <button class="modal-close" onclick="closeWorkerManagementModal()">&times;</button>
            </div>
            
            <div class="modal-content" style="padding: 24px; min-height: 400px;">
                <div class="detail-section" style="margin-bottom: 30px;">
                    <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 class="section-title" style="margin: 0; font-size: 16px; font-weight: 600; color: #374151;">ğŸ‘¥ ì‘ì—…ì ê´€ë¦¬</h3>
                        <div class="applicant-stats" style="display: flex; gap: 20px;">
                            <span class="stat-item" style="font-size: 14px; color: #6b7280;">ì´ <strong id="totalWorkersModal" style="color: #3b82f6;">5</strong>ëª…</span>
                            <span class="stat-item" style="font-size: 14px; color: #6b7280;">ë°°ì • <strong id="assignedCountModal" style="color: #3b82f6;">1</strong>ëª…</span>
                            <span class="stat-item" style="font-size: 14px; color: #6b7280;">ë¯¸ë°°ì • <strong id="excludedCountModal" style="color: #3b82f6;">4</strong>ëª…</span>
                        </div>
                    </div>
                    
                    <div class="applicants-table-wrapper" style="overflow-x: auto; border: 1px solid #e5e7eb; border-radius: 8px;">
                        <table class="applicants-table" style="width: 100%; border-collapse: collapse; background: white;">
                            <thead>
                                <tr>
                                    <th style="background: #f8f9fa; padding: 12px; text-align: center; font-size: 12px; font-weight: 600; color: #374151; border-bottom: 1px solid #e5e7eb; white-space: nowrap;"><input type="checkbox" id="selectAllWorkersModal" onchange="toggleAllWorkers(this)"></th>
                                    <th style="background: #f8f9fa; padding: 12px; text-align: center; font-size: 12px; font-weight: 600; color: #374151; border-bottom: 1px solid #e5e7eb; white-space: nowrap;">ì´ë¦„</th>
                                    <th style="background: #f8f9fa; padding: 12px; text-align: center; font-size: 12px; font-weight: 600; color: #374151; border-bottom: 1px solid #e5e7eb; white-space: nowrap;">ì„±ë³„</th>
                                    <th style="background: #f8f9fa; padding: 12px; text-align: center; font-size: 12px; font-weight: 600; color: #374151; border-bottom: 1px solid #e5e7eb; white-space: nowrap;">ì—°ë½ì²˜</th>
                                    <th style="background: #f8f9fa; padding: 12px; text-align: center; font-size: 12px; font-weight: 600; color: #374151; border-bottom: 1px solid #e5e7eb; white-space: nowrap;">ìƒë…„ì›”ì¼</th>
                                    <th style="background: #f8f9fa; padding: 12px; text-align: center; font-size: 12px; font-weight: 600; color: #374151; border-bottom: 1px solid #e5e7eb; white-space: nowrap;">ì£¼ì†Œ</th>
                                    <th style="background: #f8f9fa; padding: 12px; text-align: center; font-size: 12px; font-weight: 600; color: #374151; border-bottom: 1px solid #e5e7eb; white-space: nowrap;">í•œê¸€ì†ê¸°ìê²©ì¦</th>
                                    <th style="background: #f8f9fa; padding: 12px; text-align: center; font-size: 12px; font-weight: 600; color: #374151; border-bottom: 1px solid #e5e7eb; white-space: nowrap;">ë°°ì •ì¼</th>
                                    <th style="background: #f8f9fa; padding: 12px; text-align: center; font-size: 12px; font-weight: 600; color: #374151; border-bottom: 1px solid #e5e7eb; white-space: nowrap;">ìƒíƒœ</th>
                                </tr>
                            </thead>
                            <tbody id="workersListModal">
                                <tr style="border-bottom: 1px solid #f3f4f6;">
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;"><input type="checkbox" name="workerSelectModal" value="1"></td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">ì°¨ì •í›ˆ</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">ë‚¨ì„±</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">010-1**2-3456</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">1990.**.**</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">1ê¸‰</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">2025.08.06</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;"><span class="applicant-status status-approved" style="padding: 3px 8px; border-radius: 12px; font-size: 10px; font-weight: 600; white-space: nowrap; background: #dcfce7; color: #166534;">ë°°ì •</span></td>
                                </tr>
                                <tr style="border-bottom: 1px solid #f3f4f6;">
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;"><input type="checkbox" name="workerSelectModal" value="2"></td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">ê¹€ë¯¼ì˜</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">ì—¬ì„±</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">010-2**3-4567</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">1988.**.**</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">ê²½ê¸°ë„ ì•ˆì–‘ì‹œ</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">2ê¸‰</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">-</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;"><span class="applicant-status status-cancelled" style="padding: 3px 8px; border-radius: 12px; font-size: 10px; font-weight: 600; white-space: nowrap; background: #fef2f2; color: #991b1b;">ë¯¸ë°°ì •</span></td>
                                </tr>
                                <tr style="border-bottom: 1px solid #f3f4f6;">
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;"><input type="checkbox" name="workerSelectModal" value="3"></td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">ë°•ì¤€í˜¸</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">ë‚¨ì„±</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">010-3**4-5678</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">1985.**.**</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">1ê¸‰</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">-</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;"><span class="applicant-status status-cancelled" style="padding: 3px 8px; border-radius: 12px; font-size: 10px; font-weight: 600; white-space: nowrap; background: #fef2f2; color: #991b1b;">ë¯¸ë°°ì •</span></td>
                                </tr>
                                <tr style="border-bottom: 1px solid #f3f4f6;">
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;"><input type="checkbox" name="workerSelectModal" value="4"></td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">ì´ìˆ˜ì§„</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">ì—¬ì„±</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">010-4**5-6789</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">1992.**.**</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">ê²½ìƒë‚¨ë„ ì°½ì›ì‹œ</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">-</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">-</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;"><span class="applicant-status status-cancelled" style="padding: 3px 8px; border-radius: 12px; font-size: 10px; font-weight: 600; white-space: nowrap; background: #fef2f2; color: #991b1b;">ë¯¸ë°°ì •</span></td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;"><input type="checkbox" name="workerSelectModal" value="5"></td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">ìµœì˜ìˆ˜</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">ë‚¨ì„±</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">010-5**6-7890</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">1987.**.**</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">ì¸ì²œê´‘ì—­ì‹œ ì—°ìˆ˜êµ¬</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">1ê¸‰</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;">-</td>
                                    <td style="padding: 12px; font-size: 12px; color: #6b7280; text-align: center;"><span class="applicant-status status-cancelled" style="padding: 3px 8px; border-radius: 12px; font-size: 10px; font-weight: 600; white-space: nowrap; background: #fef2f2; color: #991b1b;">ë¯¸ë°°ì •</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- ë°°ì •/ë¯¸ë°°ì • ë²„íŠ¼ -->
                    <div class="batch-actions" style="display: flex; gap: 10px; align-items: center; margin-top: 15px; padding: 15px; background: white; border-radius: 8px; border: 1px solid #e5e7eb;">
                        <div style="display: flex; align-items: center; gap: 8px; color: #6b7280; font-size: 14px;">
                            <span>ì„ íƒëœ ì‘ì—…ì:</span>
                            <span id="selectedWorkerCountModal" style="font-weight: 600; color: #374151;">0ëª…</span>
                        </div>
                        <div style="margin-left: auto; display: flex; gap: 8px;">
                            <button class="batch-btn btn-approve" onclick="batchUpdateWorkerStatusModal('assigned')" style="background: #10b981; color: white; border: none; border-radius: 6px; padding: 8px 16px; font-size: 13px; cursor: pointer; transition: background-color 0.2s;">
                                âœ“ ë°°ì •
                            </button>
                            <button class="batch-btn btn-reject" onclick="batchUpdateWorkerStatusModal('unassigned')" style="background: #ef4444; color: white; border: none; border-radius: 6px; padding: 8px 16px; font-size: 13px; cursor: pointer; transition: background-color 0.2s;">
                                âœ— ë¯¸ë°°ì •
                            </button>
                            <button class="batch-btn btn-manual" onclick="openManualWorkerAssignmentModal()" style="background: #3b82f6; color: white; border: none; border-radius: 6px; padding: 8px 16px; font-size: 13px; cursor: pointer; transition: background-color 0.2s;">
                                ğŸ‘¤ ì‘ì—…ì ìˆ˜ë™ ë°°ì •
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ëª¨ë‹¬ í•˜ë‹¨ ë²„íŠ¼ -->
            <div class="modal-footer" style="display: flex; justify-content: flex-end; padding: 15px 25px; border-top: 1px solid #e2e8f0; background: white; flex-shrink: 0; gap: 10px;">
                <button type="button" class="btn-secondary" onclick="closeWorkerManagementModal()" style="background: #6b7280; color: white; border: none; border-radius: 6px; padding: 10px 20px; font-size: 14px; cursor: pointer; transition: background-color 0.2s;">ë‹«ê¸°</button>
                <button type="button" class="btn-confirm" onclick="confirmWorkersModal()" style="background: #f59e0b; color: white; border: none; border-radius: 6px; padding: 10px 20px; font-size: 14px; cursor: pointer; transition: background-color 0.2s;">í™•ì •</button>
            </div>
        </div>
    </div>

    <!-- ì„¸ë¶€ ìš”ì²­ì‚¬í•­ & íŒŒì¼ê³µìœ  ì„¹ì…˜ -->
    <div id="bottom-sections-container" style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-top: 25px;">
        <!-- ì„¸ë¶€ ìš”ì²­ì‚¬í•­ -->
        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 12px; padding: 25px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            <h2 class="section-title">
                <span>ğŸ“</span>
                ì„¸ë¶€ ìš”ì²­ì‚¬í•­
            </h2>
            <div style="margin-bottom: 15px;">
                <textarea id="customer-request-share" placeholder="ì„¸ë¶€ ìš”ì²­ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”..." style="width: 100%; height: 120px; padding: 15px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px; line-height: 1.5; resize: none; font-family: inherit; box-sizing: border-box;"></textarea>
            </div>
            
            <div style="display: flex; justify-content: flex-end;">
                <button id="share-request-btn" onclick="shareCustomerRequest()" data-status="idle" style="background: #3b82f6; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: 500;">
                    ê³µìœ 
                </button>
            </div>
        </div>

        <!-- íŒŒì¼ê³µìœ  -->
        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 12px; padding: 25px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            <h2 class="section-title">
                <span>ğŸ“</span>
                íŒŒì¼ê³µìœ 
            </h2>
            
            <div style="margin-bottom: 15px;">
                <p style="color: #6b7280; font-size: 14px; margin: 0;">ê´€ë¦¬ì/ê²€ìˆ˜ì/ì‘ì—…ì íŒŒì¼ ê³µìœ </p>
            </div>
            
            <div style="position: relative;">
                <!-- íŒŒì¼ ëª©ë¡ ì˜ì—­ -->
                <div style="background: #f8f9fa; border: 1px solid #e5e7eb; border-radius: 8px; min-height: 120px; padding: 15px; padding-bottom: 50px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #e5e7eb;">
                        <span style="font-weight: 600; color: #374151;">íŒŒì¼ ì´ë¦„</span>
                    </div>
                    
                    <!-- ê³µìœ  íŒŒì¼ ëª©ë¡ -->
                    <div id="shared-files-list">
                        <div style="display: flex; align-items: center; padding: 6px 0; border-bottom: 1px solid #e5e7eb;">
                            <input type="checkbox" style="margin-right: 18px;">
                            <span style="color: #3b82f6; cursor: pointer; text-decoration: none; font-size: 12px;">ì†Œë¦¬ë°”ë¡œ_HWP_í…œí”Œë¦¿_1ë²ˆ(ê¸°ë³¸) (1).hwp</span>
                        </div>
                        <div style="display: flex; align-items: center; padding: 6px 0; border-bottom: 1px solid #e5e7eb;">
                            <input type="checkbox" style="margin-right: 18px;">
                            <span style="color: #3b82f6; cursor: pointer; text-decoration: none; font-size: 12px;">ì†Œë¦¬ë°”ë¡œ_HWP_í…œí”Œë¦¿_1ë²ˆ(ê¸°ë³¸) (2).hwp</span>
                        </div>
                    </div>
                </div>
                
                <!-- ë²„íŠ¼ ì˜ì—­ (ì˜¤ë¥¸ìª½ í•˜ë‹¨) -->
                <div style="position: absolute; bottom: 15px; right: 15px; display: flex; gap: 8px;">
                    <button onclick="addSharedFile()" style="background: #f59e0b; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: 500;">
                        íŒŒì¼ì¶”ê°€
                    </button>
                    <button onclick="deleteSharedFile()" style="background: #ef4444; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: 500;">
                        ì‚­ì œ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ì‘ì—… íŠ¹ì´ì‚¬í•­ ì„¹ì…˜ -->
    <div class="workspy-section" id="work-notes-section" style="margin-top: 25px;">
        <h2 class="section-title">
            <span>ğŸ“</span>
            ì‘ì—… íŠ¹ì´ì‚¬í•­
        </h2>
        
        <div style="position: relative;">
            <textarea id="work-notes" placeholder="ì‘ì—…ê³¼ ê´€ë ¨ëœ íŠ¹ì´ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”..." style="width: 100%; min-height: 150px; padding: 15px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px; line-height: 1.5; resize: vertical; font-family: inherit; box-sizing: border-box;" onchange="markNotesAsModified()"></textarea>
            
            <div style="display: flex; justify-content: flex-end; margin-top: 15px;">
                <button onclick="saveWorkNotes()" style="background: #3b82f6; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500;">
                    ì €ì¥
                </button>
            </div>
        </div>
    </div>

    <!-- ì‘ì—…ì ìˆ˜ë™ ë°°ì • ëª¨ë‹¬ -->
    <div id="manualWorkerAssignmentModal" class="modal-overlay" style="display: none; z-index: 1300;">
        <div class="modal-container" style="max-width: 600px; width: 90%; max-height: 90vh;">
            <div class="modal-header" style="background: #5b6bc0; color: white; padding: 20px 24px; border-bottom: none;">
                <h2 style="margin: 0; font-size: 18px; font-weight: 600; color: white;">ì‘ì—…ì ìˆ˜ë™ ë°°ì •</h2>
                <button class="modal-close" onclick="closeManualWorkerAssignmentModal()" style="color: white; background: none; border: none; font-size: 24px; cursor: pointer; padding: 0; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.2s;">&times;</button>
            </div>
            
            <div class="modal-content" style="padding: 24px; min-height: 400px;">
                <!-- ê²€ìƒ‰ ì˜ì—­ -->
                <div style="margin-bottom: 20px;">
                    <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                        <select id="searchOption" style="padding: 10px 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; min-width: 120px; background: white;">
                            <option value="name">ì´ë¦„</option>
                            <option value="email">ì´ë©”ì¼</option>
                            <option value="phone">ì „í™”ë²ˆí˜¸</option>
                        </select>
                        <input type="text" id="searchInput" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”" 
                               style="flex: 1; padding: 10px 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px;"
                               onkeypress="handleSearchKeypress(event)"
                               onfocus="clearSearchPlaceholder(this)"
                               onblur="restoreSearchPlaceholder(this)">
                        <button onclick="searchWorkers()" style="background: #3b82f6; color: white; border: none; border-radius: 6px; padding: 10px 20px; font-size: 14px; cursor: pointer; font-weight: 500;">
                            ê²€ìƒ‰
                        </button>
                    </div>
                </div>
                
                <!-- ê²€ìƒ‰ ê²°ê³¼ ì˜ì—­ -->
                <div style="margin-bottom: 20px;">
                    <div style="margin-bottom: 10px; font-weight: 600; color: #374151; font-size: 14px;">
                        ê²€ìƒ‰ ê²°ê³¼ <span id="searchResultCount" style="color: #3b82f6;">1</span>ëª…
                    </div>
                    
                    <div id="searchResults" style="border: 1px solid #e5e7eb; border-radius: 8px; background: white; min-height: 300px; max-height: 400px; overflow-y: auto;">
                        <!-- ì´ˆê¸° ìƒíƒœ ë©”ì‹œì§€ -->
                        <div id="noSearchResults" style="padding: 60px 20px; text-align: center; color: #9ca3af; font-size: 14px;">
                            ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ê³  ê²€ìƒ‰ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”
                        </div>
                        
                        <!-- ê²€ìƒ‰ ê²°ê³¼ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </div>
                </div>
            </div>
            
            <!-- ëª¨ë‹¬ í•˜ë‹¨ ë²„íŠ¼ -->
            <div class="modal-footer" style="display: flex; justify-content: flex-end; padding: 15px 25px; border-top: 1px solid #e2e8f0; background: white; flex-shrink: 0; gap: 10px;">
                <button type="button" onclick="closeManualWorkerAssignmentModal()" style="background: #6b7280; color: white; border: none; border-radius: 6px; padding: 10px 20px; font-size: 14px; cursor: pointer; transition: background-color 0.2s;">ì·¨ì†Œ</button>
                <button type="button" id="assignSelectedWorkerBtn" onclick="assignSelectedWorker()" style="background: #10b981; color: white; border: none; border-radius: 6px; padding: 10px 20px; font-size: 14px; cursor: pointer; transition: background-color 0.2s;" disabled>
                    ì„ íƒí•œ ì‘ì—…ì ë°°ì •
                </button>
            </div>
        </div>
    </div>

    <!-- íŒŒì¼ì¶”ê°€ ëª¨ë‹¬ (trans-detail.htmlì—ì„œ ê°€ì ¸ì˜´) -->
    <div id="fileAddModal" class="modal-overlay" style="display: none;">
        <div class="modal-container" style="max-width: 600px;">
            <div class="modal-header">
                <h2>ğŸ“ ì˜ë¢°íŒŒì¼ ì¶”ê°€</h2>
                <button class="modal-close" onclick="closeFileAddModal()">&times;</button>
            </div>
            
            <form class="modal-form" id="fileAddForm" style="padding: 30px;">
                <!-- íŒŒì¼ ì •ë³´ -->
                <div class="form-row">
                    <div class="form-group full-width">
                        <label style="margin-bottom: 15px; font-size: 16px; font-weight: 600; color: #374151;">íŒŒì¼ ì—…ë¡œë“œ</label>
                        <div class="file-upload-area" style="height: 350px; display: flex; flex-direction: column; justify-content: center; align-items: center; margin-bottom: 20px; border: 2px dashed #d1d5db; border-radius: 12px; padding: 40px 20px; text-align: center; transition: border-color 0.2s; background: #f9fafb;">
                            <div class="file-upload-content" style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; width: 100%;">
                                <div class="file-upload-icon" style="margin-bottom: 20px; font-size: 64px; color: #6b7280;">ğŸ“</div>
                                <div class="file-upload-text" style="margin-bottom: 30px;">
                                    <p style="margin: 0 0 12px 0; font-size: 18px; font-weight: 500; color: #374151;">íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”</p>
                                    <p style="margin: 0; font-size: 14px; color: #6b7280; line-height: 1.5;">ë¹„ë””ì˜¤ ë˜ëŠ” ì˜¤ë””ì˜¤ íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”</p>
                                </div>
                                <button type="button" class="file-upload-btn" onclick="document.getElementById('newFileInput').click()" style="padding: 14px 28px; font-size: 15px; font-weight: 600; background: #3b82f6; color: white; border: none; border-radius: 8px; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 4px rgba(59, 130, 246, 0.2);">íŒŒì¼ ì„ íƒ</button>
                            </div>
                            <div class="file-preview" id="newFilePreview" style="display: none; position: relative; text-align: center; height: 100%; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                                <div id="newFileInfo" style="text-align: center;">
                                    <div style="font-size: 64px; margin-bottom: 20px; color: #10b981;">âœ…</div>
                                    <div id="newFileName" style="font-weight: 600; margin-bottom: 12px; font-size: 18px; color: #374151; word-break: break-all; max-width: 400px;">íŒŒì¼ëª…</div>
                                    <div id="newFileSize" style="font-size: 16px; color: #6b7280; font-weight: 500;">íŒŒì¼ í¬ê¸°</div>
                                    <div style="margin-top: 20px;">
                                        <button type="button" onclick="removeNewFile()" style="background: #ef4444; color: white; border: none; border-radius: 6px; padding: 8px 16px; cursor: pointer; font-size: 14px; font-weight: 500; transition: background-color 0.2s;">
                                            ğŸ—‘ï¸ íŒŒì¼ ì œê±°
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <input type="file" id="newFileInput" accept="video/*,audio/*" style="display: none;" onchange="handleNewFileUpload(this)">
                    </div>
                </div>
                
                <div class="modal-footer" style="display: flex; justify-content: flex-end; padding: 15px 25px; border-top: 1px solid #e2e8f0; background: white; flex-shrink: 0; gap: 10px;">
                    <button type="button" class="btn-secondary" onclick="closeFileAddModal()" style="background: #6b7280; color: white; border: none; border-radius: 6px; padding: 10px 20px; font-size: 14px; cursor: pointer; transition: background-color 0.2s;">ì·¨ì†Œ</button>
                    <button type="button" class="btn-save" onclick="addNewFile()" style="background: #10b981; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500; transition: background-color 0.2s;">ì¶”ê°€</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ì‚°ì¶œë¬¼ ë‹¤ìš´ë¡œë“œ ëª¨ë‹¬ (trans-detail.htmlì—ì„œ ê°€ì ¸ì˜´) -->
    <div id="outputDownloadModal" class="modal-overlay" style="display: none;">
        <div class="modal-container" style="max-width: 1000px; width: 95%;">
            <div class="modal-header">
                <h2>ì‚°ì¶œë¬¼ ë‹¤ìš´ë¡œë“œ</h2>
                <button class="modal-close" onclick="closeOutputDownloadModal()">&times;</button>
            </div>
            
            <div class="modal-form" style="padding: 24px;">
                <!-- 4ì»¬ëŸ¼ ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ -->
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; align-items: stretch;">
                    
                    <!-- TXT ì»¬ëŸ¼ -->
                    <div style="border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden; display: flex; flex-direction: column;">
                        <div style="background: #f8f9fa; padding: 12px; text-align: center; font-weight: 600; color: #374151; border-bottom: 1px solid #e5e7eb;">
                            TXT
                        </div>
                        <div style="padding: 15px; flex: 1; display: flex; flex-direction: column;">
                            <div style="margin-bottom: 12px;">
                                <div style="font-weight: 500; color: #374151; margin-bottom: 6px; font-size: 14px;">ë¹ˆì¤„</div>
                                <div style="display: flex; gap: 15px;">
                                    <label style="display: flex; align-items: center; gap: 8px; margin: 0;">
                                        <input type="radio" name="txt-blank" value="exclude" checked>
                                        <span style="font-size: 13px; color: #6b7280;">ë¯¸í¬í•¨</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; margin: 0;">
                                        <input type="radio" name="txt-blank" value="include">
                                        <span style="font-size: 13px; color: #6b7280;">í¬í•¨</span>
                                    </label>
                                </div>
                            </div>
                            <div style="flex: 1;"></div>
                        </div>
                        <div style="padding: 12px; border-top: 1px solid #e5e7eb;">
                            <button class="btn btn-primary" onclick="downloadFile('txt')" style="width: 100%; padding: 8px; font-size: 13px; display: flex; align-items: center; justify-content: center; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer;">ë‹¤ìš´ë¡œë“œ</button>
                        </div>
                    </div>

                    <!-- SMI ì»¬ëŸ¼ -->
                    <div style="border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden; display: flex; flex-direction: column;">
                        <div style="background: #f8f9fa; padding: 12px; text-align: center; font-weight: 600; color: #374151; border-bottom: 1px solid #e5e7eb;">
                            SMI
                        </div>
                        <div style="padding: 15px; flex: 1; display: flex; flex-direction: column;">
                            <div style="margin-bottom: 12px;">
                                <div style="font-weight: 500; color: #374151; margin-bottom: 6px; font-size: 14px;">ìë§‰ìœ„ì¹˜</div>
                                <div style="display: flex; gap: 15px;">
                                    <label style="display: flex; align-items: center; gap: 6px; margin: 0;">
                                        <input type="radio" name="smi-position" value="off" checked>
                                        <span style="font-size: 13px; color: #6b7280;">OFF</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; margin: 0;">
                                        <input type="radio" name="smi-position" value="on">
                                        <span style="font-size: 13px; color: #6b7280;">ON</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 12px;">
                                <div style="font-weight: 500; color: #374151; margin-bottom: 6px; font-size: 14px;">nbsp</div>
                                <div style="display: flex; gap: 15px;">
                                    <label style="display: flex; align-items: center; gap: 6px; margin: 0;">
                                        <input type="radio" name="smi-nbsp" value="exclude" checked>
                                        <span style="font-size: 13px; color: #6b7280;">ë¯¸í¬í•¨</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; margin: 0;">
                                        <input type="radio" name="smi-nbsp" value="include">
                                        <span style="font-size: 13px; color: #6b7280;">í¬í•¨</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 12px;">
                                <div style="font-weight: 500; color: #374151; margin-bottom: 6px; font-size: 14px;">ì¸ì½”ë”©</div>
                                <div style="display: flex; gap: 15px;">
                                    <label style="display: flex; align-items: center; gap: 6px; margin: 0;">
                                        <input type="radio" name="smi-encoding" value="utf8" checked onchange="toggleSmiTagOptions()">
                                        <span style="font-size: 13px; color: #6b7280;">UTF-8</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; margin: 0;">
                                        <input type="radio" name="smi-encoding" value="ansi" onchange="toggleSmiTagOptions()">
                                        <span style="font-size: 13px; color: #6b7280;">ANSI</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div id="smi-tag-section" style="margin-bottom: 12px; opacity: 0.5; pointer-events: none;">
                                <div style="font-weight: 500; color: #374151; margin-bottom: 6px; font-size: 14px;">
                                    tag <span style="font-size: 11px; color: #9ca3af;">(ANSI ì„ íƒì‹œ ì‚¬ìš©)</span>
                                </div>
                                <div style="display: flex; gap: 15px;">
                                    <label style="display: flex; align-items: center; gap: 6px; margin: 0;">
                                        <input type="radio" name="smi-tag" value="on" checked disabled>
                                        <span style="font-size: 13px; color: #6b7280;">ON</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; margin: 0;">
                                        <input type="radio" name="smi-tag" value="off" disabled>
                                        <span style="font-size: 13px; color: #6b7280;">OFF</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div style="padding: 12px; border-top: 1px solid #e5e7eb;">
                            <button class="btn btn-primary" onclick="downloadFile('smi')" style="width: 100%; padding: 8px; font-size: 13px; display: flex; align-items: center; justify-content: center; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer;">ë‹¤ìš´ë¡œë“œ</button>
                        </div>
                    </div>

                    <!-- SRT ì»¬ëŸ¼ -->
                    <div style="border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden; display: flex; flex-direction: column;">
                        <div style="background: #f8f9fa; padding: 12px; text-align: center; font-weight: 600; color: #374151; border-bottom: 1px solid #e5e7eb;">
                            SRT
                        </div>
                        <div style="padding: 15px; flex: 1; display: flex; flex-direction: column;">
                            <div style="margin-bottom: 12px;">
                                <div style="font-weight: 500; color: #374151; margin-bottom: 6px; font-size: 14px;">ìë§‰ìœ„ì¹˜</div>
                                <div style="display: flex; gap: 15px;">
                                    <label style="display: flex; align-items: center; gap: 6px; margin: 0;">
                                        <input type="radio" name="srt-position" value="off" checked>
                                        <span style="font-size: 13px; color: #6b7280;">OFF</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; margin: 0;">
                                        <input type="radio" name="srt-position" value="on">
                                        <span style="font-size: 13px; color: #6b7280;">ON</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 12px;">
                                <div style="font-weight: 500; color: #374151; margin-bottom: 6px; font-size: 14px;">ì•„ì›ƒì‹±í¬</div>
                                <div style="display: flex; gap: 15px;">
                                    <label style="display: flex; align-items: center; gap: 6px; margin: 0;">
                                        <input type="radio" name="srt-sync" value="keep" checked>
                                        <span style="font-size: 13px; color: #6b7280;">ìœ ì§€</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; margin: 0;">
                                        <input type="radio" name="srt-sync" value="remove">
                                        <span style="font-size: 13px; color: #6b7280;">ì‚­ì œ</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 12px;">
                                <div style="font-weight: 500; color: #374151; margin-bottom: 6px; font-size: 14px;">ë¹ˆì¤„</div>
                                <div style="display: flex; gap: 15px;">
                                    <label style="display: flex; align-items: center; gap: 6px; margin: 0;">
                                        <input type="radio" name="srt-blank" value="include" checked>
                                        <span style="font-size: 13px; color: #6b7280;">í¬í•¨</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; margin: 0;">
                                        <input type="radio" name="srt-blank" value="exclude">
                                        <span style="font-size: 13px; color: #6b7280;">ë¯¸í¬í•¨</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div style="padding: 12px; border-top: 1px solid #e5e7eb;">
                            <button class="btn btn-primary" onclick="downloadFile('srt')" style="width: 100%; padding: 8px; font-size: 13px; display: flex; align-items: center; justify-content: center; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer;">ë‹¤ìš´ë¡œë“œ</button>
                        </div>
                    </div>

                    <!-- ë‹¤ìš´ë¡œë“œ ì»¬ëŸ¼ (VTT, Capt, HWP) -->
                    <div style="border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden; display: flex; flex-direction: column;">
                        <div style="background: #f8f9fa; padding: 12px; text-align: center; font-weight: 600; color: #374151; border-bottom: 1px solid #e5e7eb;">
                            ë‹¤ìš´ë¡œë“œ
                        </div>
                        <div style="padding: 15px; flex: 1; display: flex; flex-direction: column;">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                                <span style="font-weight: 500; color: #374151; font-size: 14px;">VTT</span>
                                <button class="btn btn-primary" onclick="downloadFile('vtt')" style="padding: 6px 12px; font-size: 13px; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer;">ë‹¤ìš´ë¡œë“œ</button>
                            </div>
                            
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                                <span style="font-weight: 500; color: #374151; font-size: 14px;">Capt</span>
                                <button class="btn btn-primary" onclick="downloadFile('capt')" style="padding: 6px 12px; font-size: 13px; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer;">ë‹¤ìš´ë¡œë“œ</button>
                            </div>
                            
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                                <span style="font-weight: 500; color: #374151; font-size: 14px;">HWP</span>
                                <button class="btn btn-primary" onclick="downloadFile('hwp')" style="padding: 6px 12px; font-size: 13px; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer;">ë‹¤ìš´ë¡œë“œ</button>
                            </div>
                            
                            <div style="flex: 1;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>

