<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bulk Project Registration - VOD Work Management</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            padding: 30px;
            min-height: 100vh;
        }
        
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e5e7eb;
        }
        
        .page-title {
            font-size: 28px;
            font-weight: 600;
            color: #374151;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .close-button {
            background: #6b7280;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .close-button:hover {
            background: #4b5563;
        }
        
        /* 기본 정보 영역 */
        .basic-info-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border: 1px solid #e5e7eb;
        }
        
        .basic-info-header {
            font-size: 18px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .basic-info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }
        
        .language-info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }
        
        .basic-info-grid .form-group,
        .language-info-grid .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .basic-info-grid .form-group input,
        .basic-info-grid .form-group select,
        .language-info-grid .form-group input,
        .language-info-grid .form-group select {
            padding: 15px 20px;
            border: 1px solid #d1d5db;
            border-radius: 10px;
            font-size: 16px;
            background: white;
            transition: all 0.2s;
            width: 100%;
            box-sizing: border-box;
            cursor: pointer;
        }
        
        .basic-info-grid .form-group input:focus,
        .basic-info-grid .form-group select:focus,
        .language-info-grid .form-group input:focus,
        .language-info-grid .form-group select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
            transform: translateY(-1px);
        }
        
        .basic-info-grid .form-group label,
        .language-info-grid .form-group label {
            margin-bottom: 12px;
            font-size: 16px;
            font-weight: 600;
            color: #374151;
        }
        
        /* 필수 입력 표시 */
        .required {
            color: #ef4444;
            font-weight: 700;
            margin-left: 4px;
        }
        
        /* 도착 언어 다중 선택 */
        .language-multi-select {
            position: relative;
            width: 100%;
        }
        
        .language-select-trigger {
            padding: 15px 20px;
            border: 1px solid #d1d5db;
            border-radius: 10px;
            font-size: 16px;
            background: white;
            transition: all 0.2s;
            width: 100%;
            box-sizing: border-box;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            min-height: 54px;
        }
        
        .language-select-trigger:focus,
        .language-select-trigger.open {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
            transform: translateY(-1px);
        }
        
        .language-select-trigger .selected-count {
            color: #6b7280;
            font-size: 14px;
        }
        
        .language-select-trigger .arrow {
            transition: transform 0.2s;
        }
        
        .language-select-trigger.open .arrow {
            transform: rotate(180deg);
        }
        
        .language-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            max-height: 300px;
            overflow-y: auto;
            display: none;
            margin-top: 5px;
        }
        
        .language-dropdown.show {
            display: block;
        }
        
        .language-group {
            border-bottom: 1px solid #e5e7eb;
        }
        
        .language-group:last-child {
            border-bottom: none;
        }
        
        .language-group-title {
            padding: 12px 20px;
            background: #f8f9fa;
            font-weight: 600;
            color: #374151;
            font-size: 14px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .language-option {
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 15px;
        }
        
        .language-option:hover {
            background: #f3f4f6;
        }
        
        .language-option.selected {
            background: #dbeafe;
            color: #1e40af;
            font-weight: 500;
        }
        
        .language-option .checkmark {
            opacity: 0;
            color: #10b981;
            font-weight: bold;
            transition: opacity 0.2s;
        }
        
        .language-option.selected .checkmark {
            opacity: 1;
        }
        
        .selected-languages {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 8px;
            max-height: 60px;
            overflow-y: auto;
        }
        
        .selected-language-tag {
            background: #dbeafe;
            color: #1e40af;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .selected-language-tag .remove {
            cursor: pointer;
            color: #ef4444;
            font-weight: bold;
            font-size: 10px;
        }
        
        .selected-language-tag .remove:hover {
            color: #dc2626;
        }
        
        /* 파일 업로드 영역 */
        .upload-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border: 1px solid #e5e7eb;
        }
        
        .upload-header {
            font-size: 18px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .file-upload-area {
            border: 2px dashed #d1d5db;
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            background: #f9fafb;
            transition: all 0.2s;
            cursor: pointer;
            margin-bottom: 15px;
        }
        
        .file-upload-area:hover {
            border-color: #3b82f6;
            background: #eff6ff;
        }
        
        .file-upload-area.dragover {
            border-color: #3b82f6;
            background: #eff6ff;
            transform: scale(1.02);
        }
        
        .upload-icon {
            font-size: 48px;
            margin-bottom: 15px;
            color: #6b7280;
        }
        
        .upload-text {
            font-size: 16px;
            color: #374151;
            margin-bottom: 8px;
        }
        
        .file-input {
            display: none;
        }
        
        .file-select-btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .file-select-btn:hover {
            background: #2563eb;
        }
        
        .register-btn {
            background: #10b981;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .register-btn:hover {
            background: #059669;
        }
        
        /* 하단 버튼들 */
        .bottom-btn {
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* 엑셀 다운로드 버튼 */
        .excel-download-btn {
            background: #10b981;
            color: white;
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
        }
        
        .excel-download-btn:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }
        
        .excel-download-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
        }
        
        /* 웍스파이 프로젝트 등록 버튼 */
        .workspy-register-btn {
            background: #7c3aed;
            color: white;
            box-shadow: 0 2px 8px rgba(124, 58, 237, 0.3);
        }
        
        .workspy-register-btn:hover {
            background: #6d28d9;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.4);
        }
        
        .workspy-register-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(124, 58, 237, 0.3);
        }
        
        /* 프로젝트 리스트 영역 */
        .project-list-section {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border: 1px solid #e5e7eb;
            overflow: hidden;
        }
        
        .list-header {
            background: #f8f9fa;
            padding: 20px 25px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .list-title {
            font-size: 18px;
            font-weight: 600;
            color: #374151;
        }
        
        .list-info {
            color: #6b7280;
            font-size: 14px;
        }
        
        .project-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .project-table th,
        .project-table td {
            padding: 8px 6px;
            text-align: center;
            border: 1px solid #e5e7eb;
            font-size: 13px;
            position: relative;
        }
        
        .project-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #374151;
            border-bottom: 2px solid #d1d5db;
        }
        
        .project-table td {
            color: #6b7280;
            min-height: 35px;
        }
        
        /* 엑셀 스타일 셀 */
        .editable-cell {
            cursor: cell;
            transition: all 0.1s;
            user-select: none;
            border: 1px solid #e5e7eb;
        }
        
        .editable-cell:hover {
            background: #f0f9ff;
            border-color: #93c5fd;
        }
        
        .editable-cell.selected {
            background: #dbeafe;
            border: 2px solid #3b82f6;
            box-shadow: 0 0 0 1px #3b82f6;
        }
        
        .editable-cell.editing {
            background: white;
            border: 2px solid #10b981;
            box-shadow: 0 0 0 1px #10b981;
        }
        
        .editable-cell input {
            width: 100%;
            height: 100%;
            border: none;
            background: transparent;
            padding: 4px 8px;
            font-size: 13px;
            color: #374151;
            text-align: center;
            outline: none;
        }
        
        .editable-cell textarea {
            width: 100%;
            min-height: 60px;
            border: none;
            background: transparent;
            padding: 4px 8px;
            font-size: 13px;
            color: #374151;
            text-align: left;
            outline: none;
            resize: vertical;
            font-family: inherit;
            line-height: 1.4;
        }
        
        /* 상태 배지 */
        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            white-space: nowrap;
        }
        
        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-ready {
            background: #dbeafe;
            color: #1e40af;
        }
        
        /* 키보드 네비게이션 도움말 */
        .cell-navigator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #374151;
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
        }
        
        .cell-navigator.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* 반응형 */
        @media (max-width: 768px) {
            body {
                padding: 20px;
            }
            
            .cell-navigator {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="page-header">
        <h1 class="page-title">
            <span>📁</span>
            Bulk Project Registration
        </h1>
        <button class="close-button" onclick="closeWindow()">
            <span>✕</span>
            Close
        </button>
    </div>
    
    <!-- 기본 정보 영역 -->
    <div class="basic-info-section">
        <div class="basic-info-header">
            <span>📋</span>
            Basic Information
        </div>
        
        <!-- 첫 번째 행: 프로젝트 제목 | 업체명 | 의뢰자명 -->
        <div class="basic-info-grid">
            <div class="form-group">
                <label for="projectTitle">Project Title <span class="required">*</span></label>
                <input type="text" id="projectTitle" placeholder="Enter project title" required>
            </div>
            <div class="form-group">
                <label for="companyName">Company Name <span class="required">*</span></label>
                <select id="companyName" required>
                    <option value="">Select company</option>
                    <option value="가천대학교">가천대학교</option>
                    <option value="강원대학교">강원대학교</option>
                    <option value="건국대학교">건국대학교</option>
                    <option value="경북대학교">경북대학교</option>
                    <option value="경희대학교">경희대학교</option>
                    <option value="고려대학교">고려대학교</option>
                    <option value="국민대학교">국민대학교</option>
                    <option value="단국대학교">단국대학교</option>
                    <option value="동국대학교">동국대학교</option>
                    <option value="부산대학교">부산대학교</option>
                    <option value="서강대학교">서강대학교</option>
                    <option value="서울대학교">서울대학교</option>
                    <option value="성균관대학교">성균관대학교</option>
                    <option value="세종대학교">세종대학교</option>
                    <option value="아주대학교">아주대학교</option>
                    <option value="연세대학교">연세대학교</option>
                    <option value="이화여자대학교">이화여자대학교</option>
                    <option value="인하대학교">인하대학교</option>
                    <option value="전남대학교">전남대학교</option>
                    <option value="전북대학교">전북대학교</option>
                    <option value="제주대학교">제주대학교</option>
                    <option value="중앙대학교">중앙대학교</option>
                    <option value="충남대학교">충남대학교</option>
                    <option value="카이스트">카이스트</option>
                    <option value="포스텍">포스텍</option>
                    <option value="한양대학교">한양대학교</option>
                    <option value="홍익대학교">홍익대학교</option>
                    <option value="DGIST">DGIST</option>
                    <option value="GIST">GIST</option>
                    <option value="UNIST">UNIST</option>
                </select>
            </div>
            <div class="form-group">
                <label for="clientName">Client Name <span class="required">*</span></label>
                <input type="text" id="clientName" placeholder="Enter client name" required>
            </div>
        </div>
        
        <!-- 두 번째 행: 원본 언어 | 도착 언어 -->
        <div class="language-info-grid">
            <div class="form-group">
                <label for="sourceLanguage">Source Language <span class="required">*</span></label>
                <select id="sourceLanguage" required>
                    <option value="">Select source language</option>
                    <optgroup label="Asia/Africa">
                        <option value="네팔어">네팔어</option>
                        <option value="말레이어">말레이어</option>
                        <option value="말라얄람어">말라얄람어</option>
                        <option value="마라티어">마라티어</option>
                        <option value="몽골어">몽골어</option>
                        <option value="벵골어">벵골어</option>
                        <option value="아랍어">아랍어</option>
                        <option value="우르두어">우르두어</option>
                        <option value="우즈벡어">우즈벡어</option>
                        <option value="인도네시아어">인도네시아어</option>
                        <option value="일본어">일본어</option>
                        <option value="중국어(간체)">중국어(간체)</option>
                        <option value="중국어(번체)">중국어(번체)</option>
                        <option value="카자흐어">카자흐어</option>
                        <option value="칸나다어">칸나다어</option>
                        <option value="크메르어">크메르어</option>
                        <option value="타밀어">타밀어</option>
                        <option value="태국어">태국어</option>
                        <option value="텔루구어">텔루구어</option>
                        <option value="터키어">터키어</option>
                        <option value="펀자브어">펀자브어</option>
                        <option value="필리핀어">필리핀어</option>
                        <option value="한글">한글</option>
                        <option value="힌디어">힌디어</option>
                        <option value="베트남어">베트남어</option>
                        <option value="구자라트어">구자라트어</option>
                    </optgroup>
                    <optgroup label="Europe/Africa">
                        <option value="과라니어">과라니어</option>
                        <option value="그리스어">그리스어</option>
                        <option value="네덜란드어">네덜란드어</option>
                        <option value="덴마크어">덴마크어</option>
                        <option value="독일어">독일어</option>
                        <option value="러시아어">러시아어</option>
                        <option value="스웨덴어">스웨덴어</option>
                        <option value="스페인어">스페인어</option>
                        <option value="영어">영어</option>
                        <option value="이탈리아어">이탈리아어</option>
                        <option value="체코어">체코어</option>
                        <option value="폴란드어">폴란드어</option>
                        <option value="포르투갈어">포르투갈어</option>
                        <option value="프랑스어">프랑스어</option>
                        <option value="핀란드어">핀란드어</option>
                        <option value="헝가리어">헝가리어</option>
                    </optgroup>
                </select>
            </div>
            <div class="form-group">
                <label for="targetLanguage">Target Language <span class="required">*</span></label>
                <div class="language-multi-select">
                    <div class="language-select-trigger" id="targetLanguageTrigger" tabindex="0">
                        <span class="placeholder">Select target language</span>
                        <span class="arrow">▼</span>
                    </div>
                    <div class="language-dropdown" id="targetLanguageDropdown">
                        <div class="language-group">
                            <div class="language-group-title">Asia/Africa</div>
                            <div class="language-option" data-value="네팔어">
                                <span>네팔어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="말레이어">
                                <span>말레이어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="말라얄람어">
                                <span>말라얄람어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="마라티어">
                                <span>마라티어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="몽골어">
                                <span>몽골어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="벵골어">
                                <span>벵골어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="아랍어">
                                <span>아랍어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="우르두어">
                                <span>우르두어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="우즈벡어">
                                <span>우즈벡어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="인도네시아어">
                                <span>인도네시아어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="일본어">
                                <span>일본어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="중국어(간체)">
                                <span>중국어(간체)</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="중국어(번체)">
                                <span>중국어(번체)</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="카자흐어">
                                <span>카자흐어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="칸나다어">
                                <span>칸나다어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="크메르어">
                                <span>크메르어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="타밀어">
                                <span>타밀어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="태국어">
                                <span>태국어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="텔루구어">
                                <span>텔루구어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="터키어">
                                <span>터키어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="펀자브어">
                                <span>펀자브어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="필리핀어">
                                <span>필리핀어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="한글">
                                <span>한글</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="힌디어">
                                <span>힌디어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="베트남어">
                                <span>베트남어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="구자라트어">
                                <span>구자라트어</span>
                                <span class="checkmark">✓</span>
                            </div>
                        </div>
                        <div class="language-group">
                            <div class="language-group-title">Europe/Africa</div>
                            <div class="language-option" data-value="과라니어">
                                <span>과라니어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="그리스어">
                                <span>그리스어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="네덜란드어">
                                <span>네덜란드어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="덴마크어">
                                <span>덴마크어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="독일어">
                                <span>독일어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="러시아어">
                                <span>러시아어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="스웨덴어">
                                <span>스웨덴어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="스페인어">
                                <span>스페인어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="영어">
                                <span>영어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="이탈리아어">
                                <span>이탈리아어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="체코어">
                                <span>체코어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="폴란드어">
                                <span>폴란드어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="포르투갈어">
                                <span>포르투갈어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="프랑스어">
                                <span>프랑스어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="핀란드어">
                                <span>핀란드어</span>
                                <span class="checkmark">✓</span>
                            </div>
                            <div class="language-option" data-value="헝가리어">
                                <span>헝가리어</span>
                                <span class="checkmark">✓</span>
                            </div>
                        </div>
                    </div>
                    <div class="selected-languages" id="selectedLanguages"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 파일 업로드 영역 -->
    <div class="upload-section">
        <div class="upload-header">
            <span>📤</span>
            File Upload
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px;">
            <!-- 왼쪽: 드래그 업로드 영역 -->
            <div>
                <div class="file-upload-area" onclick="document.getElementById('fileInput').click()" 
                     ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                    <div class="upload-icon">📁</div>
                    <div class="upload-text">Drag and drop files here or click to select</div>
                </div>
                
                <input type="file" id="fileInput" class="file-input" accept=".xlsx,.xls" onchange="handleFileSelect(event)">
                
                
                <!-- 버튼 영역 -->
                <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 15px;">
                    <button class="file-select-btn" onclick="simulateFileSelect()">
                        <span>📂</span>
                        Select Files
                    </button>
                    
                    <button class="register-btn" onclick="simulateRegisterProjects()">
                        <span>✅</span>
                        Register
                    </button>
                </div>
            </div>
            
            <!-- 오른쪽: 업로드된 파일 리스트 -->
            <div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #e5e7eb; height: 100%;">
                    <div style="font-weight: 600; color: #374151; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                        <span>📋</span>
                        Uploaded Files (<span id="uploadedFileCount">0</span>)
                    </div>
                    
                    <div id="uploadedFileList" style="max-height: 300px; overflow-y: auto;">
                        <div style="text-align: center; color: #6b7280; padding: 40px 20px; font-style: italic;">
                            No uploaded files.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 프로젝트 리스트 영역 -->
    <div class="project-list-section">
        <div class="list-header">
            <h2 class="list-title">Project List</h2>
            <div class="list-info">Total <span id="projectCount">0</span> items</div>
        </div>
        
        <div style="overflow-x: auto;">
            <table class="project-table">
                <thead>
                    <tr>
                        <th width="50">NO</th>
                        <th width="120">Service</th>
                        <th width="200">File Name</th>
                        <th width="100">Work Time</th>
                        <th width="250">Title</th>
                        <th width="80">Qualification</th>
                        <th width="160">Recruitment Start</th>
                        <th width="160">Recruitment End</th>
                        <th width="80">Recruitments</th>
                        <th width="120">Work Start</th>
                        <th width="120">Work End</th>
                        <th width="100">Amount</th>
                        <th width="250">Content</th>
                    </tr>
                </thead>
                <tbody id="projectTableBody">
                    <tr>
                        <td colspan="13" style="padding: 40px; color: #6b7280; font-style: italic;">
                            No uploaded projects.
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- 하단 버튼 영역 -->
        <div style="padding: 20px 25px; border-top: 1px solid #e5e7eb; background: #f8f9fa; display: flex; justify-content: flex-end; gap: 15px;">
            <button class="bottom-btn excel-download-btn" onclick="downloadProjectsAsExcel()">
                <span>📊</span>
                Download Excel
            </button>
            <button class="bottom-btn workspy-register-btn" onclick="registerToWorkspy()">
                <span>🚀</span>
                Register Workspy Project
            </button>
        </div>
    </div>
    
    <!-- 키보드 네비게이션 도움말 -->
    <div id="cellNavigator" class="cell-navigator">
        <div><strong>Excel-style Editing:</strong></div>
        <div>Arrow: Move cell | Enter/F2: Edit | Tab: Next cell | Del: Delete</div>
        <div>Shift+Click: Range select | Ctrl+C: Copy | Ctrl+V: Paste | Alt+Enter: Line break (Content)</div>
    </div>

    <script>
        let uploadedProjects = [];
        let currentSelectedCell = null;
        let isEditing = false;
        let selectedRange = [];
        let selectedTargetLanguages = [];
        
        // Close window
        function closeWindow() {
            if (confirm('Do you want to close this window?')) {
                window.close();
            }
        }
        
        // 도착 언어 다중 선택 초기화
        function initializeTargetLanguageSelector() {
            const trigger = document.getElementById('targetLanguageTrigger');
            const dropdown = document.getElementById('targetLanguageDropdown');
            const options = dropdown.querySelectorAll('.language-option');
            
            // 트리거 클릭 이벤트
            trigger.addEventListener('click', function(e) {
                e.stopPropagation();
                toggleDropdown();
            });
            
            // 키보드 이벤트 (스페이스바, 엔터)
            trigger.addEventListener('keydown', function(e) {
                if (e.key === ' ' || e.key === 'Enter') {
                    e.preventDefault();
                    toggleDropdown();
                }
            });
            
            // 옵션 클릭 이벤트
            options.forEach(option => {
                option.addEventListener('click', function(e) {
                    e.stopPropagation();
                    toggleLanguageSelection(this);
                });
            });
            
            // 외부 클릭 시 드롭다운 닫기
            document.addEventListener('click', function(e) {
                if (!trigger.contains(e.target) && !dropdown.contains(e.target)) {
                    closeDropdown();
                }
            });
        }
        
        // 드롭다운 토글
        function toggleDropdown() {
            const trigger = document.getElementById('targetLanguageTrigger');
            const dropdown = document.getElementById('targetLanguageDropdown');
            
            if (dropdown.classList.contains('show')) {
                closeDropdown();
            } else {
                openDropdown();
            }
        }
        
        // 드롭다운 열기
        function openDropdown() {
            const trigger = document.getElementById('targetLanguageTrigger');
            const dropdown = document.getElementById('targetLanguageDropdown');
            
            trigger.classList.add('open');
            dropdown.classList.add('show');
        }
        
        // 드롭다운 닫기
        function closeDropdown() {
            const trigger = document.getElementById('targetLanguageTrigger');
            const dropdown = document.getElementById('targetLanguageDropdown');
            
            trigger.classList.remove('open');
            dropdown.classList.remove('show');
        }
        
        // 언어 선택/해제
        function toggleLanguageSelection(option) {
            const language = option.dataset.value;
            
            if (option.classList.contains('selected')) {
                // 선택 해제
                option.classList.remove('selected');
                selectedTargetLanguages = selectedTargetLanguages.filter(lang => lang !== language);
            } else {
                // 선택 추가
                option.classList.add('selected');
                selectedTargetLanguages.push(language);
            }
            
            updateSelectedLanguagesDisplay();
        }
        
        // 선택된 언어 표시 업데이트
        function updateSelectedLanguagesDisplay() {
            const trigger = document.getElementById('targetLanguageTrigger');
            const selectedContainer = document.getElementById('selectedLanguages');
            const placeholder = trigger.querySelector('.placeholder');
            
            if (selectedTargetLanguages.length === 0) {
                placeholder.textContent = 'Select target language';
                placeholder.style.color = '#6b7280';
                selectedContainer.innerHTML = '';
            } else {
                placeholder.textContent = `${selectedTargetLanguages.length} languages selected`;
                placeholder.style.color = '#374151';
                
                // 선택된 언어 태그들 생성
                const tagsHTML = selectedTargetLanguages.map(language => `
                    <div class="selected-language-tag">
                        <span>${language}</span>
                        <span class="remove" onclick="removeSelectedLanguage('${language}')">✕</span>
                    </div>
                `).join('');
                
                selectedContainer.innerHTML = tagsHTML;
            }
        }
        
        // 선택된 언어 제거
        function removeSelectedLanguage(language) {
            // 배열에서 제거
            selectedTargetLanguages = selectedTargetLanguages.filter(lang => lang !== language);
            
            // 드롭다운 옵션에서 선택 해제
            const option = document.querySelector(`.language-option[data-value="${language}"]`);
            if (option) {
                option.classList.remove('selected');
            }
            
            updateSelectedLanguagesDisplay();
        }
        
        // 파일 선택 시뮬레이션 (기획용)
        function simulateFileSelect() {
            // 20개 파일이 선택된 것처럼 시뮬레이션
            const mockFileNames = [
                'meeting_001_policy_committee.m4a',
                'meeting_002_budget_review.m4a', 
                'meeting_003_urban_planning.m4a',
                'meeting_004_education_reform.m4a',
                'meeting_005_health_policy.m4a',
                'meeting_006_environment_protection.m4a',
                'meeting_007_transportation.m4a',
                'meeting_008_welfare_committee.m4a',
                'meeting_009_economic_development.m4a',
                'meeting_010_cultural_affairs.m4a',
                'meeting_011_public_safety.m4a',
                'meeting_012_housing_policy.m4a',
                'meeting_013_technology_innovation.m4a',
                'meeting_014_agriculture_committee.m4a',
                'meeting_015_tourism_development.m4a',
                'meeting_016_energy_policy.m4a',
                'meeting_017_social_welfare.m4a',
                'meeting_018_labor_relations.m4a',
                'meeting_019_foreign_affairs.m4a',
                'meeting_020_legal_affairs.m4a'
            ];
            
            // 드래그 영역 스타일 변경
            const uploadArea = document.querySelector('.file-upload-area');
            uploadArea.style.background = '#dcfce7';
            uploadArea.style.borderColor = '#10b981';
            uploadArea.querySelector('.upload-text').textContent = `${mockFileNames.length} files selected`;
            
            // Store file names in global variable
            window.selectedFileNames = mockFileNames;
            
            // Update file list
            updateUploadedFileList(mockFileNames);
            
            alert(`${mockFileNames.length} files have been selected.`);
        }
        
        // 개별 파일 삭제
        function removeIndividualFile(index) {
            if (!window.selectedFileNames || window.selectedFileNames.length === 0) return;
            
            // 해당 인덱스 파일 제거
            window.selectedFileNames.splice(index, 1);
            
            // 파일 리스트 업데이트
            updateUploadedFileList(window.selectedFileNames);
            
            // 모든 파일이 삭제되면 드래그 영역 초기화
            if (window.selectedFileNames.length === 0) {
                const uploadArea = document.querySelector('.file-upload-area');
                uploadArea.style.background = '#f9fafb';
                uploadArea.style.borderColor = '#d1d5db';
                uploadArea.querySelector('.upload-text').textContent = 'Drag and drop files here or click to select';
                
                // 프로젝트 목록도 초기화
                uploadedProjects = [];
                updateProjectList();
            }
        }
        
        // 업로드된 파일 리스트 업데이트
        function updateUploadedFileList(fileNames) {
            const fileListContainer = document.getElementById('uploadedFileList');
            const fileCountElement = document.getElementById('uploadedFileCount');
            
            if (!fileNames || fileNames.length === 0) {
                fileListContainer.innerHTML = `
                    <div style="text-align: center; color: #6b7280; padding: 40px 20px; font-style: italic;">
                        No uploaded files.
                    </div>
                `;
                fileCountElement.textContent = '0';
                return;
            }
            
            // 파일별 랜덤 작업시간 생성 (고정값으로 저장)
            if (!window.fileWorkTimes) {
                window.fileWorkTimes = {};
            }
            
            const fileListHTML = fileNames.map((fileName, index) => {
                // 기존에 생성된 작업시간이 있으면 사용, 없으면 새로 생성
                if (!window.fileWorkTimes[fileName]) {
                    const workMinutes = Math.floor(Math.random() * 170) + 10;
                    const workHours = Math.floor(workMinutes / 60);
                    const remainingMinutes = workMinutes % 60;
                    window.fileWorkTimes[fileName] = `${String(workHours).padStart(2, '0')}:${String(remainingMinutes).padStart(2, '0')}:00`;
                }
                
                const workTime = window.fileWorkTimes[fileName];
                
                return `
                    <div style="display: flex; align-items: center; padding: 8px 12px; background: white; border-radius: 6px; margin-bottom: 6px; border: 1px solid #e5e7eb;">
                        <div style="width: 30px; text-align: center; font-weight: 600; color: #374151; font-size: 12px;">
                            ${index + 1}
                        </div>
                        <div style="flex: 1; margin: 0 10px; text-align: center;">
                            <div style="font-weight: 500; color: #374151; font-size: 13px; margin-bottom: 2px;">
                                ${fileName}
                            </div>
                        </div>
                        <div style="width: 70px; text-align: center; font-weight: 600; color: #059669; font-size: 12px;">
                            ${workTime.substring(0, 5)}
                        </div>
                        <div style="width: 20px; text-align: center; margin-left: 8px;">
                            <button onclick="removeIndividualFile(${index})" style="background: #ef4444; color: white; border: none; border-radius: 50%; width: 18px; height: 18px; cursor: pointer; font-size: 10px; display: flex; align-items: center; justify-content: center; transition: all 0.2s;" 
                                    onmouseover="this.style.background='#dc2626'" 
                                    onmouseout="this.style.background='#ef4444'">
                                ✕
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
            
            fileListContainer.innerHTML = `
                <!-- Header -->
                <div style="display: flex; align-items: center; padding: 8px 12px; background: #e5e7eb; border-radius: 6px; margin-bottom: 10px; font-weight: 600; color: #374151; font-size: 12px;">
                    <div style="width: 30px; text-align: center;">NO</div>
                    <div style="flex: 1; margin: 0 10px; text-align: center;">File Name</div>
                    <div style="width: 70px; text-align: center;">Work Time</div>
                    <div style="width: 20px; text-align: center;"></div>
                </div>
                ${fileListHTML}
            `;
            
            fileCountElement.textContent = fileNames.length;
        }
        
        // 등록 시뮬레이션 (기획용)
        function simulateRegisterProjects() {
            // Verify file selection
            if (!window.selectedFileNames || window.selectedFileNames.length === 0) {
                alert('Please select files first.');
                return;
            }
            
            // 20개 프로젝트 데이터 생성
            const projects = window.selectedFileNames.map((fileName, index) => {
                // 랜덤 작업시간 생성 (10분~180분)
                const workMinutes = Math.floor(Math.random() * 170) + 10;
                const workHours = Math.floor(workMinutes / 60);
                const remainingMinutes = workMinutes % 60;
                const workTime = `${String(workHours).padStart(2, '0')}:${String(remainingMinutes).padStart(2, '0')}:00`;
                
                return {
                    service: '소리바로-VOD',
                    fileName: fileName,
                    workTime: workTime,
                    title: `VOD_(자막) / 재택 / ${workTime.substring(0, 5)}`,
                    qualification: '',
                    recruitStart: '',
                    recruitEnd: '',
                    recruitCount: '',
                    workStart: '',
                    workEnd: '',
                    amount: '',
                    content: ''
                };
            });
            
            uploadedProjects = projects;
            updateProjectList();
            
            alert(`${projects.length} projects have been created. You can now edit cells like in Excel.`);
        }
        
        // 엑셀 스타일 셀 클릭 처리
        function handleCellClick(cell, event) {
            event.preventDefault();
            event.stopPropagation();
            
            if (isEditing) return;
            
            if (event.shiftKey && currentSelectedCell) {
                // Shift + 클릭: 범위 선택
                selectCellRange(currentSelectedCell, cell);
            } else {
                // 단일 셀 선택
                selectSingleCell(cell);
            }
        }
        
        // 단일 셀 선택
        function selectSingleCell(cell) {
            // 모든 선택 해제
            document.querySelectorAll('.editable-cell').forEach(c => {
                c.classList.remove('selected');
            });
            selectedRange = [];
            
            // 현재 셀 선택
            currentSelectedCell = cell;
            cell.classList.add('selected');
            selectedRange = [cell];
            
            // 네비게이션 도움말 표시
            showNavigationHelp();
        }
        
        // 범위 선택
        function selectCellRange(startCell, endCell) {
            // 모든 선택 해제
            document.querySelectorAll('.editable-cell').forEach(c => {
                c.classList.remove('selected');
            });
            
            const table = startCell.closest('table');
            const rows = Array.from(table.querySelectorAll('tbody tr'));
            
            const startRow = rows.indexOf(startCell.closest('tr'));
            const endRow = rows.indexOf(endCell.closest('tr'));
            
            const startCells = Array.from(startCell.closest('tr').querySelectorAll('.editable-cell'));
            const endCells = Array.from(endCell.closest('tr').querySelectorAll('.editable-cell'));
            
            const startCol = startCells.indexOf(startCell);
            const endCol = endCells.indexOf(endCell);
            
            selectedRange = [];
            
            // 범위 선택
            for (let r = Math.min(startRow, endRow); r <= Math.max(startRow, endRow); r++) {
                const rowCells = Array.from(rows[r].querySelectorAll('.editable-cell'));
                for (let c = Math.min(startCol, endCol); c <= Math.max(startCol, endCol); c++) {
                    if (rowCells[c]) {
                        rowCells[c].classList.add('selected');
                        selectedRange.push(rowCells[c]);
                    }
                }
            }
            
            currentSelectedCell = endCell;
        }
        
        // 더블클릭으로 편집 모드 진입
        function startEditing(cell) {
            if (isEditing) return;
            
            isEditing = true;
            cell.classList.add('editing');
            cell.classList.remove('selected');
            
            const originalValue = cell.textContent.trim();
            const cellIndex = Array.from(cell.closest('tr').children).indexOf(cell);
            const isContentColumn = cellIndex === 12; // 내용 컬럼인지 확인
            
            // 내용 컬럼은 textarea, 나머지는 input 사용
            const inputElement = isContentColumn ? document.createElement('textarea') : document.createElement('input');
            
            if (!isContentColumn) {
                inputElement.type = 'text';
            }
            inputElement.value = originalValue;
            
            // 편집 완료 처리
            function finishEditing(save = true) {
                const newValue = save ? inputElement.value.trim() : originalValue;
                
                if (isContentColumn) {
                    // 내용 컬럼은 줄바꿈 유지
                    cell.innerHTML = newValue.replace(/\n/g, '<br>') || originalValue;
                } else {
                    cell.textContent = newValue || originalValue;
                }
                
                cell.classList.remove('editing');
                cell.classList.add('selected');
                isEditing = false;
                
                if (save && newValue !== originalValue) {
                    updateProjectData(cell, newValue || originalValue);
                }
            }
            
            // 이벤트 리스너
            inputElement.onblur = () => finishEditing(true);
            inputElement.onkeydown = function(e) {
                e.stopPropagation();
                
                if (e.key === 'Enter') {
                    if (e.altKey && isContentColumn) {
                        // Alt + Enter: 줄바꿈 (내용 컬럼만)
                        const cursorPos = inputElement.selectionStart;
                        const textBefore = inputElement.value.substring(0, cursorPos);
                        const textAfter = inputElement.value.substring(cursorPos);
                        inputElement.value = textBefore + '\n' + textAfter;
                        inputElement.selectionStart = inputElement.selectionEnd = cursorPos + 1;
                    } else {
                        // 일반 Enter: 편집 완료
                        finishEditing(true);
                        moveToNextCell(cell, 'down');
                    }
                } else if (e.key === 'Escape') {
                    finishEditing(false);
                } else if (e.key === 'Tab') {
                    e.preventDefault();
                    finishEditing(true);
                    moveToNextCell(cell, e.shiftKey ? 'left' : 'right');
                }
            };
            
            cell.innerHTML = '';
            cell.appendChild(inputElement);
            inputElement.focus();
            inputElement.select();
        }
        
        // 셀 이동 (화살표 키)
        function moveToNextCell(currentCell, direction) {
            const table = currentCell.closest('table');
            const rows = Array.from(table.querySelectorAll('tbody tr'));
            const currentRow = currentCell.closest('tr');
            const currentRowIndex = rows.indexOf(currentRow);
            const cells = Array.from(currentRow.querySelectorAll('.editable-cell'));
            const currentCellIndex = cells.indexOf(currentCell);
            
            let nextCell = null;
            
            switch(direction) {
                case 'left':
                    if (currentCellIndex > 0) {
                        nextCell = cells[currentCellIndex - 1];
                    }
                    break;
                case 'right':
                    if (currentCellIndex < cells.length - 1) {
                        nextCell = cells[currentCellIndex + 1];
                    }
                    break;
                case 'up':
                    if (currentRowIndex > 0) {
                        const prevRowCells = Array.from(rows[currentRowIndex - 1].querySelectorAll('.editable-cell'));
                        nextCell = prevRowCells[currentCellIndex];
                    }
                    break;
                case 'down':
                    if (currentRowIndex < rows.length - 1) {
                        const nextRowCells = Array.from(rows[currentRowIndex + 1].querySelectorAll('.editable-cell'));
                        nextCell = nextRowCells[currentCellIndex];
                    }
                    break;
            }
            
            if (nextCell) {
                selectSingleCell(nextCell);
                nextCell.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }
        
        // 네비게이션 도움말 표시
        function showNavigationHelp() {
            const navigator = document.getElementById('cellNavigator');
            if (navigator) {
                navigator.classList.add('show');
                
                // 5초 후 자동 숨김
                setTimeout(() => {
                    navigator.classList.remove('show');
                }, 5000);
            }
        }
        
        // 키보드 이벤트 처리
        function handleKeyboardNavigation(e) {
            if (!currentSelectedCell || isEditing) return;
            
            switch(e.key) {
                case 'ArrowLeft':
                    e.preventDefault();
                    moveToNextCell(currentSelectedCell, 'left');
                    break;
                case 'ArrowRight':
                    e.preventDefault();
                    moveToNextCell(currentSelectedCell, 'right');
                    break;
                case 'ArrowUp':
                    e.preventDefault();
                    moveToNextCell(currentSelectedCell, 'up');
                    break;
                case 'ArrowDown':
                    e.preventDefault();
                    moveToNextCell(currentSelectedCell, 'down');
                    break;
                case 'Tab':
                    e.preventDefault();
                    moveToNextCell(currentSelectedCell, e.shiftKey ? 'left' : 'right');
                    break;
                case 'Enter':
                case 'F2':
                    e.preventDefault();
                    startEditing(currentSelectedCell);
                    break;
                case 'Delete':
                case 'Backspace':
                    e.preventDefault();
                    if (selectedRange.length > 1) {
                        // 범위 삭제
                        selectedRange.forEach(cell => {
                            cell.textContent = '';
                            updateProjectData(cell, '');
                        });
                    } else {
                        currentSelectedCell.textContent = '';
                        updateProjectData(currentSelectedCell, '');
                    }
                    break;
                case 'c':
                case 'C':
                    if (e.ctrlKey) {
                        e.preventDefault();
                        copySelectedCells();
                    }
                    break;
                case 'v':
                case 'V':
                    if (e.ctrlKey) {
                        e.preventDefault();
                        pasteToSelectedCells();
                    }
                    break;
            }
        }
        
        // Copy function
        let clipboardData = [];
        
        function copySelectedCells() {
            clipboardData = selectedRange.map(cell => cell.textContent.trim());
            alert(`${clipboardData.length} cells copied.`);
        }
        
        // Paste function
        function pasteToSelectedCells() {
            if (clipboardData.length === 0) {
                alert('No copied data.');
                return;
            }
            
            if (selectedRange.length === 1 && clipboardData.length === 1) {
                // 단일 셀 붙여넣기
                currentSelectedCell.textContent = clipboardData[0];
                updateProjectData(currentSelectedCell, clipboardData[0]);
            } else if (selectedRange.length >= clipboardData.length) {
                // 범위 붙여넣기 - 복사된 데이터를 순서대로 붙여넣기
                selectedRange.forEach((cell, index) => {
                    const dataIndex = index % clipboardData.length; // 복사된 데이터 반복 사용
                    if (clipboardData[dataIndex] !== undefined) {
                        cell.textContent = clipboardData[dataIndex];
                        updateProjectData(cell, clipboardData[dataIndex]);
                    }
                });
            } else {
                // 선택된 범위가 복사된 데이터보다 작은 경우
                selectedRange.forEach((cell, index) => {
                    if (clipboardData[index] !== undefined) {
                        cell.textContent = clipboardData[index];
                        updateProjectData(cell, clipboardData[index]);
                    }
                });
            }
            
            alert(`Data pasted to ${Math.min(selectedRange.length, clipboardData.length)} cells.`);
        }
        
        // 프로젝트 데이터 업데이트
        function updateProjectData(cell, newValue) {
            const row = cell.closest('tr');
            const rowIndex = Array.from(row.parentElement.children).indexOf(row);
            const cellIndex = Array.from(row.children).indexOf(cell);
            
            if (uploadedProjects[rowIndex]) {
                const fieldMap = {
                    2: 'fileName',
                    3: 'workTime',
                    4: 'title',
                    5: 'qualification',
                    6: 'recruitStart',
                    7: 'recruitEnd',
                    8: 'recruitCount',
                    9: 'workStart',
                    10: 'workEnd',
                    11: 'amount',
                    12: 'content'
                };
                
                const fieldName = fieldMap[cellIndex];
                if (fieldName) {
                    uploadedProjects[rowIndex][fieldName] = newValue;
                    
                    // 작업시간이 변경되면 제목도 자동 업데이트
                    if (fieldName === 'workTime') {
                        // 시:분 형식으로 변환 (HH:MM:SS → HH:MM)
                        const timeForTitle = newValue.includes(':') ? newValue.substring(0, 5) : newValue;
                        const newTitle = `VOD_(자막) / 재택 / ${timeForTitle}`;
                        uploadedProjects[rowIndex]['title'] = newTitle;
                        
                        // 제목 셀도 화면에 업데이트
                        const titleCell = row.children[4];
                        if (titleCell) {
                            titleCell.textContent = newTitle;
                        }
                    }
                    
                    // 첫 번째 행의 특정 컬럼들이 수정되면 해당 컬럼의 모든 행에 같은 값 적용
                    const autoFillColumns = ['qualification', 'recruitStart', 'recruitEnd', 'recruitCount', 'workStart', 'workEnd', 'amount', 'content'];
                    
                    if (rowIndex === 0 && autoFillColumns.includes(fieldName) && newValue.trim() !== '') {
                        // If edited in first row, apply to all rows
                        fillColumnWithValue(cellIndex, fieldName, newValue);
                        
                        alert(`All rows in "${getColumnName(cellIndex)}" column have been filled with "${newValue}".`);
                    }
                    
                    console.log(`업데이트됨: ${fieldName} = ${newValue}`);
                }
            }
        }
        
        // 컬럼 전체를 같은 값으로 채우기
        function fillColumnWithValue(cellIndex, fieldName, value) {
            // 데이터 업데이트
            uploadedProjects.forEach((project, index) => {
                if (index > 0) { // 첫 번째 행은 이미 수정됨
                    project[fieldName] = value;
                }
            });
            
            // 화면 업데이트
            const table = document.querySelector('.project-table');
            const rows = Array.from(table.querySelectorAll('tbody tr'));
            
            rows.forEach((row, index) => {
                if (index > 0) { // 첫 번째 행은 이미 수정됨
                    const cell = row.children[cellIndex];
                    if (cell && cell.classList.contains('editable-cell')) {
                        if (fieldName === 'content') {
                            // 내용 컬럼은 줄바꿈 처리
                            cell.innerHTML = value.replace(/\n/g, '<br>');
                        } else {
                            cell.textContent = value;
                        }
                    }
                }
            });
        }
        
        // Get column name
        function getColumnName(cellIndex) {
            const columnNames = {
                2: 'File Name',
                3: 'Work Time',
                4: 'Title',
                5: 'Qualification',
                6: 'Recruitment Start',
                7: 'Recruitment End',
                8: 'Recruitments',
                9: 'Work Start',
                10: 'Work End',
                11: 'Amount',
                12: 'Content'
            };
            
            return columnNames[cellIndex] || 'Unknown';
        }
        
        // 드래그 앤 드롭 처리
        function handleDragOver(event) {
            event.preventDefault();
            event.currentTarget.classList.add('dragover');
        }
        
        function handleDragLeave(event) {
            event.currentTarget.classList.remove('dragover');
        }
        
        function handleDrop(event) {
            event.preventDefault();
            event.currentTarget.classList.remove('dragover');
            simulateFileSelect(); // 시뮬레이션으로 대체
        }
        
        // 실제 파일 선택 처리
        function handleFileSelect(event) {
            simulateFileSelect(); // 시뮬레이션으로 대체
        }
        
        // 전체 파일 제거
        function removeFile() {
            document.getElementById('fileInput').value = '';
            uploadedProjects = [];
            window.selectedFileNames = [];
            window.fileWorkTimes = {};
            
            // 드래그 영역 원복
            const uploadArea = document.querySelector('.file-upload-area');
            uploadArea.style.background = '#f9fafb';
            uploadArea.style.borderColor = '#d1d5db';
            uploadArea.querySelector('.upload-text').textContent = 'Drag and drop files here or click to select';
            
            // 파일 리스트 초기화
            updateUploadedFileList([]);
            
            updateProjectList();
        }
        
        // 프로젝트 목록 업데이트
        function updateProjectList() {
            const tbody = document.getElementById('projectTableBody');
            
            if (uploadedProjects.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="12" style="padding: 40px; color: #6b7280; font-style: italic;">
                            No uploaded projects.
                        </td>
                    </tr>
                `;
            } else {
                tbody.innerHTML = uploadedProjects.map((project, index) => {
                    const serviceClass = project.service.includes('VOD') ? 'status-ready' : 'status-pending';
                    return `
                        <tr>
                            <td>${index + 1}</td>
                            <td><span class="status-badge ${serviceClass}">${project.service}</span></td>
                            <td class="editable-cell">${project.fileName}</td>
                            <td class="editable-cell">${project.workTime}</td>
                            <td class="editable-cell">${project.title}</td>
                            <td class="editable-cell">${project.qualification}</td>
                            <td class="editable-cell">${project.recruitStart}</td>
                            <td class="editable-cell">${project.recruitEnd}</td>
                            <td class="editable-cell">${project.recruitCount}</td>
                            <td class="editable-cell">${project.workStart}</td>
                            <td class="editable-cell">${project.workEnd}</td>
                            <td class="editable-cell">${project.amount}</td>
                            <td class="editable-cell">${project.content}</td>
                        </tr>
                    `;
                }).join('');
                
                // 이벤트 리스너 재등록
                setTimeout(() => {
                    document.querySelectorAll('.editable-cell').forEach(cell => {
                        cell.addEventListener('click', function(e) {
                            handleCellClick(this, e);
                        });
                        cell.addEventListener('dblclick', function(e) {
                            e.preventDefault();
                            startEditing(this);
                        });
                    });
                }, 100);
            }
            
            // 프로젝트 개수 업데이트
            document.getElementById('projectCount').textContent = uploadedProjects.length;
        }
        
        // 전체 선택/해제 (체크박스 제거로 인해 사용 안함)
        function toggleAllProjects() {
            // 체크박스 컬럼이 제거되어 사용하지 않음
        }
        
        // Register Workspy project (main registration button)
        function registerToWorkspy() {
            if (uploadedProjects.length === 0) {
                alert('No projects to register.');
                return;
            }
            
            // Validate basic information
            const projectTitle = document.getElementById('projectTitle').value.trim();
            const companyName = document.getElementById('companyName').value;
            const clientName = document.getElementById('clientName').value.trim();
            const sourceLanguage = document.getElementById('sourceLanguage').value;
            
            if (!projectTitle) {
                alert('Please enter project title.');
                document.getElementById('projectTitle').focus();
                return;
            }
            
            if (!companyName) {
                alert('Please select company name.');
                document.getElementById('companyName').focus();
                return;
            }
            
            if (!clientName) {
                alert('Please enter client name.');
                document.getElementById('clientName').focus();
                return;
            }
            
            if (!sourceLanguage) {
                alert('Please select source language.');
                document.getElementById('sourceLanguage').focus();
                return;
            }
            
            if (selectedTargetLanguages.length === 0) {
                alert('Please select at least one target language.');
                document.getElementById('targetLanguageTrigger').focus();
                return;
            }
            
            // Confirm Workspy registration
            if (confirm(`Do you want to register ${uploadedProjects.length} projects to Workspy?\n\nAfter registration, worker recruitment will begin on the Workspy platform.`)) {
                // 부모 창(trans-management.html)에 프로젝트 추가
                addProjectsToParentPage(projectTitle, companyName, clientName);
                
                // Registration process (simulation)
                setTimeout(() => {
                    alert(`🎉 Success!\n\n${uploadedProjects.length} projects have been successfully registered to Workspy.\n\n• Project registration completed\n• Worker recruitment started\n• Progress can be checked on the admin page\n• Items added to Translation Work Management page.`);
                    
                    // 등록 완료 후 데이터 초기화
                    uploadedProjects = [];
                    updateProjectList();
                    
                    // 선택 상태 초기화
                    currentSelectedCell = null;
                    selectedRange = [];
                    
                    // 기본 정보도 초기화
                    document.getElementById('projectTitle').value = '';
                    document.getElementById('companyName').value = '';
                    document.getElementById('clientName').value = '';
                    document.getElementById('sourceLanguage').value = '';
                    
                    // 도착 언어 초기화
                    selectedTargetLanguages = [];
                    document.querySelectorAll('.language-option.selected').forEach(option => {
                        option.classList.remove('selected');
                    });
                    updateSelectedLanguagesDisplay();
                    
                    // 파일 정보도 초기화
                    removeFile();
                    
                    // Close window option (after parent window refresh)
                    setTimeout(() => {
                        if (confirm('Registration completed. Do you want to close this window?')) {
                            // Focus on parent window
                            if (window.opener && !window.opener.closed) {
                                window.opener.focus();
                            }
                            window.close();
                        }
                    }, 500);
                }, 1000);
            }
        }
        
        // 부모 페이지(trans-management.html)에 프로젝트 추가
        function addProjectsToParentPage(projectTitle, companyName, clientName) {
            try {
                // localStorage를 사용하여 데이터 전달 (더 안전한 방법)
                const projectsToAdd = uploadedProjects.map((project, index) => {
                    // 제목 형식: "프로젝트제목_NO" (큰 숫자부터)
                    const projectNumber = String(uploadedProjects.length - index).padStart(2, '0');
                    const generatedTitle = `${projectTitle}_${projectNumber}`;
                    
                    // 새 주문번호 생성
                    const now = new Date();
                    const year = now.getFullYear();
                    const month = String(now.getMonth() + 1).padStart(2, '0');
                    const day = String(now.getDate()).padStart(2, '0');
                    const hours = String(now.getHours()).padStart(2, '0');
                    const minutes = String(now.getMinutes()).padStart(2, '0');
                    const seconds = String(now.getSeconds() + index).padStart(2, '0'); // 각각 다른 초
                    const orderNumber = `${year}${month}${day}${hours}${minutes}${seconds}`;
                    
                    // 오늘 날짜와 시간
                    const today = `${year}-${month}-${day} ${hours}:${minutes}`;
                    
                    return {
                        orderNumber: orderNumber,
                        title: generatedTitle,
                        companyName: companyName,
                        clientName: clientName,
                        requestDate: today,
                        workTime: project.workTime,
                        status: '접수'
                    };
                });
                
                // localStorage에 데이터 저장
                localStorage.setItem('bulkProjectsData', JSON.stringify(projectsToAdd));
                localStorage.setItem('bulkProjectsAdded', 'true');
                
                console.log(`Saved ${projectsToAdd.length} project data to localStorage.`);
                
                // 부모 창이 존재하는 경우 직접 호출도 시도
                if (window.opener && !window.opener.closed) {
                    try {
                        if (typeof window.opener.addBulkProjectsToTable === 'function') {
                            window.opener.addBulkProjectsToTable(projectsToAdd);
                            window.opener.focus();
                        }
                        
                        // 부모 창에 새로고침 신호
                        if (typeof window.opener.checkForBulkProjects === 'function') {
                            window.opener.checkForBulkProjects();
                        }
                    } catch (e) {
                        console.log('Direct call failed, using localStorage method:', e);
                    }
                }
                
            } catch (error) {
                console.error('Failed to pass data to parent page:', error);
            }
        }
        
        // Excel download function
        function downloadProjectsAsExcel() {
            if (uploadedProjects.length === 0) {
                alert('No projects to download.');
                return;
            }
            
            // 엑셀 다운로드 시뮬레이션
            const projectData = uploadedProjects.map((project, index) => ({
                NO: index + 1,
                서비스: project.service,
                파일이름: project.fileName,
                작업시간: project.workTime,
                제목: project.title,
                지원자격: project.qualification,
                모집기간_시작: project.recruitStart,
                모집기간_종료: project.recruitEnd,
                모집인원: project.recruitCount,
                작업기간_시작: project.workStart,
                작업기간_종료: project.workEnd,
                금액: project.amount,
                내용: project.content
            }));
            
            console.log('엑셀 다운로드 데이터:', projectData);
            
            // In production: generate and download Excel file
            alert(`📊 Excel Download\n\nDownloading ${uploadedProjects.length} project data to Excel file.\n\nFile name: Workspy_Project_List_${new Date().toISOString().split('T')[0]}.xlsx`);
        }
        
        // 기존 등록 버튼 (상단)
        function registerProjects() {
            // 상단 등록 버튼은 하단 메인 버튼으로 리다이렉트
            registerToWorkspy();
        }
        
        // 페이지 로드 시 초기화
        document.addEventListener('DOMContentLoaded', function() {
            updateProjectList();
            
            // 도착 언어 다중 선택 초기화
            initializeTargetLanguageSelector();
            
            // 키보드 이벤트 리스너 추가
            document.addEventListener('keydown', handleKeyboardNavigation);
            
            // 외부 클릭 시 셀 선택 해제
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.editable-cell') && !isEditing) {
                    if (currentSelectedCell) {
                        document.querySelectorAll('.editable-cell').forEach(c => {
                            c.classList.remove('selected');
                        });
                        currentSelectedCell = null;
                        selectedRange = [];
                        document.getElementById('cellNavigator').classList.remove('show');
                    }
                }
            });
        });
    </script>
</body>
</html>