<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bulk Project Registration - VOD Work Management</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            padding: 30px;
            min-height: 100vh;
        }
        
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e5e7eb;
        }
        
        .page-title {
            font-size: 28px;
            font-weight: 600;
            color: #374151;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .close-button {
            background: #6b7280;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .close-button:hover {
            background: #4b5563;
        }
        
        /* ê¸°ë³¸ ì •ë³´ ì˜ì—­ */
        .basic-info-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border: 1px solid #e5e7eb;
        }
        
        .basic-info-header {
            font-size: 18px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .basic-info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }
        
        .language-info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }
        
        .basic-info-grid .form-group,
        .language-info-grid .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .basic-info-grid .form-group input,
        .basic-info-grid .form-group select,
        .language-info-grid .form-group input,
        .language-info-grid .form-group select {
            padding: 15px 20px;
            border: 1px solid #d1d5db;
            border-radius: 10px;
            font-size: 16px;
            background: white;
            transition: all 0.2s;
            width: 100%;
            box-sizing: border-box;
            cursor: pointer;
        }
        
        .basic-info-grid .form-group input:focus,
        .basic-info-grid .form-group select:focus,
        .language-info-grid .form-group input:focus,
        .language-info-grid .form-group select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
            transform: translateY(-1px);
        }
        
        .basic-info-grid .form-group label,
        .language-info-grid .form-group label {
            margin-bottom: 12px;
            font-size: 16px;
            font-weight: 600;
            color: #374151;
        }
        
        /* í•„ìˆ˜ ì…ë ¥ í‘œì‹œ */
        .required {
            color: #ef4444;
            font-weight: 700;
            margin-left: 4px;
        }
        
        /* ë„ì°© ì–¸ì–´ ë‹¤ì¤‘ ì„ íƒ */
        .language-multi-select {
            position: relative;
            width: 100%;
        }
        
        .language-select-trigger {
            padding: 15px 20px;
            border: 1px solid #d1d5db;
            border-radius: 10px;
            font-size: 16px;
            background: white;
            transition: all 0.2s;
            width: 100%;
            box-sizing: border-box;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            min-height: 54px;
        }
        
        .language-select-trigger:focus,
        .language-select-trigger.open {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
            transform: translateY(-1px);
        }
        
        .language-select-trigger .selected-count {
            color: #6b7280;
            font-size: 14px;
        }
        
        .language-select-trigger .arrow {
            transition: transform 0.2s;
        }
        
        .language-select-trigger.open .arrow {
            transform: rotate(180deg);
        }
        
        .language-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            max-height: 300px;
            overflow-y: auto;
            display: none;
            margin-top: 5px;
        }
        
        .language-dropdown.show {
            display: block;
        }
        
        .language-group {
            border-bottom: 1px solid #e5e7eb;
        }
        
        .language-group:last-child {
            border-bottom: none;
        }
        
        .language-group-title {
            padding: 12px 20px;
            background: #f8f9fa;
            font-weight: 600;
            color: #374151;
            font-size: 14px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .language-option {
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 15px;
        }
        
        .language-option:hover {
            background: #f3f4f6;
        }
        
        .language-option.selected {
            background: #dbeafe;
            color: #1e40af;
            font-weight: 500;
        }
        
        .language-option .checkmark {
            opacity: 0;
            color: #10b981;
            font-weight: bold;
            transition: opacity 0.2s;
        }
        
        .language-option.selected .checkmark {
            opacity: 1;
        }
        
        .selected-languages {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 8px;
            max-height: 60px;
            overflow-y: auto;
        }
        
        .selected-language-tag {
            background: #dbeafe;
            color: #1e40af;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .selected-language-tag .remove {
            cursor: pointer;
            color: #ef4444;
            font-weight: bold;
            font-size: 10px;
        }
        
        .selected-language-tag .remove:hover {
            color: #dc2626;
        }
        
        /* íŒŒì¼ ì—…ë¡œë“œ ì˜ì—­ */
        .upload-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border: 1px solid #e5e7eb;
        }
        
        .upload-header {
            font-size: 18px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .file-upload-area {
            border: 2px dashed #d1d5db;
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            background: #f9fafb;
            transition: all 0.2s;
            cursor: pointer;
            margin-bottom: 15px;
        }
        
        .file-upload-area:hover {
            border-color: #3b82f6;
            background: #eff6ff;
        }
        
        .file-upload-area.dragover {
            border-color: #3b82f6;
            background: #eff6ff;
            transform: scale(1.02);
        }
        
        .upload-icon {
            font-size: 48px;
            margin-bottom: 15px;
            color: #6b7280;
        }
        
        .upload-text {
            font-size: 16px;
            color: #374151;
            margin-bottom: 8px;
        }
        
        .file-input {
            display: none;
        }
        
        .file-select-btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .file-select-btn:hover {
            background: #2563eb;
        }
        
        .register-btn {
            background: #10b981;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .register-btn:hover {
            background: #059669;
        }
        
        /* í•˜ë‹¨ ë²„íŠ¼ë“¤ */
        .bottom-btn {
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ */
        .excel-download-btn {
            background: #10b981;
            color: white;
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
        }
        
        .excel-download-btn:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }
        
        .excel-download-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
        }
        
        /* ì›ìŠ¤íŒŒì´ í”„ë¡œì íŠ¸ ë“±ë¡ ë²„íŠ¼ */
        .workspy-register-btn {
            background: #7c3aed;
            color: white;
            box-shadow: 0 2px 8px rgba(124, 58, 237, 0.3);
        }
        
        .workspy-register-btn:hover {
            background: #6d28d9;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.4);
        }
        
        .workspy-register-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(124, 58, 237, 0.3);
        }
        
        /* í”„ë¡œì íŠ¸ ë¦¬ìŠ¤íŠ¸ ì˜ì—­ */
        .project-list-section {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border: 1px solid #e5e7eb;
            overflow: hidden;
        }
        
        .list-header {
            background: #f8f9fa;
            padding: 20px 25px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .list-title {
            font-size: 18px;
            font-weight: 600;
            color: #374151;
        }
        
        .list-info {
            color: #6b7280;
            font-size: 14px;
        }
        
        .project-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .project-table th,
        .project-table td {
            padding: 8px 6px;
            text-align: center;
            border: 1px solid #e5e7eb;
            font-size: 13px;
            position: relative;
        }
        
        .project-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #374151;
            border-bottom: 2px solid #d1d5db;
        }
        
        .project-table td {
            color: #6b7280;
            min-height: 35px;
        }
        
        /* ì—‘ì…€ ìŠ¤íƒ€ì¼ ì…€ */
        .editable-cell {
            cursor: cell;
            transition: all 0.1s;
            user-select: none;
            border: 1px solid #e5e7eb;
        }
        
        .editable-cell:hover {
            background: #f0f9ff;
            border-color: #93c5fd;
        }
        
        .editable-cell.selected {
            background: #dbeafe;
            border: 2px solid #3b82f6;
            box-shadow: 0 0 0 1px #3b82f6;
        }
        
        .editable-cell.editing {
            background: white;
            border: 2px solid #10b981;
            box-shadow: 0 0 0 1px #10b981;
        }
        
        .editable-cell input {
            width: 100%;
            height: 100%;
            border: none;
            background: transparent;
            padding: 4px 8px;
            font-size: 13px;
            color: #374151;
            text-align: center;
            outline: none;
        }
        
        .editable-cell textarea {
            width: 100%;
            min-height: 60px;
            border: none;
            background: transparent;
            padding: 4px 8px;
            font-size: 13px;
            color: #374151;
            text-align: left;
            outline: none;
            resize: vertical;
            font-family: inherit;
            line-height: 1.4;
        }
        
        /* ìƒíƒœ ë°°ì§€ */
        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            white-space: nowrap;
        }
        
        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-ready {
            background: #dbeafe;
            color: #1e40af;
        }
        
        /* í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ ë„ì›€ë§ */
        .cell-navigator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #374151;
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
        }
        
        .cell-navigator.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            body {
                padding: 20px;
            }
            
            .cell-navigator {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="page-header">
        <h1 class="page-title">
            <span>ğŸ“</span>
            Bulk Project Registration
        </h1>
        <button class="close-button" onclick="closeWindow()">
            <span>âœ•</span>
            Close
        </button>
    </div>
    
    <!-- ê¸°ë³¸ ì •ë³´ ì˜ì—­ -->
    <div class="basic-info-section">
        <div class="basic-info-header">
            <span>ğŸ“‹</span>
            Basic Information
        </div>
        
        <!-- ì²« ë²ˆì§¸ í–‰: í”„ë¡œì íŠ¸ ì œëª© | ì—…ì²´ëª… | ì˜ë¢°ìëª… -->
        <div class="basic-info-grid">
            <div class="form-group">
                <label for="projectTitle">Project Title <span class="required">*</span></label>
                <input type="text" id="projectTitle" placeholder="Enter project title" required>
            </div>
            <div class="form-group">
                <label for="companyName">Company Name <span class="required">*</span></label>
                <select id="companyName" required>
                    <option value="">Select company</option>
                    <option value="ê°€ì²œëŒ€í•™êµ">ê°€ì²œëŒ€í•™êµ</option>
                    <option value="ê°•ì›ëŒ€í•™êµ">ê°•ì›ëŒ€í•™êµ</option>
                    <option value="ê±´êµ­ëŒ€í•™êµ">ê±´êµ­ëŒ€í•™êµ</option>
                    <option value="ê²½ë¶ëŒ€í•™êµ">ê²½ë¶ëŒ€í•™êµ</option>
                    <option value="ê²½í¬ëŒ€í•™êµ">ê²½í¬ëŒ€í•™êµ</option>
                    <option value="ê³ ë ¤ëŒ€í•™êµ">ê³ ë ¤ëŒ€í•™êµ</option>
                    <option value="êµ­ë¯¼ëŒ€í•™êµ">êµ­ë¯¼ëŒ€í•™êµ</option>
                    <option value="ë‹¨êµ­ëŒ€í•™êµ">ë‹¨êµ­ëŒ€í•™êµ</option>
                    <option value="ë™êµ­ëŒ€í•™êµ">ë™êµ­ëŒ€í•™êµ</option>
                    <option value="ë¶€ì‚°ëŒ€í•™êµ">ë¶€ì‚°ëŒ€í•™êµ</option>
                    <option value="ì„œê°•ëŒ€í•™êµ">ì„œê°•ëŒ€í•™êµ</option>
                    <option value="ì„œìš¸ëŒ€í•™êµ">ì„œìš¸ëŒ€í•™êµ</option>
                    <option value="ì„±ê· ê´€ëŒ€í•™êµ">ì„±ê· ê´€ëŒ€í•™êµ</option>
                    <option value="ì„¸ì¢…ëŒ€í•™êµ">ì„¸ì¢…ëŒ€í•™êµ</option>
                    <option value="ì•„ì£¼ëŒ€í•™êµ">ì•„ì£¼ëŒ€í•™êµ</option>
                    <option value="ì—°ì„¸ëŒ€í•™êµ">ì—°ì„¸ëŒ€í•™êµ</option>
                    <option value="ì´í™”ì—¬ìëŒ€í•™êµ">ì´í™”ì—¬ìëŒ€í•™êµ</option>
                    <option value="ì¸í•˜ëŒ€í•™êµ">ì¸í•˜ëŒ€í•™êµ</option>
                    <option value="ì „ë‚¨ëŒ€í•™êµ">ì „ë‚¨ëŒ€í•™êµ</option>
                    <option value="ì „ë¶ëŒ€í•™êµ">ì „ë¶ëŒ€í•™êµ</option>
                    <option value="ì œì£¼ëŒ€í•™êµ">ì œì£¼ëŒ€í•™êµ</option>
                    <option value="ì¤‘ì•™ëŒ€í•™êµ">ì¤‘ì•™ëŒ€í•™êµ</option>
                    <option value="ì¶©ë‚¨ëŒ€í•™êµ">ì¶©ë‚¨ëŒ€í•™êµ</option>
                    <option value="ì¹´ì´ìŠ¤íŠ¸">ì¹´ì´ìŠ¤íŠ¸</option>
                    <option value="í¬ìŠ¤í…">í¬ìŠ¤í…</option>
                    <option value="í•œì–‘ëŒ€í•™êµ">í•œì–‘ëŒ€í•™êµ</option>
                    <option value="í™ìµëŒ€í•™êµ">í™ìµëŒ€í•™êµ</option>
                    <option value="DGIST">DGIST</option>
                    <option value="GIST">GIST</option>
                    <option value="UNIST">UNIST</option>
                </select>
            </div>
            <div class="form-group">
                <label for="clientName">Client Name <span class="required">*</span></label>
                <input type="text" id="clientName" placeholder="Enter client name" required>
            </div>
        </div>
        
        <!-- ë‘ ë²ˆì§¸ í–‰: ì›ë³¸ ì–¸ì–´ | ë„ì°© ì–¸ì–´ -->
        <div class="language-info-grid">
            <div class="form-group">
                <label for="sourceLanguage">Source Language <span class="required">*</span></label>
                <select id="sourceLanguage" required>
                    <option value="">Select source language</option>
                    <optgroup label="Asia/Africa">
                        <option value="ë„¤íŒ”ì–´">ë„¤íŒ”ì–´</option>
                        <option value="ë§ë ˆì´ì–´">ë§ë ˆì´ì–´</option>
                        <option value="ë§ë¼ì–„ëŒì–´">ë§ë¼ì–„ëŒì–´</option>
                        <option value="ë§ˆë¼í‹°ì–´">ë§ˆë¼í‹°ì–´</option>
                        <option value="ëª½ê³¨ì–´">ëª½ê³¨ì–´</option>
                        <option value="ë²µê³¨ì–´">ë²µê³¨ì–´</option>
                        <option value="ì•„ëì–´">ì•„ëì–´</option>
                        <option value="ìš°ë¥´ë‘ì–´">ìš°ë¥´ë‘ì–´</option>
                        <option value="ìš°ì¦ˆë²¡ì–´">ìš°ì¦ˆë²¡ì–´</option>
                        <option value="ì¸ë„ë„¤ì‹œì•„ì–´">ì¸ë„ë„¤ì‹œì•„ì–´</option>
                        <option value="ì¼ë³¸ì–´">ì¼ë³¸ì–´</option>
                        <option value="ì¤‘êµ­ì–´(ê°„ì²´)">ì¤‘êµ­ì–´(ê°„ì²´)</option>
                        <option value="ì¤‘êµ­ì–´(ë²ˆì²´)">ì¤‘êµ­ì–´(ë²ˆì²´)</option>
                        <option value="ì¹´ìíì–´">ì¹´ìíì–´</option>
                        <option value="ì¹¸ë‚˜ë‹¤ì–´">ì¹¸ë‚˜ë‹¤ì–´</option>
                        <option value="í¬ë©”ë¥´ì–´">í¬ë©”ë¥´ì–´</option>
                        <option value="íƒ€ë°€ì–´">íƒ€ë°€ì–´</option>
                        <option value="íƒœêµ­ì–´">íƒœêµ­ì–´</option>
                        <option value="í…”ë£¨êµ¬ì–´">í…”ë£¨êµ¬ì–´</option>
                        <option value="í„°í‚¤ì–´">í„°í‚¤ì–´</option>
                        <option value="í€ìë¸Œì–´">í€ìë¸Œì–´</option>
                        <option value="í•„ë¦¬í•€ì–´">í•„ë¦¬í•€ì–´</option>
                        <option value="í•œê¸€">í•œê¸€</option>
                        <option value="íŒë””ì–´">íŒë””ì–´</option>
                        <option value="ë² íŠ¸ë‚¨ì–´">ë² íŠ¸ë‚¨ì–´</option>
                        <option value="êµ¬ìë¼íŠ¸ì–´">êµ¬ìë¼íŠ¸ì–´</option>
                    </optgroup>
                    <optgroup label="Europe/Africa">
                        <option value="ê³¼ë¼ë‹ˆì–´">ê³¼ë¼ë‹ˆì–´</option>
                        <option value="ê·¸ë¦¬ìŠ¤ì–´">ê·¸ë¦¬ìŠ¤ì–´</option>
                        <option value="ë„¤ëœë€ë“œì–´">ë„¤ëœë€ë“œì–´</option>
                        <option value="ë´ë§ˆí¬ì–´">ë´ë§ˆí¬ì–´</option>
                        <option value="ë…ì¼ì–´">ë…ì¼ì–´</option>
                        <option value="ëŸ¬ì‹œì•„ì–´">ëŸ¬ì‹œì•„ì–´</option>
                        <option value="ìŠ¤ì›¨ë´ì–´">ìŠ¤ì›¨ë´ì–´</option>
                        <option value="ìŠ¤í˜ì¸ì–´">ìŠ¤í˜ì¸ì–´</option>
                        <option value="ì˜ì–´">ì˜ì–´</option>
                        <option value="ì´íƒˆë¦¬ì•„ì–´">ì´íƒˆë¦¬ì•„ì–´</option>
                        <option value="ì²´ì½”ì–´">ì²´ì½”ì–´</option>
                        <option value="í´ë€ë“œì–´">í´ë€ë“œì–´</option>
                        <option value="í¬ë¥´íˆ¬ê°ˆì–´">í¬ë¥´íˆ¬ê°ˆì–´</option>
                        <option value="í”„ë‘ìŠ¤ì–´">í”„ë‘ìŠ¤ì–´</option>
                        <option value="í•€ë€ë“œì–´">í•€ë€ë“œì–´</option>
                        <option value="í—ê°€ë¦¬ì–´">í—ê°€ë¦¬ì–´</option>
                    </optgroup>
                </select>
            </div>
            <div class="form-group">
                <label for="targetLanguage">Target Language <span class="required">*</span></label>
                <div class="language-multi-select">
                    <div class="language-select-trigger" id="targetLanguageTrigger" tabindex="0">
                        <span class="placeholder">Select target language</span>
                        <span class="arrow">â–¼</span>
                    </div>
                    <div class="language-dropdown" id="targetLanguageDropdown">
                        <div class="language-group">
                            <div class="language-group-title">Asia/Africa</div>
                            <div class="language-option" data-value="ë„¤íŒ”ì–´">
                                <span>ë„¤íŒ”ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ë§ë ˆì´ì–´">
                                <span>ë§ë ˆì´ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ë§ë¼ì–„ëŒì–´">
                                <span>ë§ë¼ì–„ëŒì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ë§ˆë¼í‹°ì–´">
                                <span>ë§ˆë¼í‹°ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ëª½ê³¨ì–´">
                                <span>ëª½ê³¨ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ë²µê³¨ì–´">
                                <span>ë²µê³¨ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ì•„ëì–´">
                                <span>ì•„ëì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ìš°ë¥´ë‘ì–´">
                                <span>ìš°ë¥´ë‘ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ìš°ì¦ˆë²¡ì–´">
                                <span>ìš°ì¦ˆë²¡ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ì¸ë„ë„¤ì‹œì•„ì–´">
                                <span>ì¸ë„ë„¤ì‹œì•„ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ì¼ë³¸ì–´">
                                <span>ì¼ë³¸ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ì¤‘êµ­ì–´(ê°„ì²´)">
                                <span>ì¤‘êµ­ì–´(ê°„ì²´)</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ì¤‘êµ­ì–´(ë²ˆì²´)">
                                <span>ì¤‘êµ­ì–´(ë²ˆì²´)</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ì¹´ìíì–´">
                                <span>ì¹´ìíì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ì¹¸ë‚˜ë‹¤ì–´">
                                <span>ì¹¸ë‚˜ë‹¤ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="í¬ë©”ë¥´ì–´">
                                <span>í¬ë©”ë¥´ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="íƒ€ë°€ì–´">
                                <span>íƒ€ë°€ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="íƒœêµ­ì–´">
                                <span>íƒœêµ­ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="í…”ë£¨êµ¬ì–´">
                                <span>í…”ë£¨êµ¬ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="í„°í‚¤ì–´">
                                <span>í„°í‚¤ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="í€ìë¸Œì–´">
                                <span>í€ìë¸Œì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="í•„ë¦¬í•€ì–´">
                                <span>í•„ë¦¬í•€ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="í•œê¸€">
                                <span>í•œê¸€</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="íŒë””ì–´">
                                <span>íŒë””ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ë² íŠ¸ë‚¨ì–´">
                                <span>ë² íŠ¸ë‚¨ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="êµ¬ìë¼íŠ¸ì–´">
                                <span>êµ¬ìë¼íŠ¸ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                        </div>
                        <div class="language-group">
                            <div class="language-group-title">Europe/Africa</div>
                            <div class="language-option" data-value="ê³¼ë¼ë‹ˆì–´">
                                <span>ê³¼ë¼ë‹ˆì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ê·¸ë¦¬ìŠ¤ì–´">
                                <span>ê·¸ë¦¬ìŠ¤ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ë„¤ëœë€ë“œì–´">
                                <span>ë„¤ëœë€ë“œì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ë´ë§ˆí¬ì–´">
                                <span>ë´ë§ˆí¬ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ë…ì¼ì–´">
                                <span>ë…ì¼ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ëŸ¬ì‹œì•„ì–´">
                                <span>ëŸ¬ì‹œì•„ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ìŠ¤ì›¨ë´ì–´">
                                <span>ìŠ¤ì›¨ë´ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ìŠ¤í˜ì¸ì–´">
                                <span>ìŠ¤í˜ì¸ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ì˜ì–´">
                                <span>ì˜ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ì´íƒˆë¦¬ì•„ì–´">
                                <span>ì´íƒˆë¦¬ì•„ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="ì²´ì½”ì–´">
                                <span>ì²´ì½”ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="í´ë€ë“œì–´">
                                <span>í´ë€ë“œì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="í¬ë¥´íˆ¬ê°ˆì–´">
                                <span>í¬ë¥´íˆ¬ê°ˆì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="í”„ë‘ìŠ¤ì–´">
                                <span>í”„ë‘ìŠ¤ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="í•€ë€ë“œì–´">
                                <span>í•€ë€ë“œì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                            <div class="language-option" data-value="í—ê°€ë¦¬ì–´">
                                <span>í—ê°€ë¦¬ì–´</span>
                                <span class="checkmark">âœ“</span>
                            </div>
                        </div>
                    </div>
                    <div class="selected-languages" id="selectedLanguages"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- íŒŒì¼ ì—…ë¡œë“œ ì˜ì—­ -->
    <div class="upload-section">
        <div class="upload-header">
            <span>ğŸ“¤</span>
            File Upload
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px;">
            <!-- ì™¼ìª½: ë“œë˜ê·¸ ì—…ë¡œë“œ ì˜ì—­ -->
            <div>
                <div class="file-upload-area" onclick="document.getElementById('fileInput').click()" 
                     ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                    <div class="upload-icon">ğŸ“</div>
                    <div class="upload-text">Drag and drop files here or click to select</div>
                </div>
                
                <input type="file" id="fileInput" class="file-input" accept=".xlsx,.xls" onchange="handleFileSelect(event)">
                
                
                <!-- ë²„íŠ¼ ì˜ì—­ -->
                <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 15px;">
                    <button class="file-select-btn" onclick="simulateFileSelect()">
                        <span>ğŸ“‚</span>
                        Select Files
                    </button>
                    
                    <button class="register-btn" onclick="simulateRegisterProjects()">
                        <span>âœ…</span>
                        Register
                    </button>
                </div>
            </div>
            
            <!-- ì˜¤ë¥¸ìª½: ì—…ë¡œë“œëœ íŒŒì¼ ë¦¬ìŠ¤íŠ¸ -->
            <div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #e5e7eb; height: 100%;">
                    <div style="font-weight: 600; color: #374151; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                        <span>ğŸ“‹</span>
                        Uploaded Files (<span id="uploadedFileCount">0</span>)
                    </div>
                    
                    <div id="uploadedFileList" style="max-height: 300px; overflow-y: auto;">
                        <div style="text-align: center; color: #6b7280; padding: 40px 20px; font-style: italic;">
                            No uploaded files.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- í”„ë¡œì íŠ¸ ë¦¬ìŠ¤íŠ¸ ì˜ì—­ -->
    <div class="project-list-section">
        <div class="list-header">
            <h2 class="list-title">Project List</h2>
            <div class="list-info">Total <span id="projectCount">0</span> items</div>
        </div>
        
        <div style="overflow-x: auto;">
            <table class="project-table">
                <thead>
                    <tr>
                        <th width="50">NO</th>
                        <th width="120">Service</th>
                        <th width="200">File Name</th>
                        <th width="100">Work Time</th>
                        <th width="250">Title</th>
                        <th width="80">Qualification</th>
                        <th width="160">Recruitment Start</th>
                        <th width="160">Recruitment End</th>
                        <th width="80">Recruitments</th>
                        <th width="120">Work Start</th>
                        <th width="120">Work End</th>
                        <th width="100">Amount</th>
                        <th width="250">Content</th>
                    </tr>
                </thead>
                <tbody id="projectTableBody">
                    <tr>
                        <td colspan="13" style="padding: 40px; color: #6b7280; font-style: italic;">
                            No uploaded projects.
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- í•˜ë‹¨ ë²„íŠ¼ ì˜ì—­ -->
        <div style="padding: 20px 25px; border-top: 1px solid #e5e7eb; background: #f8f9fa; display: flex; justify-content: flex-end; gap: 15px;">
            <button class="bottom-btn excel-download-btn" onclick="downloadProjectsAsExcel()">
                <span>ğŸ“Š</span>
                Download Excel
            </button>
            <button class="bottom-btn workspy-register-btn" onclick="registerToWorkspy()">
                <span>ğŸš€</span>
                Register Workspy Project
            </button>
        </div>
    </div>
    
    <!-- í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ ë„ì›€ë§ -->
    <div id="cellNavigator" class="cell-navigator">
        <div><strong>Excel-style Editing:</strong></div>
        <div>Arrow: Move cell | Enter/F2: Edit | Tab: Next cell | Del: Delete</div>
        <div>Shift+Click: Range select | Ctrl+C: Copy | Ctrl+V: Paste | Alt+Enter: Line break (Content)</div>
    </div>

    <script>
        let uploadedProjects = [];
        let currentSelectedCell = null;
        let isEditing = false;
        let selectedRange = [];
        let selectedTargetLanguages = [];
        
        // Close window
        function closeWindow() {
            if (confirm('Do you want to close this window?')) {
                window.close();
            }
        }
        
        // ë„ì°© ì–¸ì–´ ë‹¤ì¤‘ ì„ íƒ ì´ˆê¸°í™”
        function initializeTargetLanguageSelector() {
            const trigger = document.getElementById('targetLanguageTrigger');
            const dropdown = document.getElementById('targetLanguageDropdown');
            const options = dropdown.querySelectorAll('.language-option');
            
            // íŠ¸ë¦¬ê±° í´ë¦­ ì´ë²¤íŠ¸
            trigger.addEventListener('click', function(e) {
                e.stopPropagation();
                toggleDropdown();
            });
            
            // í‚¤ë³´ë“œ ì´ë²¤íŠ¸ (ìŠ¤í˜ì´ìŠ¤ë°”, ì—”í„°)
            trigger.addEventListener('keydown', function(e) {
                if (e.key === ' ' || e.key === 'Enter') {
                    e.preventDefault();
                    toggleDropdown();
                }
            });
            
            // ì˜µì…˜ í´ë¦­ ì´ë²¤íŠ¸
            options.forEach(option => {
                option.addEventListener('click', function(e) {
                    e.stopPropagation();
                    toggleLanguageSelection(this);
                });
            });
            
            // ì™¸ë¶€ í´ë¦­ ì‹œ ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
            document.addEventListener('click', function(e) {
                if (!trigger.contains(e.target) && !dropdown.contains(e.target)) {
                    closeDropdown();
                }
            });
        }
        
        // ë“œë¡­ë‹¤ìš´ í† ê¸€
        function toggleDropdown() {
            const trigger = document.getElementById('targetLanguageTrigger');
            const dropdown = document.getElementById('targetLanguageDropdown');
            
            if (dropdown.classList.contains('show')) {
                closeDropdown();
            } else {
                openDropdown();
            }
        }
        
        // ë“œë¡­ë‹¤ìš´ ì—´ê¸°
        function openDropdown() {
            const trigger = document.getElementById('targetLanguageTrigger');
            const dropdown = document.getElementById('targetLanguageDropdown');
            
            trigger.classList.add('open');
            dropdown.classList.add('show');
        }
        
        // ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
        function closeDropdown() {
            const trigger = document.getElementById('targetLanguageTrigger');
            const dropdown = document.getElementById('targetLanguageDropdown');
            
            trigger.classList.remove('open');
            dropdown.classList.remove('show');
        }
        
        // ì–¸ì–´ ì„ íƒ/í•´ì œ
        function toggleLanguageSelection(option) {
            const language = option.dataset.value;
            
            if (option.classList.contains('selected')) {
                // ì„ íƒ í•´ì œ
                option.classList.remove('selected');
                selectedTargetLanguages = selectedTargetLanguages.filter(lang => lang !== language);
            } else {
                // ì„ íƒ ì¶”ê°€
                option.classList.add('selected');
                selectedTargetLanguages.push(language);
            }
            
            updateSelectedLanguagesDisplay();
        }
        
        // ì„ íƒëœ ì–¸ì–´ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateSelectedLanguagesDisplay() {
            const trigger = document.getElementById('targetLanguageTrigger');
            const selectedContainer = document.getElementById('selectedLanguages');
            const placeholder = trigger.querySelector('.placeholder');
            
            if (selectedTargetLanguages.length === 0) {
                placeholder.textContent = 'Select target language';
                placeholder.style.color = '#6b7280';
                selectedContainer.innerHTML = '';
            } else {
                placeholder.textContent = `${selectedTargetLanguages.length} languages selected`;
                placeholder.style.color = '#374151';
                
                // ì„ íƒëœ ì–¸ì–´ íƒœê·¸ë“¤ ìƒì„±
                const tagsHTML = selectedTargetLanguages.map(language => `
                    <div class="selected-language-tag">
                        <span>${language}</span>
                        <span class="remove" onclick="removeSelectedLanguage('${language}')">âœ•</span>
                    </div>
                `).join('');
                
                selectedContainer.innerHTML = tagsHTML;
            }
        }
        
        // ì„ íƒëœ ì–¸ì–´ ì œê±°
        function removeSelectedLanguage(language) {
            // ë°°ì—´ì—ì„œ ì œê±°
            selectedTargetLanguages = selectedTargetLanguages.filter(lang => lang !== language);
            
            // ë“œë¡­ë‹¤ìš´ ì˜µì…˜ì—ì„œ ì„ íƒ í•´ì œ
            const option = document.querySelector(`.language-option[data-value="${language}"]`);
            if (option) {
                option.classList.remove('selected');
            }
            
            updateSelectedLanguagesDisplay();
        }
        
        // íŒŒì¼ ì„ íƒ ì‹œë®¬ë ˆì´ì…˜ (ê¸°íšìš©)
        function simulateFileSelect() {
            // 20ê°œ íŒŒì¼ì´ ì„ íƒëœ ê²ƒì²˜ëŸ¼ ì‹œë®¬ë ˆì´ì…˜
            const mockFileNames = [
                'meeting_001_policy_committee.m4a',
                'meeting_002_budget_review.m4a', 
                'meeting_003_urban_planning.m4a',
                'meeting_004_education_reform.m4a',
                'meeting_005_health_policy.m4a',
                'meeting_006_environment_protection.m4a',
                'meeting_007_transportation.m4a',
                'meeting_008_welfare_committee.m4a',
                'meeting_009_economic_development.m4a',
                'meeting_010_cultural_affairs.m4a',
                'meeting_011_public_safety.m4a',
                'meeting_012_housing_policy.m4a',
                'meeting_013_technology_innovation.m4a',
                'meeting_014_agriculture_committee.m4a',
                'meeting_015_tourism_development.m4a',
                'meeting_016_energy_policy.m4a',
                'meeting_017_social_welfare.m4a',
                'meeting_018_labor_relations.m4a',
                'meeting_019_foreign_affairs.m4a',
                'meeting_020_legal_affairs.m4a'
            ];
            
            // ë“œë˜ê·¸ ì˜ì—­ ìŠ¤íƒ€ì¼ ë³€ê²½
            const uploadArea = document.querySelector('.file-upload-area');
            uploadArea.style.background = '#dcfce7';
            uploadArea.style.borderColor = '#10b981';
            uploadArea.querySelector('.upload-text').textContent = `${mockFileNames.length} files selected`;
            
            // Store file names in global variable
            window.selectedFileNames = mockFileNames;
            
            // Update file list
            updateUploadedFileList(mockFileNames);
            
            alert(`${mockFileNames.length} files have been selected.`);
        }
        
        // ê°œë³„ íŒŒì¼ ì‚­ì œ
        function removeIndividualFile(index) {
            if (!window.selectedFileNames || window.selectedFileNames.length === 0) return;
            
            // í•´ë‹¹ ì¸ë±ìŠ¤ íŒŒì¼ ì œê±°
            window.selectedFileNames.splice(index, 1);
            
            // íŒŒì¼ ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            updateUploadedFileList(window.selectedFileNames);
            
            // ëª¨ë“  íŒŒì¼ì´ ì‚­ì œë˜ë©´ ë“œë˜ê·¸ ì˜ì—­ ì´ˆê¸°í™”
            if (window.selectedFileNames.length === 0) {
                const uploadArea = document.querySelector('.file-upload-area');
                uploadArea.style.background = '#f9fafb';
                uploadArea.style.borderColor = '#d1d5db';
                uploadArea.querySelector('.upload-text').textContent = 'Drag and drop files here or click to select';
                
                // í”„ë¡œì íŠ¸ ëª©ë¡ë„ ì´ˆê¸°í™”
                uploadedProjects = [];
                updateProjectList();
            }
        }
        
        // ì—…ë¡œë“œëœ íŒŒì¼ ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        function updateUploadedFileList(fileNames) {
            const fileListContainer = document.getElementById('uploadedFileList');
            const fileCountElement = document.getElementById('uploadedFileCount');
            
            if (!fileNames || fileNames.length === 0) {
                fileListContainer.innerHTML = `
                    <div style="text-align: center; color: #6b7280; padding: 40px 20px; font-style: italic;">
                        No uploaded files.
                    </div>
                `;
                fileCountElement.textContent = '0';
                return;
            }
            
            // íŒŒì¼ë³„ ëœë¤ ì‘ì—…ì‹œê°„ ìƒì„± (ê³ ì •ê°’ìœ¼ë¡œ ì €ì¥)
            if (!window.fileWorkTimes) {
                window.fileWorkTimes = {};
            }
            
            const fileListHTML = fileNames.map((fileName, index) => {
                // ê¸°ì¡´ì— ìƒì„±ëœ ì‘ì—…ì‹œê°„ì´ ìˆìœ¼ë©´ ì‚¬ìš©, ì—†ìœ¼ë©´ ìƒˆë¡œ ìƒì„±
                if (!window.fileWorkTimes[fileName]) {
                    const workMinutes = Math.floor(Math.random() * 170) + 10;
                    const workHours = Math.floor(workMinutes / 60);
                    const remainingMinutes = workMinutes % 60;
                    window.fileWorkTimes[fileName] = `${String(workHours).padStart(2, '0')}:${String(remainingMinutes).padStart(2, '0')}:00`;
                }
                
                const workTime = window.fileWorkTimes[fileName];
                
                return `
                    <div style="display: flex; align-items: center; padding: 8px 12px; background: white; border-radius: 6px; margin-bottom: 6px; border: 1px solid #e5e7eb;">
                        <div style="width: 30px; text-align: center; font-weight: 600; color: #374151; font-size: 12px;">
                            ${index + 1}
                        </div>
                        <div style="flex: 1; margin: 0 10px; text-align: center;">
                            <div style="font-weight: 500; color: #374151; font-size: 13px; margin-bottom: 2px;">
                                ${fileName}
                            </div>
                        </div>
                        <div style="width: 70px; text-align: center; font-weight: 600; color: #059669; font-size: 12px;">
                            ${workTime.substring(0, 5)}
                        </div>
                        <div style="width: 20px; text-align: center; margin-left: 8px;">
                            <button onclick="removeIndividualFile(${index})" style="background: #ef4444; color: white; border: none; border-radius: 50%; width: 18px; height: 18px; cursor: pointer; font-size: 10px; display: flex; align-items: center; justify-content: center; transition: all 0.2s;" 
                                    onmouseover="this.style.background='#dc2626'" 
                                    onmouseout="this.style.background='#ef4444'">
                                âœ•
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
            
            fileListContainer.innerHTML = `
                <!-- Header -->
                <div style="display: flex; align-items: center; padding: 8px 12px; background: #e5e7eb; border-radius: 6px; margin-bottom: 10px; font-weight: 600; color: #374151; font-size: 12px;">
                    <div style="width: 30px; text-align: center;">NO</div>
                    <div style="flex: 1; margin: 0 10px; text-align: center;">File Name</div>
                    <div style="width: 70px; text-align: center;">Work Time</div>
                    <div style="width: 20px; text-align: center;"></div>
                </div>
                ${fileListHTML}
            `;
            
            fileCountElement.textContent = fileNames.length;
        }
        
        // ë“±ë¡ ì‹œë®¬ë ˆì´ì…˜ (ê¸°íšìš©)
        function simulateRegisterProjects() {
            // Verify file selection
            if (!window.selectedFileNames || window.selectedFileNames.length === 0) {
                alert('Please select files first.');
                return;
            }
            
            // 20ê°œ í”„ë¡œì íŠ¸ ë°ì´í„° ìƒì„±
            const projects = window.selectedFileNames.map((fileName, index) => {
                // ëœë¤ ì‘ì—…ì‹œê°„ ìƒì„± (10ë¶„~180ë¶„)
                const workMinutes = Math.floor(Math.random() * 170) + 10;
                const workHours = Math.floor(workMinutes / 60);
                const remainingMinutes = workMinutes % 60;
                const workTime = `${String(workHours).padStart(2, '0')}:${String(remainingMinutes).padStart(2, '0')}:00`;
                
                return {
                    service: 'ì†Œë¦¬ë°”ë¡œ-VOD',
                    fileName: fileName,
                    workTime: workTime,
                    title: `VOD_(ìë§‰) / ì¬íƒ / ${workTime.substring(0, 5)}`,
                    qualification: '',
                    recruitStart: '',
                    recruitEnd: '',
                    recruitCount: '',
                    workStart: '',
                    workEnd: '',
                    amount: '',
                    content: ''
                };
            });
            
            uploadedProjects = projects;
            updateProjectList();
            
            alert(`${projects.length} projects have been created. You can now edit cells like in Excel.`);
        }
        
        // ì—‘ì…€ ìŠ¤íƒ€ì¼ ì…€ í´ë¦­ ì²˜ë¦¬
        function handleCellClick(cell, event) {
            event.preventDefault();
            event.stopPropagation();
            
            if (isEditing) return;
            
            if (event.shiftKey && currentSelectedCell) {
                // Shift + í´ë¦­: ë²”ìœ„ ì„ íƒ
                selectCellRange(currentSelectedCell, cell);
            } else {
                // ë‹¨ì¼ ì…€ ì„ íƒ
                selectSingleCell(cell);
            }
        }
        
        // ë‹¨ì¼ ì…€ ì„ íƒ
        function selectSingleCell(cell) {
            // ëª¨ë“  ì„ íƒ í•´ì œ
            document.querySelectorAll('.editable-cell').forEach(c => {
                c.classList.remove('selected');
            });
            selectedRange = [];
            
            // í˜„ì¬ ì…€ ì„ íƒ
            currentSelectedCell = cell;
            cell.classList.add('selected');
            selectedRange = [cell];
            
            // ë„¤ë¹„ê²Œì´ì…˜ ë„ì›€ë§ í‘œì‹œ
            showNavigationHelp();
        }
        
        // ë²”ìœ„ ì„ íƒ
        function selectCellRange(startCell, endCell) {
            // ëª¨ë“  ì„ íƒ í•´ì œ
            document.querySelectorAll('.editable-cell').forEach(c => {
                c.classList.remove('selected');
            });
            
            const table = startCell.closest('table');
            const rows = Array.from(table.querySelectorAll('tbody tr'));
            
            const startRow = rows.indexOf(startCell.closest('tr'));
            const endRow = rows.indexOf(endCell.closest('tr'));
            
            const startCells = Array.from(startCell.closest('tr').querySelectorAll('.editable-cell'));
            const endCells = Array.from(endCell.closest('tr').querySelectorAll('.editable-cell'));
            
            const startCol = startCells.indexOf(startCell);
            const endCol = endCells.indexOf(endCell);
            
            selectedRange = [];
            
            // ë²”ìœ„ ì„ íƒ
            for (let r = Math.min(startRow, endRow); r <= Math.max(startRow, endRow); r++) {
                const rowCells = Array.from(rows[r].querySelectorAll('.editable-cell'));
                for (let c = Math.min(startCol, endCol); c <= Math.max(startCol, endCol); c++) {
                    if (rowCells[c]) {
                        rowCells[c].classList.add('selected');
                        selectedRange.push(rowCells[c]);
                    }
                }
            }
            
            currentSelectedCell = endCell;
        }
        
        // ë”ë¸”í´ë¦­ìœ¼ë¡œ í¸ì§‘ ëª¨ë“œ ì§„ì…
        function startEditing(cell) {
            if (isEditing) return;
            
            isEditing = true;
            cell.classList.add('editing');
            cell.classList.remove('selected');
            
            const originalValue = cell.textContent.trim();
            const cellIndex = Array.from(cell.closest('tr').children).indexOf(cell);
            const isContentColumn = cellIndex === 12; // ë‚´ìš© ì»¬ëŸ¼ì¸ì§€ í™•ì¸
            
            // ë‚´ìš© ì»¬ëŸ¼ì€ textarea, ë‚˜ë¨¸ì§€ëŠ” input ì‚¬ìš©
            const inputElement = isContentColumn ? document.createElement('textarea') : document.createElement('input');
            
            if (!isContentColumn) {
                inputElement.type = 'text';
            }
            inputElement.value = originalValue;
            
            // í¸ì§‘ ì™„ë£Œ ì²˜ë¦¬
            function finishEditing(save = true) {
                const newValue = save ? inputElement.value.trim() : originalValue;
                
                if (isContentColumn) {
                    // ë‚´ìš© ì»¬ëŸ¼ì€ ì¤„ë°”ê¿ˆ ìœ ì§€
                    cell.innerHTML = newValue.replace(/\n/g, '<br>') || originalValue;
                } else {
                    cell.textContent = newValue || originalValue;
                }
                
                cell.classList.remove('editing');
                cell.classList.add('selected');
                isEditing = false;
                
                if (save && newValue !== originalValue) {
                    updateProjectData(cell, newValue || originalValue);
                }
            }
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            inputElement.onblur = () => finishEditing(true);
            inputElement.onkeydown = function(e) {
                e.stopPropagation();
                
                if (e.key === 'Enter') {
                    if (e.altKey && isContentColumn) {
                        // Alt + Enter: ì¤„ë°”ê¿ˆ (ë‚´ìš© ì»¬ëŸ¼ë§Œ)
                        const cursorPos = inputElement.selectionStart;
                        const textBefore = inputElement.value.substring(0, cursorPos);
                        const textAfter = inputElement.value.substring(cursorPos);
                        inputElement.value = textBefore + '\n' + textAfter;
                        inputElement.selectionStart = inputElement.selectionEnd = cursorPos + 1;
                    } else {
                        // ì¼ë°˜ Enter: í¸ì§‘ ì™„ë£Œ
                        finishEditing(true);
                        moveToNextCell(cell, 'down');
                    }
                } else if (e.key === 'Escape') {
                    finishEditing(false);
                } else if (e.key === 'Tab') {
                    e.preventDefault();
                    finishEditing(true);
                    moveToNextCell(cell, e.shiftKey ? 'left' : 'right');
                }
            };
            
            cell.innerHTML = '';
            cell.appendChild(inputElement);
            inputElement.focus();
            inputElement.select();
        }
        
        // ì…€ ì´ë™ (í™”ì‚´í‘œ í‚¤)
        function moveToNextCell(currentCell, direction) {
            const table = currentCell.closest('table');
            const rows = Array.from(table.querySelectorAll('tbody tr'));
            const currentRow = currentCell.closest('tr');
            const currentRowIndex = rows.indexOf(currentRow);
            const cells = Array.from(currentRow.querySelectorAll('.editable-cell'));
            const currentCellIndex = cells.indexOf(currentCell);
            
            let nextCell = null;
            
            switch(direction) {
                case 'left':
                    if (currentCellIndex > 0) {
                        nextCell = cells[currentCellIndex - 1];
                    }
                    break;
                case 'right':
                    if (currentCellIndex < cells.length - 1) {
                        nextCell = cells[currentCellIndex + 1];
                    }
                    break;
                case 'up':
                    if (currentRowIndex > 0) {
                        const prevRowCells = Array.from(rows[currentRowIndex - 1].querySelectorAll('.editable-cell'));
                        nextCell = prevRowCells[currentCellIndex];
                    }
                    break;
                case 'down':
                    if (currentRowIndex < rows.length - 1) {
                        const nextRowCells = Array.from(rows[currentRowIndex + 1].querySelectorAll('.editable-cell'));
                        nextCell = nextRowCells[currentCellIndex];
                    }
                    break;
            }
            
            if (nextCell) {
                selectSingleCell(nextCell);
                nextCell.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }
        
        // ë„¤ë¹„ê²Œì´ì…˜ ë„ì›€ë§ í‘œì‹œ
        function showNavigationHelp() {
            const navigator = document.getElementById('cellNavigator');
            if (navigator) {
                navigator.classList.add('show');
                
                // 5ì´ˆ í›„ ìë™ ìˆ¨ê¹€
                setTimeout(() => {
                    navigator.classList.remove('show');
                }, 5000);
            }
        }
        
        // í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ì²˜ë¦¬
        function handleKeyboardNavigation(e) {
            if (!currentSelectedCell || isEditing) return;
            
            switch(e.key) {
                case 'ArrowLeft':
                    e.preventDefault();
                    moveToNextCell(currentSelectedCell, 'left');
                    break;
                case 'ArrowRight':
                    e.preventDefault();
                    moveToNextCell(currentSelectedCell, 'right');
                    break;
                case 'ArrowUp':
                    e.preventDefault();
                    moveToNextCell(currentSelectedCell, 'up');
                    break;
                case 'ArrowDown':
                    e.preventDefault();
                    moveToNextCell(currentSelectedCell, 'down');
                    break;
                case 'Tab':
                    e.preventDefault();
                    moveToNextCell(currentSelectedCell, e.shiftKey ? 'left' : 'right');
                    break;
                case 'Enter':
                case 'F2':
                    e.preventDefault();
                    startEditing(currentSelectedCell);
                    break;
                case 'Delete':
                case 'Backspace':
                    e.preventDefault();
                    if (selectedRange.length > 1) {
                        // ë²”ìœ„ ì‚­ì œ
                        selectedRange.forEach(cell => {
                            cell.textContent = '';
                            updateProjectData(cell, '');
                        });
                    } else {
                        currentSelectedCell.textContent = '';
                        updateProjectData(currentSelectedCell, '');
                    }
                    break;
                case 'c':
                case 'C':
                    if (e.ctrlKey) {
                        e.preventDefault();
                        copySelectedCells();
                    }
                    break;
                case 'v':
                case 'V':
                    if (e.ctrlKey) {
                        e.preventDefault();
                        pasteToSelectedCells();
                    }
                    break;
            }
        }
        
        // Copy function
        let clipboardData = [];
        
        function copySelectedCells() {
            clipboardData = selectedRange.map(cell => cell.textContent.trim());
            alert(`${clipboardData.length} cells copied.`);
        }
        
        // Paste function
        function pasteToSelectedCells() {
            if (clipboardData.length === 0) {
                alert('No copied data.');
                return;
            }
            
            if (selectedRange.length === 1 && clipboardData.length === 1) {
                // ë‹¨ì¼ ì…€ ë¶™ì—¬ë„£ê¸°
                currentSelectedCell.textContent = clipboardData[0];
                updateProjectData(currentSelectedCell, clipboardData[0]);
            } else if (selectedRange.length >= clipboardData.length) {
                // ë²”ìœ„ ë¶™ì—¬ë„£ê¸° - ë³µì‚¬ëœ ë°ì´í„°ë¥¼ ìˆœì„œëŒ€ë¡œ ë¶™ì—¬ë„£ê¸°
                selectedRange.forEach((cell, index) => {
                    const dataIndex = index % clipboardData.length; // ë³µì‚¬ëœ ë°ì´í„° ë°˜ë³µ ì‚¬ìš©
                    if (clipboardData[dataIndex] !== undefined) {
                        cell.textContent = clipboardData[dataIndex];
                        updateProjectData(cell, clipboardData[dataIndex]);
                    }
                });
            } else {
                // ì„ íƒëœ ë²”ìœ„ê°€ ë³µì‚¬ëœ ë°ì´í„°ë³´ë‹¤ ì‘ì€ ê²½ìš°
                selectedRange.forEach((cell, index) => {
                    if (clipboardData[index] !== undefined) {
                        cell.textContent = clipboardData[index];
                        updateProjectData(cell, clipboardData[index]);
                    }
                });
            }
            
            alert(`Data pasted to ${Math.min(selectedRange.length, clipboardData.length)} cells.`);
        }
        
        // í”„ë¡œì íŠ¸ ë°ì´í„° ì—…ë°ì´íŠ¸
        function updateProjectData(cell, newValue) {
            const row = cell.closest('tr');
            const rowIndex = Array.from(row.parentElement.children).indexOf(row);
            const cellIndex = Array.from(row.children).indexOf(cell);
            
            if (uploadedProjects[rowIndex]) {
                const fieldMap = {
                    2: 'fileName',
                    3: 'workTime',
                    4: 'title',
                    5: 'qualification',
                    6: 'recruitStart',
                    7: 'recruitEnd',
                    8: 'recruitCount',
                    9: 'workStart',
                    10: 'workEnd',
                    11: 'amount',
                    12: 'content'
                };
                
                const fieldName = fieldMap[cellIndex];
                if (fieldName) {
                    uploadedProjects[rowIndex][fieldName] = newValue;
                    
                    // ì‘ì—…ì‹œê°„ì´ ë³€ê²½ë˜ë©´ ì œëª©ë„ ìë™ ì—…ë°ì´íŠ¸
                    if (fieldName === 'workTime') {
                        // ì‹œ:ë¶„ í˜•ì‹ìœ¼ë¡œ ë³€í™˜ (HH:MM:SS â†’ HH:MM)
                        const timeForTitle = newValue.includes(':') ? newValue.substring(0, 5) : newValue;
                        const newTitle = `VOD_(ìë§‰) / ì¬íƒ / ${timeForTitle}`;
                        uploadedProjects[rowIndex]['title'] = newTitle;
                        
                        // ì œëª© ì…€ë„ í™”ë©´ì— ì—…ë°ì´íŠ¸
                        const titleCell = row.children[4];
                        if (titleCell) {
                            titleCell.textContent = newTitle;
                        }
                    }
                    
                    // ì²« ë²ˆì§¸ í–‰ì˜ íŠ¹ì • ì»¬ëŸ¼ë“¤ì´ ìˆ˜ì •ë˜ë©´ í•´ë‹¹ ì»¬ëŸ¼ì˜ ëª¨ë“  í–‰ì— ê°™ì€ ê°’ ì ìš©
                    const autoFillColumns = ['qualification', 'recruitStart', 'recruitEnd', 'recruitCount', 'workStart', 'workEnd', 'amount', 'content'];
                    
                    if (rowIndex === 0 && autoFillColumns.includes(fieldName) && newValue.trim() !== '') {
                        // If edited in first row, apply to all rows
                        fillColumnWithValue(cellIndex, fieldName, newValue);
                        
                        alert(`All rows in "${getColumnName(cellIndex)}" column have been filled with "${newValue}".`);
                    }
                    
                    console.log(`ì—…ë°ì´íŠ¸ë¨: ${fieldName} = ${newValue}`);
                }
            }
        }
        
        // ì»¬ëŸ¼ ì „ì²´ë¥¼ ê°™ì€ ê°’ìœ¼ë¡œ ì±„ìš°ê¸°
        function fillColumnWithValue(cellIndex, fieldName, value) {
            // ë°ì´í„° ì—…ë°ì´íŠ¸
            uploadedProjects.forEach((project, index) => {
                if (index > 0) { // ì²« ë²ˆì§¸ í–‰ì€ ì´ë¯¸ ìˆ˜ì •ë¨
                    project[fieldName] = value;
                }
            });
            
            // í™”ë©´ ì—…ë°ì´íŠ¸
            const table = document.querySelector('.project-table');
            const rows = Array.from(table.querySelectorAll('tbody tr'));
            
            rows.forEach((row, index) => {
                if (index > 0) { // ì²« ë²ˆì§¸ í–‰ì€ ì´ë¯¸ ìˆ˜ì •ë¨
                    const cell = row.children[cellIndex];
                    if (cell && cell.classList.contains('editable-cell')) {
                        if (fieldName === 'content') {
                            // ë‚´ìš© ì»¬ëŸ¼ì€ ì¤„ë°”ê¿ˆ ì²˜ë¦¬
                            cell.innerHTML = value.replace(/\n/g, '<br>');
                        } else {
                            cell.textContent = value;
                        }
                    }
                }
            });
        }
        
        // Get column name
        function getColumnName(cellIndex) {
            const columnNames = {
                2: 'File Name',
                3: 'Work Time',
                4: 'Title',
                5: 'Qualification',
                6: 'Recruitment Start',
                7: 'Recruitment End',
                8: 'Recruitments',
                9: 'Work Start',
                10: 'Work End',
                11: 'Amount',
                12: 'Content'
            };
            
            return columnNames[cellIndex] || 'Unknown';
        }
        
        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì²˜ë¦¬
        function handleDragOver(event) {
            event.preventDefault();
            event.currentTarget.classList.add('dragover');
        }
        
        function handleDragLeave(event) {
            event.currentTarget.classList.remove('dragover');
        }
        
        function handleDrop(event) {
            event.preventDefault();
            event.currentTarget.classList.remove('dragover');
            simulateFileSelect(); // ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ ëŒ€ì²´
        }
        
        // ì‹¤ì œ íŒŒì¼ ì„ íƒ ì²˜ë¦¬
        function handleFileSelect(event) {
            simulateFileSelect(); // ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ ëŒ€ì²´
        }
        
        // ì „ì²´ íŒŒì¼ ì œê±°
        function removeFile() {
            document.getElementById('fileInput').value = '';
            uploadedProjects = [];
            window.selectedFileNames = [];
            window.fileWorkTimes = {};
            
            // ë“œë˜ê·¸ ì˜ì—­ ì›ë³µ
            const uploadArea = document.querySelector('.file-upload-area');
            uploadArea.style.background = '#f9fafb';
            uploadArea.style.borderColor = '#d1d5db';
            uploadArea.querySelector('.upload-text').textContent = 'Drag and drop files here or click to select';
            
            // íŒŒì¼ ë¦¬ìŠ¤íŠ¸ ì´ˆê¸°í™”
            updateUploadedFileList([]);
            
            updateProjectList();
        }
        
        // í”„ë¡œì íŠ¸ ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateProjectList() {
            const tbody = document.getElementById('projectTableBody');
            
            if (uploadedProjects.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="12" style="padding: 40px; color: #6b7280; font-style: italic;">
                            No uploaded projects.
                        </td>
                    </tr>
                `;
            } else {
                tbody.innerHTML = uploadedProjects.map((project, index) => {
                    const serviceClass = project.service.includes('VOD') ? 'status-ready' : 'status-pending';
                    return `
                        <tr>
                            <td>${index + 1}</td>
                            <td><span class="status-badge ${serviceClass}">${project.service}</span></td>
                            <td class="editable-cell">${project.fileName}</td>
                            <td class="editable-cell">${project.workTime}</td>
                            <td class="editable-cell">${project.title}</td>
                            <td class="editable-cell">${project.qualification}</td>
                            <td class="editable-cell">${project.recruitStart}</td>
                            <td class="editable-cell">${project.recruitEnd}</td>
                            <td class="editable-cell">${project.recruitCount}</td>
                            <td class="editable-cell">${project.workStart}</td>
                            <td class="editable-cell">${project.workEnd}</td>
                            <td class="editable-cell">${project.amount}</td>
                            <td class="editable-cell">${project.content}</td>
                        </tr>
                    `;
                }).join('');
                
                // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¬ë“±ë¡
                setTimeout(() => {
                    document.querySelectorAll('.editable-cell').forEach(cell => {
                        cell.addEventListener('click', function(e) {
                            handleCellClick(this, e);
                        });
                        cell.addEventListener('dblclick', function(e) {
                            e.preventDefault();
                            startEditing(this);
                        });
                    });
                }, 100);
            }
            
            // í”„ë¡œì íŠ¸ ê°œìˆ˜ ì—…ë°ì´íŠ¸
            document.getElementById('projectCount').textContent = uploadedProjects.length;
        }
        
        // ì „ì²´ ì„ íƒ/í•´ì œ (ì²´í¬ë°•ìŠ¤ ì œê±°ë¡œ ì¸í•´ ì‚¬ìš© ì•ˆí•¨)
        function toggleAllProjects() {
            // ì²´í¬ë°•ìŠ¤ ì»¬ëŸ¼ì´ ì œê±°ë˜ì–´ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
        }
        
        // Register Workspy project (main registration button)
        function registerToWorkspy() {
            if (uploadedProjects.length === 0) {
                alert('No projects to register.');
                return;
            }
            
            // Validate basic information
            const projectTitle = document.getElementById('projectTitle').value.trim();
            const companyName = document.getElementById('companyName').value;
            const clientName = document.getElementById('clientName').value.trim();
            const sourceLanguage = document.getElementById('sourceLanguage').value;
            
            if (!projectTitle) {
                alert('Please enter project title.');
                document.getElementById('projectTitle').focus();
                return;
            }
            
            if (!companyName) {
                alert('Please select company name.');
                document.getElementById('companyName').focus();
                return;
            }
            
            if (!clientName) {
                alert('Please enter client name.');
                document.getElementById('clientName').focus();
                return;
            }
            
            if (!sourceLanguage) {
                alert('Please select source language.');
                document.getElementById('sourceLanguage').focus();
                return;
            }
            
            if (selectedTargetLanguages.length === 0) {
                alert('Please select at least one target language.');
                document.getElementById('targetLanguageTrigger').focus();
                return;
            }
            
            // Confirm Workspy registration
            if (confirm(`Do you want to register ${uploadedProjects.length} projects to Workspy?\n\nAfter registration, worker recruitment will begin on the Workspy platform.`)) {
                // ë¶€ëª¨ ì°½(trans-management.html)ì— í”„ë¡œì íŠ¸ ì¶”ê°€
                addProjectsToParentPage(projectTitle, companyName, clientName);
                
                // Registration process (simulation)
                setTimeout(() => {
                    alert(`ğŸ‰ Success!\n\n${uploadedProjects.length} projects have been successfully registered to Workspy.\n\nâ€¢ Project registration completed\nâ€¢ Worker recruitment started\nâ€¢ Progress can be checked on the admin page\nâ€¢ Items added to Translation Work Management page.`);
                    
                    // ë“±ë¡ ì™„ë£Œ í›„ ë°ì´í„° ì´ˆê¸°í™”
                    uploadedProjects = [];
                    updateProjectList();
                    
                    // ì„ íƒ ìƒíƒœ ì´ˆê¸°í™”
                    currentSelectedCell = null;
                    selectedRange = [];
                    
                    // ê¸°ë³¸ ì •ë³´ë„ ì´ˆê¸°í™”
                    document.getElementById('projectTitle').value = '';
                    document.getElementById('companyName').value = '';
                    document.getElementById('clientName').value = '';
                    document.getElementById('sourceLanguage').value = '';
                    
                    // ë„ì°© ì–¸ì–´ ì´ˆê¸°í™”
                    selectedTargetLanguages = [];
                    document.querySelectorAll('.language-option.selected').forEach(option => {
                        option.classList.remove('selected');
                    });
                    updateSelectedLanguagesDisplay();
                    
                    // íŒŒì¼ ì •ë³´ë„ ì´ˆê¸°í™”
                    removeFile();
                    
                    // Close window option (after parent window refresh)
                    setTimeout(() => {
                        if (confirm('Registration completed. Do you want to close this window?')) {
                            // Focus on parent window
                            if (window.opener && !window.opener.closed) {
                                window.opener.focus();
                            }
                            window.close();
                        }
                    }, 500);
                }, 1000);
            }
        }
        
        // ë¶€ëª¨ í˜ì´ì§€(trans-management.html)ì— í”„ë¡œì íŠ¸ ì¶”ê°€
        function addProjectsToParentPage(projectTitle, companyName, clientName) {
            try {
                // localStorageë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„° ì „ë‹¬ (ë” ì•ˆì „í•œ ë°©ë²•)
                const projectsToAdd = uploadedProjects.map((project, index) => {
                    // ì œëª© í˜•ì‹: "í”„ë¡œì íŠ¸ì œëª©_NO" (í° ìˆ«ìë¶€í„°)
                    const projectNumber = String(uploadedProjects.length - index).padStart(2, '0');
                    const generatedTitle = `${projectTitle}_${projectNumber}`;
                    
                    // ìƒˆ ì£¼ë¬¸ë²ˆí˜¸ ìƒì„±
                    const now = new Date();
                    const year = now.getFullYear();
                    const month = String(now.getMonth() + 1).padStart(2, '0');
                    const day = String(now.getDate()).padStart(2, '0');
                    const hours = String(now.getHours()).padStart(2, '0');
                    const minutes = String(now.getMinutes()).padStart(2, '0');
                    const seconds = String(now.getSeconds() + index).padStart(2, '0'); // ê°ê° ë‹¤ë¥¸ ì´ˆ
                    const orderNumber = `${year}${month}${day}${hours}${minutes}${seconds}`;
                    
                    // ì˜¤ëŠ˜ ë‚ ì§œì™€ ì‹œê°„
                    const today = `${year}-${month}-${day} ${hours}:${minutes}`;
                    
                    return {
                        orderNumber: orderNumber,
                        title: generatedTitle,
                        companyName: companyName,
                        clientName: clientName,
                        requestDate: today,
                        workTime: project.workTime,
                        status: 'ì ‘ìˆ˜'
                    };
                });
                
                // localStorageì— ë°ì´í„° ì €ì¥
                localStorage.setItem('bulkProjectsData', JSON.stringify(projectsToAdd));
                localStorage.setItem('bulkProjectsAdded', 'true');
                
                console.log(`Saved ${projectsToAdd.length} project data to localStorage.`);
                
                // ë¶€ëª¨ ì°½ì´ ì¡´ì¬í•˜ëŠ” ê²½ìš° ì§ì ‘ í˜¸ì¶œë„ ì‹œë„
                if (window.opener && !window.opener.closed) {
                    try {
                        if (typeof window.opener.addBulkProjectsToTable === 'function') {
                            window.opener.addBulkProjectsToTable(projectsToAdd);
                            window.opener.focus();
                        }
                        
                        // ë¶€ëª¨ ì°½ì— ìƒˆë¡œê³ ì¹¨ ì‹ í˜¸
                        if (typeof window.opener.checkForBulkProjects === 'function') {
                            window.opener.checkForBulkProjects();
                        }
                    } catch (e) {
                        console.log('Direct call failed, using localStorage method:', e);
                    }
                }
                
            } catch (error) {
                console.error('Failed to pass data to parent page:', error);
            }
        }
        
        // Excel download function
        function downloadProjectsAsExcel() {
            if (uploadedProjects.length === 0) {
                alert('No projects to download.');
                return;
            }
            
            // ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ì‹œë®¬ë ˆì´ì…˜
            const projectData = uploadedProjects.map((project, index) => ({
                NO: index + 1,
                ì„œë¹„ìŠ¤: project.service,
                íŒŒì¼ì´ë¦„: project.fileName,
                ì‘ì—…ì‹œê°„: project.workTime,
                ì œëª©: project.title,
                ì§€ì›ìê²©: project.qualification,
                ëª¨ì§‘ê¸°ê°„_ì‹œì‘: project.recruitStart,
                ëª¨ì§‘ê¸°ê°„_ì¢…ë£Œ: project.recruitEnd,
                ëª¨ì§‘ì¸ì›: project.recruitCount,
                ì‘ì—…ê¸°ê°„_ì‹œì‘: project.workStart,
                ì‘ì—…ê¸°ê°„_ì¢…ë£Œ: project.workEnd,
                ê¸ˆì•¡: project.amount,
                ë‚´ìš©: project.content
            }));
            
            console.log('ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ë°ì´í„°:', projectData);
            
            // In production: generate and download Excel file
            alert(`ğŸ“Š Excel Download\n\nDownloading ${uploadedProjects.length} project data to Excel file.\n\nFile name: Workspy_Project_List_${new Date().toISOString().split('T')[0]}.xlsx`);
        }
        
        // ê¸°ì¡´ ë“±ë¡ ë²„íŠ¼ (ìƒë‹¨)
        function registerProjects() {
            // ìƒë‹¨ ë“±ë¡ ë²„íŠ¼ì€ í•˜ë‹¨ ë©”ì¸ ë²„íŠ¼ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
            registerToWorkspy();
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            updateProjectList();
            
            // ë„ì°© ì–¸ì–´ ë‹¤ì¤‘ ì„ íƒ ì´ˆê¸°í™”
            initializeTargetLanguageSelector();
            
            // í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            document.addEventListener('keydown', handleKeyboardNavigation);
            
            // ì™¸ë¶€ í´ë¦­ ì‹œ ì…€ ì„ íƒ í•´ì œ
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.editable-cell') && !isEditing) {
                    if (currentSelectedCell) {
                        document.querySelectorAll('.editable-cell').forEach(c => {
                            c.classList.remove('selected');
                        });
                        currentSelectedCell = null;
                        selectedRange = [];
                        document.getElementById('cellNavigator').classList.remove('show');
                    }
                }
            });
        });
    </script>
</body>
</html>